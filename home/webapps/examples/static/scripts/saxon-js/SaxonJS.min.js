var SaxonJS=function(){function t(e){"use strict";if(null===e)return"#null";if("undefined"==typeof e)return"#undefined";var n;if(e instanceof C.XdmArray){n="[";var r;for(r=0;r<e.value.length&&3>r;r++)0!==r&&(n+=","),n+=t(e.value[r]);return e.value.length>=4&&(n+=",...("+e.value.length+")"),n+="]"}if(e instanceof w)return n="{",e.forAllPairs(function(e){n+=t(e.k),n+=": ",n+=t(e.v),n+=", "}),n+="}";if(!T.isNode(e)||T.isAttr(e)||T.isNSNode(e)){if(T.isAttr(e))return"attribute @"+e.name;if(T.isNSNode(e))return"ns:"+e.prefix+"="+e.uri;if(e.type)return"string"===e.type?'"'+e.toString()+'"':"integer"===e.type||"boolean"===e.type?e.toString():"xs:"+e.type+"("+e.toString()+")";if("object"==typeof e&&"length"in e){n="(";var o;for(o=0;o<e.length&&3>o;o++)0!==o&&(n+=","),n+=t(e[o]);return e.length>=4&&(n+=",...("+e.length+")"),n+=")"}return"??? "+e}if(n={1:"element <"+e.tagName+">",2:"attribute @"+e.name,3:"text:"+(e.nodeValue?e.nodeValue.substring(0,8):"''"),7:"pi",8:"comment",9:"document "+(e._saxonDocumentNumber?"#"+e._saxonDocumentNumber:"(No nr / #0)"),11:"docFrag"}[e.nodeType],"9"==e.nodeType){var i;for(i=0;i<e.childNodes.length;i++)n+="~>"+t(e.childNodes[i])}return n}function e(t,e,n){this.prefix=null===t?"":t,this.uri=null===e?"":e,n&&(this.parentNode=n)}function n(t,e,n){this.qname=t,this.value=e,this.parent=n,this.name=this.qname.toString(),this.namespaceURI=this.qname.uri,this.localName=this.qname.local,this.prefix=this.qname.prefix}function r(t,e,n){return this instanceof r?(this.name="XError",this.message=t||"Default Message",this.code=e||"FORG0001",n&&this.setExpr(n),void(this.stack=(new Error).stack)):new r(t,e,n)}function o(){"use strict";L?(i(y.platform),a("Saxon-JS "+v().productVersion+" in browser")):(i(JSTestDriver.platform),a("Saxon-JS "+v().productVersion+" in Nashorn")),"function"==typeof J.initialize&&J.initialize()}function i(t){"use strict";J=t}function a(t){J.saxonPrint(t)}function u(){return $}function s(t){"use strict";function e(t){switch(t.nodeType){case T.DOCUMENT_NODE:e(t.documentElement);break;case T.DOCUMENT_FRAGMENT_NODE:case T.ELEMENT_NODE:for(var r=T.nameOfNode(t),o=T.getInheritedAttribute(t,"xml:space"),i=n(r.uri,r.local)&&!(o&&"preserve"==o),a=t.childNodes,u=0;u<a.length;){var s=a[u];if(s.nodeType==T.CDATA_SECTION){var c=T.ownerDocument(t).createTextNode(s.nodeValue);t.replaceChild(c,s),s=c}s.nodeType==T.TEXT_NODE?i&&""===_.trim(s.nodeValue)?t.removeChild(s):u++:(e(s),u++)}}}var n=new Function("uri","local",t?t.getAttribute("test"):"return false");return function(t){return e(t),t}}function c(t,e,n){"use strict";var o=E.child(t.documentElement).filter(function(t){return"stripJS"==t.tagName}).next();z=s(o),e&&z&&(e=z(e)),n.saxonVersion=u();var i=p(t,e,n);if(i.fixed.spaceStripper=z,e){T.obtainDocumentNumber(e);var c=e._saxonBaseUri;i.fixed.documentPool[c]=e}var l=n.destination;l&&!/^(appendToBody|prependToBody|replaceBody|application|native)$/.test(l)&&a("Warning: supplied transformation option not recognised - destination: "+l),L&&l&&/^(appendToBody|prependToBody|replaceBody)$/.test(l)&&(i.resultDocument=window.document);var f,d=n.initialTemplate;d&&d.indexOf("Q{")<0&&(d="Q{}"+d);var v=n.initialFunction,y=n.initialMode;y||(y=t.documentElement.hasAttribute("defaultMode")?t.documentElement.getAttribute("defaultMode"):""),"#unnamed"==y&&(y=""),""!==y&&"Q{"!=y.substring(0,2)&&(y="Q{}"+y);var N="Q{"+C.KNOWN_URI.xsl+"}initial-template";if(e||d||h(i,N)&&(d=N),v){var x=n.functionParams?n.functionParams:[],b=x.length,w=g(i,v,b);if(!w)throw r("Unknown initial function "+v+"#"+b,"XTDE0041");var O=T.firstElementChild(w.decl);i.focus={},i.currentComponent=w,i.clearGrouping(),i.tempOutputState="function",i.currentMode={},i.currentTemplate=null,i.localVars=x.map(function(t){return C.convertFromJS(t)}),i.localParams={},f=C.evaluate(C.argRole(O,"body"),i)}else if(d){var D=h(i,d);if(!D)throw r("Unknown initial template "+d,"XTDE0040");var _=T.firstElementChild(D.decl);i.fixed.globalContextItem?i.focus=A.Solo(e):(i.focus=A.Tracker(A.Empty),i.focus.next()),C.checkTemplateFocus(_,i),i.currentComponent=D,i.currentMode={},f=C.evalChild1(_,i)}else{var F=i.fixed.modes[y];if(!F)throw r("Unknown initial mode "+y,"XTDE0045");if(!e)throw r("No source document, initial template, or initial mode supplied","SXJS0006");var I=parseInt(F._expr.parentNode.getAttribute("id"));i.currentComponent=i.fixed.components[I],i.focus=A.Tracker(A.Singleton(e)),f=F.applyTemplates(i)}if("application"==l)n.principalResult=C.convertToJS(f.expand());else if("native"==l){var M=f.expand();1==M.length&&T.isNode(M[0])&&(M[0]=S.string.fromString(C.serialize(A.ForArray(M)))),n.principalResult=M}else{C.makeComplexContent(i.resultRoot,f,i);var k=E.child(i.resultRoot);if(k)if(L){var P=window.document.body;if("appendToBody"==l)k.forEachItem(function(t){P.appendChild(t)});else if("prependToBody"==l){var U=P.firstChild;k.forEachItem(function(t){P.insertBefore(t,U)})}else if("replaceBody"==l){for(;P.childNodes.length>0;)P.removeChild(P.childNodes[0]);k.forEachItem(function(t){P.appendChild(t)})}else n.principalResult=i.resultRoot}else n.principalResult=i.resultRoot}L&&m(i)}function l(t,e){"use strict";function n(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e+=n+", ");return e}function o(n,o){if(null===n)throw r("No stylesheet supplied","SXJS0006");f(n),c(n,o,t),e&&e(t.principalResult)}a("Transform options supplied: "+n(t)),t.stylesheetParams||(t.stylesheetParams={}),"function"==typeof J.deliverMessage&&J.deliverMessage(t);var i,u;if(L){var s=[],l=window.document.baseURI;t.stylesheetLocation&&(t.stylesheetLocation=J.resolveUri(t.stylesheetLocation.toString(),l),s.push(t.stylesheetLocation)),t.sourceLocation&&(t.sourceLocation=J.resolveUri(t.sourceLocation.toString(),l),s.push(t.sourceLocation)),i=t.stylesheetNode?t.stylesheetNode:null,u=t.sourceNode?t.sourceNode:t.sourceText?J.parseXmlFromString(t.sourceText):null,t.sourceNode&&t.sourceNode.baseURI&&(u._saxonBaseUri=t.sourceNode.baseURI),0===s.length?o(i,u):J.asyncGetMultipleXml(s,function(e){i=t.stylesheetLocation?e[t.stylesheetLocation]:i,u=t.sourceLocation?e[t.sourceLocation]:u,o(i,u)})}else{if(i=t.stylesheetNode,!i){var m=t.stylesheetText;if(!m){var p=t.stylesheetFileName;if(!p)throw r("No stylesheet supplied","SXJS0006");m=J.readFile(p)}i=J.parseXmlFromString(m)}if(u=t.sourceNode,u&&t.sourceNode.baseURI&&(u._saxonBaseUri=t.sourceNode.baseURI),!u){var h=t.sourceText;if(!h){var g=t.sourceFileName;g&&(h=J.readFile(g))}h&&(u=J.parseXmlFromString(h),u._saxonBaseUri=t.sourceLocation?t.sourceLocation:t.sourceFileName)}o(i,u)}}function f(t){"use strict";function e(t,e){for(var n=e<<8,r=0;r<t.length;r++)n=(n<<1)+t.charCodeAt(r);return n}function n(t,n){return e(t.local,n)^e(t.uri,n)}function o(t){i^=n(T.nameOfNode(t),u++),E.attribute(t).forEachItem(function(t){i^=n(T.nameOfNode(t),u),i^=e(t.value,u)}),E.child(t).filter(function(t){return t.nodeType==T.ELEMENT_NODE}).forEachItem(function(t){o(t)}),i^=1}var i=0,u=0,s=!1;if(E.child(t).forEachItem(function(t){if(t.nodeType==T.ELEMENT_NODE){if("package"==T.nameOfNode(t).local){var e=T.getAttribute(t,"target","not specified");if($=T.getAttribute(t,"saxonVersion","9.7.0.7"),P=T.getAttribute(t,"relocatable","false"),a("SEF generated by Saxon-EE version "+$+" with -target:"+e+" -relocate:"+P),"9.7.0.7"!=$&&"JS"!=e)throw r("Supplied SEF is not customized for use with Saxon-JS. The option -target:JS should be set when generating the export. target is: "+e,"SXJS0006");if(t.hasAttribute("expiry")){var n=S.date.fromString(t.getAttribute("expiry"));if(n.compareTo(S.date.fromDate(new Date,0))<0)throw r("Development license for supplied stylesheet has expired","SXJS0006")}}o(t)}else if(t.nodeType==T.PROCESSING_INSTRUCTION_NODE&&T.nameOfNode(t).local==String.fromCharCode(931)){var u=(0>i?4294967295+i+1:i).toString(16);if(u!=t.data)throw r("Invalid checksum in SEF "+t.data+" != "+u,"SXJS0006");s=!0}}),!s)throw r("No checksum found in SEF","SXJS0006")}function m(t){"use strict";function e(e,n){var r=function(n){var r=n.target,o=t.newContext(!0);o.currentEvent=n,o.focus=A.Tracker(A.Singleton(C.convertFromJS(r)));var i=parseInt(e._expr.parentNode.getAttribute("id"));o.currentComponent=t.fixed.components[i],e.applyTemplates(o).expand()},o=["afterprint","beforeprint","beforeunload","hashchange","languagechange","message","offline","online","pagehide","pageshow","popstate","storage","unhandledrejection","unload"];-1==o.indexOf(n)?window.document.addEventListener(n,r,!1):window.addEventListener(n,r,!1)}var n=t.fixed.modes;for(var r in n)if(n.hasOwnProperty(r)){var o=r.split("}");o[0]=="Q{"+C.KNOWN_URI.ixsl&&e(n[r],o[1].replace(/^on/,""))}}function p(t,e,n){"use strict";function o(e,n){E.descendant(t).filter(function(t){return t.nodeType==T.ELEMENT_NODE&&t.tagName==e}).forEachItem(n)}function i(t){var e=T.getAttribute(t,"name");return e?/^Q\{/.test(e)?e:"Q{}"+e:null}function a(t,e){function n(t){for(var n=T.getChildElements(t,"co"),r=0;r<n.length;r++)e(n[r])}n(t);var r=T.firstElementChild(t,"overridden");null!=r&&n(r)}var u=new d;if(u.fixed={options:n,stylesheet:t,globalContextItem:e,topPackage:null,packages:{},components:{},globalVars:{},modes:{},userFunctions:{},accumulators:{},decimalFormats:{},resultDocUris:{},_nextDocumentNumber:0,currentDate:{}},n.collations||(n.collations={}),n.collations[N.codepointCollationUri]=N.codepointCollation(),n.collations[N.fotsCaseblindCollationUri]=N.caseblindCollation(),n.collations[N.htmlCaseInsensitiveCollationUri]=N.caseblindCollation(),n.collations[N.xsltsCaseblindCollationUri]=N.caseblindCollation(),o("package",function(t){var e={name:t.getAttribute("name"),decl:t,decimalFormats:{},keys:{}};u.fixed.packages[e.name]=e,u.fixed.topPackage||(u.fixed.topPackage=e),a(t,function(t){var n=parseInt(t.getAttribute("id"));u.fixed.components[n]={id:n,visibility:t.getAttribute("vis"),decl:t,pack:e,actor:null,bindings:t.getAttribute("binds").split(" ").map(function(t){return parseInt(t)})}})}),o("package",function(t){var e=u.fixed.packages[t.getAttribute("name")];a(t,function(t){var e=parseInt(t.getAttribute("id")),n=u.fixed.components[e],r=T.firstElementChild(t);if(null===r){var o=(u.fixed.packages[t.getAttribute("dpack")],u.fixed.components[parseInt(t.getAttribute("base"))].decl);r=T.firstElementChild(o)}if(n.actor=r,"globalVariable"===r.tagName||"globalParam"===r.tagName)n.value=null;else if("mode"===r.tagName){var a=new O(r);n.mode=a;var s=i(r);u.fixed.modes[null===s?"":s]=a}});for(var n=T.getChildElements(t,"decimalFormat"),r=0;r<n.length;r++){var o=n[r],s=i(o);e.decimalFormats[null===s?"Q{}":s]=o}for(var c=T.getChildElements(t,"key"),l=0;l<c.length;l++){var f=c[l],m=i(f);e.keys[m]?e.keys[m].push(f):e.keys[m]=[f]}}),o("mode",function(t){var e=i(t);u.fixed.modes[null===e?"":e]=new O(t)}),o("globalVariable",function(t){var e=i(t);u.fixed.globalVars[e]={decl:t,value:null,isParam:!1}}),o("globalParam",function(t){var e=i(t);u.fixed.globalVars[e]={decl:t,value:null,isParam:!0}}),o("function",function(t){C.hasFlag(t,"m")&&C.notImplemented("memo function");var e=i(t),n=E.child(t).filter(function(t){return"arg"==t.tagName}).count();u.fixed.userFunctions[e+"#"+n]=C.argRole(t,"body"),u.fixed.userFunctions[e+"#-1"]=!0}),o("accumulator",function(t){var e=i(t);u.fixed.accumulators[e]=t}),u.fixed.documentPool={},u.fixed._nextDocumentNumber=0,u.fixed.currentDate=new Date,L){var s=window.document.baseURI;if(u.fixed.htmlURI=s,u.fixed.javascriptURI=J.baseUri(),n.stylesheetLocation&&!T.isAbsoluteURI(n.stylesheetLocation))throw r("stylesheetLocation should be absolute by now","SXJS0004");u.fixed.staticBaseURI=n.isDynamicStylesheet?null:"true"===P?n.stylesheetLocation||s:null}else u.fixed.staticBaseURI="true"===P?n.stylesheetFileName:null;return u.currentComponent=null,u.resultDocument=L?document.implementation.createDocument(null,"html",null):new Document,u.resultRoot=u.resultDocument.createDocumentFragment(),u.localVars=[],u.localParams={},u.tunnelParams={},u}function h(t,e){for(var n=t.fixed.topPackage,r=T.getChildElements(n.decl,"co"),o=0;o<r.length;o++){var i=parseInt(r[o].getAttribute("id")),a=t.fixed.components[i],u=a.actor;if("template"===u.tagName&&u.getAttribute("name")===e)return a}}function g(t,e,n){for(var r=t.fixed.topPackage,o=T.getChildElements(r.decl,"co"),i=0;i<o.length;i++){var a=parseInt(o[i].getAttribute("id")),u=t.fixed.components[a],s=u.actor;if("function"===s.tagName&&s.getAttribute("name")===e&&T.getChildElements(s,"arg").length==n)return u}}function d(){}function v(){return{version:3,vendor:"Saxonica",vendorURL:"http://www.saxonica.com/",productName:"Saxon-JS",productVersion:"1.0.2",isSchemaAware:!1,supportsSerialization:!1,supportsBackwardsCompatibility:!0,supportsNamespaceAxis:!0,supportsStreaming:!1,supportsDynamicEvaluation:!0,supportsHigherOrderFunctions:!1,xPathVersion:3.1,xsdVersion:1.1}}var y=function(){"use strict";function t(t){return t.getElementsByTagNameNS(n,"parsererror").length>0}function e(){Math.trunc=Math.trunc||function(t){return 0>t?Math.ceil(t):Math.floor(t)},Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),r=n.length>>>0,o=arguments[1],i=0;r>i;i++)if(e=n[i],t.call(o,e,i,n))return i;return-1},enumerable:!1,configurable:!1,writable:!1}),String.prototype.includes||(String.prototype.includes=function(t,e){return"number"!=typeof e&&(e=0),e+t.length>this.length?!1:-1!==this.indexOf(t,e)})}var n;try{var o=new DOMParser,i=o.parseFromString("<","text/xml");n=i.getElementsByTagName("parsererror")[0].namespaceURI}catch(u){}var s={inBrowser:!0,asyncGet:function(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.onload=function(o){4===n.readyState&&e(200===n.status?n.responseText:new r(n.statusText+": "+t,"SXJS0006"))},n.onerror=function(o){e(new r(n.statusText+": "+t,"SXJS0006"))},n.send(null)},asyncGetXml:function(t,e){s.asyncGet(t,function(n){var o=null;n instanceof r?o=n:(o=s.parseXmlFromString(n),o._saxonBaseUri=t),e(t,o)})},asyncGetMultipleXml:function(t,e){function n(t,n){if(n instanceof r)throw n;i[t]=n,--o<=0&&e(i)}for(var o=t.length,i={},a=0;a<t.length;a++)t[a]?s.asyncGetXml(t[a],n):o--},addXml:function(t,e,n){function r(t,r){n[t]=r,e(n)}n[t]?e(n):s.asyncGetXml(t,r)},addMultipleXml:function(t,e,n){function r(t){--o<=0&&n(t)}for(var o=t.length,i=0;i<t.length;i++)t[i]?s.addXml(t[i],r,e):o--},makeHttpRequest:function(t,e){function n(t,e){if(t instanceof DocumentFragment){var n=document.implementation.createDocument(null,null,null),r=n.importNode(t,!0);n.appendChild(r),t=n}return t}function o(t){function e(e){throw r(e+" in HTTP request to: "+t.href,"SXJS0006")}if(!t.href)throw r("'href' must be specified in HTTP request","SXJS0006");t.method||e("'method' must be specified"),t.method=t.method.toUpperCase(),"status-only"in t&&"boolean"!=typeof t["status-only"]&&e("'status-only' parameter must be of type xs:boolean"),t.allowedBody="GET"!=t.method&&"HEAD"!=t.method,t.hasData="body"in t||"multipart-bodies"in t,("multipart-bodies"in t||"multipart-headers"in t)&&e("Multipart requests not yet implemented"),!t.allowedBody&&t.hasData&&e("Body and multipart body content must be null for "+t.method+" request"),"headers"in t||(t.headers={});var o=t["media-type"]||t.headers["content-type"]||"";return t.hasData&&""===o&&e("No content type specified"),"media-type"in t&&(t.headers["content-type"]=o),"multipart-bodies"in t&&!/$multipart\//.test(o)&&e("Content type must be multipart media type for multipart request"),("username"in t&&!("password"in t)||!("username"in t)&&"password"in t)&&e("Must set both (or neither) username and password"),t.body instanceof DocumentFragment&&(t.body=n(t.body,o)),a("HTTP request prepared"),t}o(t),"undefined"==typeof XMLHttpRequest&&(XMLHttpRequest=function(){return new ActiveXObject("Msxml2.XMLHTTP.6.0")});var i=new XMLHttpRequest;"override-media-type"in t&&i.overrideMimeType(t["override-media-type"]),"username"in t?i.open(t.method,t.href,!0,t.username,t.password):i.open(t.method,t.href,!0);for(var u in t.headers)t.headers.hasOwnProperty(u)&&i.setRequestHeader(u,t.headers[u]);i.onreadystatechange=function(){function n(t,e){var n=e.getAllResponseHeaders();if(""===n);else{var r=n.split(/\r\n/);r.forEach(function(e){if(""!==e.trim()){var n=e.indexOf(":");n>=0?t.headers[e.substring(0,n).toLowerCase()]=e.substring(n+1).trim():a("No ':' separator found in HTTP response header "+e)}})}}if(4===i.readyState){if(!(i.status>=200))throw r(i.statusText+": "+t.href,"SXJS0006");a("Saxon-JS processing httpRequest response");var o={};if(o.headers={},o.status=i.status,o.message=i.statusText,!t["status-only"]){var u=i.getResponseHeader("Content-Type"),c=u.split(/;/),l=c[0],f=(c[1].trim(),t["override-media-type"]||l);switch(o["media-type"]=f,f){case"text/xml":case"application/xml":case"text/xml-external-parsed-entity":case"application/xml-external-parsed-entity":o.body=i.responseXML||s.parseXmlFromString(i.responseText);break;case"text/html":o.body=i.responseXML||s.parseXmlFromString(i.responseText);break;default:if(/\+xml$/.test(f)){o.body=i.responseXML||s.parseXmlFromString(i.responseText);break}if(/^text\//.test(f)){o.body=i.responseText;break}if(/^multipart\//.test(f)){o.body=i.responseText;break}o.body=i.responseText}}n(o,i),e(o)}},i.send(t.body)},parseXmlFromString:function(e){e=e.replace(/\r\n|\r(?!\n)/g,"\n");try{var n=/Edge\//.test(window.navigator.userAgent);if(!n&&/^.+<\?xml/i.test(e))throw new Error;var o=(new DOMParser).parseFromString(e,"application/xml");o.documentElement;if(t(o))throw new Error;return o}catch(i){throw r("Misplaced or malformed XML","FODC0002")}},readResource:function(t){var e,n=new XMLHttpRequest,o=s.resolveUri(t,s.baseUri());if(n.open("GET",o,!1),n.send(null),200!=n.status)throw r("Failed to read resource at "+t,"SXJS0006");if(e=n.responseText,"\ufeff"==e.charAt(0))throw r(e.substring(1),"FODC0002");return e},readFile:function(t,e){var n,o=new XMLHttpRequest;try{o.open("GET",t,!1),o.send(null)}catch(i){throw r("Get failure "+t,"FODC0002")}if(200!=o.status)throw r("Failed to read file at "+t,"FODC0002");if(n=o.responseText,"\ufeff"==n.charAt(0))throw r(n.substring(1),"FODC0002");if(n.indexOf("\x00")>=0)throw r("External file contains non-XML characters","FOUT1190");return n},resolveUri:function(t,e){try{var n,o=document,i=o.getElementsByTagName("base")[0],a=i&&i.href,u=o.head||o.getElementsByTagName("head")[0],s=i||u.appendChild(o.createElement("base")),c=o.createElement("a");return s.href=e||"",c.href=t,n=c.href,i?i.href=a:u.removeChild(s),n}catch(l){throw r("Illegal URI: href="+t+" base="+e,"FODC0005")}},baseUri:function(){for(var t=document.getElementsByTagName("script"),e=0;e<t.length;e++)if(/SaxonJS(\.min)?.js/.test(t[e].getAttribute("src")))return t[e].src;var n=t.length-1,r=t[n];return r.src},initialize:function(){e(),S._init()},deliverMessage:function(t){"function"!=typeof t.deliverMessage&&(t.deliverMessage=function(t){console.log("xsl:message: "+t)})},saxonPrint:function(t){console.log(t)}};return{platform:s}}(),S=function(){"use strict";function e(t,e){return t==e||1==R[t+"<"+e]}function n(t,e){throw new r("Casting from xs:"+t.type+" to xs:"+e+" is not allowed","XPTY0004")}function o(t,e){throw new r('Supplied value "'+t+'" is not a valid xs:'+e,"FORG0001")}function i(t,e){throw new r('Supplied value "'+t+'" is not a valid xs:'+e,"FOCA0002")}function a(t,e){throw new r("Cannot compare xs:"+t+" with xs:"+e,"XPTY0004")}function u(t,e){if(t=_.trim(t),/.\.$/.test(t)&&(t+="0"),/^(\-|\+)?([0-9]+(\.[0-9]*)?|\.[0-9]+)([Ee](\-|\+)?[0-9]+)?$/.test(t))return parseFloat(t);if(/^(\-|\+)?NaN$/.test(t))return NaN;if(/^\-INF$/.test(t))return-(1/0);if(/^(\+)?INF$/.test(t))return 1/0;if(e)throw new r("Cannot convert string '"+t+"' to a number","FORG0001");return NaN}function s(t){return t.toString(36)}function c(t){var e,n,r,o,i,a,u,s,c=0,l=0,f=[];if(!t)return t;do e=t.charCodeAt(c++),n=t.charCodeAt(c++),r=t.charCodeAt(c++),s=e<<16|n<<8|r,o=s>>18&63,i=s>>12&63,a=s>>6&63,u=63&s,f[l++]=B.charAt(o)+B.charAt(i)+B.charAt(a)+B.charAt(u);while(c<t.length);var m=f.join(""),p=t.length%3;return(p?m.slice(0,p-3):m)+"===".slice(p||3)}function l(t){t=t.replace(/\s/g,""),/^((([A-Za-z0-9+\/]){4})*(([A-Za-z0-9+\/]){3}[A-Za-z0-9+\/]|([A-Za-z0-9+\/]){2}[AEIMQUYcgkosw048]=|[A-Za-z0-9+\/][AQgw]==))?$/.test(t)||o(t,"base64Binary");var e,n,r,i,a,u,s,c,l=0,f=0,m=[];if(0===t.length)return t;t+="";do i=B.indexOf(t.charAt(l++)),a=B.indexOf(t.charAt(l++)),u=B.indexOf(t.charAt(l++)),s=B.indexOf(t.charAt(l++)),c=i<<18|a<<12|u<<6|s,e=c>>16&255,n=c>>8&255,r=255&c,64==u?m[f++]=String.fromCharCode(e):64==s?m[f++]=String.fromCharCode(e,n):m[f++]=String.fromCharCode(e,n,r);while(l<t.length);return m.join("")}function f(t){var e="";return C.stringToCodepoints(t).forEach(function(t){e+=(t+256).toString(16).substring(1).toUpperCase()}),e}function m(t){t=_.trim(t),/^([a-fA-F0-9][a-fA-F0-9])*$/.test(t)||o(t,"hexBinary");var e,n=[];for(e=0;e<t.length;e+=2)n.push(String.fromCharCode(parseInt(t.substring(e,e+2),16)));return n.join("")}function p(e,n){this.value=e,this.type=n||"string","string"!=typeof e&&C.internalError("bad input to string constructor "+t(e))}function h(t,e){this.value=t,this.type=e}function g(t,e){"number"!=typeof t&&C.internalError("type of value supplied to XdmDouble is not number: "+typeof t),this.value=t,this.type=e||"double"}function d(t,e){"number"!=typeof t&&C.internalError("type of value supplied to XdmInteger is not number: "+typeof t),this.value=t,this.type=e||"integer"}function v(t,e){this.value=new Big(t),this.type=e||"decimal"}function y(t){this.value=t,"boolean"!=typeof t&&C.internalError("type of value supplied to XdmBoolean is not boolean: "+typeof t)}function x(t,e,n){if(this.prefix=t?t:"",this.uri=e?e:"",this.local=n,""!==t&&!_.isNCName(t))throw new r("Invalid prefix: '"+t+"'","FORG0001");if(!_.isNCName(n))throw new r("Invalid local name: '"+n+"'","FORG0001")}function b(t,e,n){this.UTCdate=t,this.timezoneOffset=e,this.type=n||"dateTime",t instanceof Date||C.internalError("type of UTCdate supplied to XdmDateTime is not Date"),e&&"number"!=typeof e&&C.internalError("type of value for timezone offset supplied to XdmDateTime is not number: "+typeof value)}function T(t){return(100+t).toString().substring(1)}function w(t){return(1e4+t).toString().substring(1)}function E(t,e,n){if(this.months=t,this.milliseconds=e,("number"!=typeof t||"number"!=typeof e)&&C.internalError("type of value supplied to XdmDuration is not number: "+typeof t+", "+typeof e),t>0&&0>e||0>t&&e>0)throw new r("Months/seconds must both be negative or both positive","FORG0001");this.type=n||"duration"}function O(t){var e=X[t]={};e.name=t,e.matches=function(e){return e instanceof b&&e.type==t},e.fromString=function(e){return I(e,t)},e.fromDate=function(e,n){return new b(e,n,t)},e.cast=function(e){if(X[t].matches(e))return e;if(S.dateTime.matches(e)||S.date.matches(e)){var r=X[t];return r.fromString(r.fromDate(e.UTCdate,e.timezoneOffset).toString())}return S.string.matches(e)||S.untypedAtomic.matches(e)?X[t].fromString(e.toString()):void n(e,t)}}function A(t){if(-1!=t.indexOf(".",t.length-4)){for(var e=t.split("."),n=e[1];n.length<3;)n+="0";t=e[0]+"."+n}return t}function D(t){var e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=t[5],u=e%4===0&&!(e%100===0&&e%400!==0);return!(1>n||n>12||1>r||r>[31,u?29:28,31,30,31,30,31,31,30,31,30,31][n-1]||o>=24||i>=60||a>=60)}function F(t,e){var n=t.split(/[\-T:]/).map(function(t){return parseFloat(t)}),o=n[0];if(1>o||o>9999)throw r("Year "+o+" is out of range","FODT0001");if(!D(n))throw new r("Invalid date "+e,"FORG0001")}function I(t,e){var n=t.match(J[e]);null===n&&o(t,e);var r=n[2]?n[2]:"",i=L[e](n[1])+r;/24:00:00(\.0+)?([Z\+\-]|$)/.test(i)&&(i="time"==e?i.substring(0,10)+"T00:00:00":M["t+u"](I(i.substring(0,10),"date"),P("P1D","dayTimeDuration")).toString()+"T00:00:00");var a,u,s="-"==i.charAt(0);if(s)F(i.substring(1,20),t),u=i.substr(1).split(/[\-T:]/).map(function(t){return parseFloat(t)}),a=new Date(Date.UTC(-u[0],u[1]-1,u[2],u[3],u[4],u[5]));else{F(i.substring(0,19),t);var c=i.split(/[\-T:]/);u=i.split(/[\-T:]/).map(function(t){return parseFloat(t)});var l=u[5],f=l-Math.floor(l);a=new Date(Date.UTC(c[0],u[1]-1,u[2],u[3],u[4],l,Math.round(1e3*f))),a.setUTCFullYear(c[0])}if(""===r){var m=new Date;a=new Date(a.getTime()+60*m.getTimezoneOffset()*1e3)}else a=new Date(a.getTime()-60*k(r)*1e3);return new b(a,k(n[2]?n[2]:""),e)}function k(t){if(""===t)return null;if("Z"==t)return 0;var e=t.split(":"),n=parseInt(e[0],10),o=/^\-.*/.test(e[0]),i=Math.abs(n),a=parseInt(e[1],10);if(i>14||a>59)throw r("Invalid timezone "+t,"FORG0001");return(o?-1:1)*(60*i+a)}function P(t,e){var n=t.match(J[e]);return(null===n||!/\d/.test(t)||/T$/.test(t))&&o(t,e),new E(q[Q[e][0]](n,t),q[Q[e][1]](n,t),e)}function U(){function n(t){for(var e=X[t];e.base;)R[t+"<"+(void 0!==e.base.name?e.base.name:e.base)]=1,e=e.base;("decimal"==e||"double"==e||"float"==e)&&(R[t+"<numeric"]=1)}function r(t,r,i){var a=X[t]={},u=X[r];a.name=t,a.base=u,a.matches=function(n){return e(n.type,t)},a.downCast=function(e){return i(e)||o(e.toString(),t),e.type=t,e},a.fromString=function(t){return a.downCast(u.fromString(t))},a.cast=function(t){return a.downCast(u.cast(t))},n(t)}function a(t,e,n){function a(e){var r=e.toNumber();return(isNaN(r)||!isFinite(r))&&i(e.toString(),t),n(e)||o(e.toString(),t),e.type=t,e}r(t,e,n);var u=X[t],s=X[e];u.fromString=function(e){return/INF|NaN/.test(e)&&i(e,t),u.downCast(s.fromString(e))},u.fromNumber=function(t){return a(s.fromNumber(t))}}function u(t,e,n,i){r(t,e,n);var a=X[t],u=X[e];a.downCast=function(e){var r=i(e.toString());return n(r)||o(r,t),new p(r,t)},a.fromString=function(t){return a.downCast(u.fromString(i(t)))}}function s(t,e,n){r(t,e,n);var i=X[t],a=X[e];i.downCast=function(e){return e instanceof E?new E("yearMonthDuration"==t?e.months:0,"dayTimeDuration"==t?e.milliseconds:0,t):(n(e)||o(e.toString(),t),e.type=t,e)},i.fromMonthsMilliseconds=function(t,e){return i.downCast(a.fromMonthsMilliseconds(t,e))},i.cast=function(e){return a.matches(e)?i.downCast(e):S.string.matches(e)||S.untypedAtomic.matches(e)?P(e.toString(),t):i.downCast(a.cast(e))}}S["double"].NaN=S["double"].fromNumber(NaN),a("nonPositiveInteger","integer",function(t){return t.toNumber()<=0}),a("negativeInteger","nonPositiveInteger",function(t){return t.toNumber()<0}),a("long","integer",function(t){var e=t.toBig();return e.cmp(Big("-9223372036854775808"))>=0&&e.cmp(Big("9223372036854775807"))<=0}),a("int","long",function(t){return t.toNumber()>=-2147483648&&t.toNumber()<=2147483647}),a("short","int",function(t){return t.toNumber()>=-32768&&t.toNumber()<=32767}),a("byte","short",function(t){return t.toNumber()>=-128&&t.toNumber()<=127}),a("nonNegativeInteger","integer",function(t){return t.toNumber()>=0}),a("positiveInteger","nonNegativeInteger",function(t){return t.toNumber()>0}),a("unsignedLong","nonNegativeInteger",function(t){return t.toNumber()>=0&&t.toBig().cmp(Big("18446744073709551615"))<=0}),a("unsignedInt","unsignedLong",function(t){return t.toNumber()>=0&&t.toBig().cmp(Big("4294967295"))<=0}),a("unsignedShort","unsignedInt",function(t){return t.toNumber()>=0&&t.toNumber()<=65535}),a("unsignedByte","unsignedShort",function(t){return t.toNumber()>=0&&t.toNumber()<=255});var c=function(t){return t.replace(/[ \r\t\n]/g," ")},l=function(){return!0};u("normalizedString","string",l,c),u("token","normalizedString",l,C.wsCollapse),u("language","token",function(t){return/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/.test(t)},C.wsCollapse),u("NMTOKEN","token",_.isNMTOKEN,C.wsCollapse),u("Name","token",_.isName,C.wsCollapse),u("NCName","Name",_.isNCName,C.wsCollapse),u("ID","NCName",_.isNCName,C.wsCollapse),u("IDREF","NCName",_.isNCName,C.wsCollapse),u("ENTITY","NCName",_.isNCName,C.wsCollapse),s("yearMonthDuration","duration",function(t){return 0===t.milliseconds}),s("dayTimeDuration","duration",function(t){return 0===t.months}),X.dayTimeDuration.fromNumberOfMinutes=function(t){return new E(0,60*t*1e3,"dayTimeDuration")},X.showValue=t,X._init=function(){}}var R={"integer<decimal":1,"decimal<numeric":1,"double<numeric":1,"float<numeric":1,"integer<numeric":1,"dateTimeStamp<dateTime":1},B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";p.prototype={value:null,type:"string",_hash:0,toString:function(){return this.value},compareTo:function(t){return t instanceof p?N.codepointComparison(this.value,t.value):"untypedAtomic"==this.type?S[t.type].cast(this).compareTo(t):void a(this.type,t.type)},equals:function(t){return 0===this.compareTo(t)},hashCode:function(){if(this.value.length<=4)return this.value;var t=this._hash,e=this.value.length;if(0===t&&e>0){var n;for(n=0;e>n;n++)t=31*t+this.value.charAt(n++);this._hash=t}return s(t)},matchKey:function(){return"s"+this.toString()}},h.prototype={value:null,type:"hexBinary",toString:function(){return"hexBinary"==this.type?f(this.value):c(this.value)},compareTo:function(t){return t instanceof h&&this.type==t.type?N.codepointComparison(this.value,t.value):void a(this.type,t.type)},equals:function(t){return 0===this.compareTo(t)},hashCode:function(){return new p(this.value).hashCode()},matchKey:function(){return("hexBinary"==this.type?"h":"i")+this.toString()}},g.prototype={value:0,type:"double",toString:function(){if(0===this.value)return 1/this.value<0?"-0":"0";if(this.value==Number.POSITIVE_INFINITY)return"INF";if(this.value==Number.NEGATIVE_INFINITY)return"-INF";var t,e=this.value,n=Math.abs(e);if(n>=1e6||1e-6>n){t=e.toExponential();var r=t.indexOf("e"),o=t.substring(0,r);o.includes(".")||(o+=".0");var i=t.substring(r+1);return o+"E"+i.replace("+","")}if("float"===this.type&&e%1!=0){var a=0>e?e-5e-8:e+5e-8;t=a.toString();var u=t.indexOf(".");return t=t.substring(0,u+6),t.replace(/0+$/,"")}return e.toString()},equals:function(t){return 0===this.compareTo(t)},compareTo:function(t){return"toNumber"in t?this.value<t.toNumber()?-1:this.value==t.toNumber()?0:1:void a(this.type,t.type)},hashCode:function(){return s(this.value)},matchKey:function(){return"n"+this.hashCode()},toNumber:function(){return this.value},toDouble:function(){return this},abs:function(){return new g(Math.abs(this.value),this.type)},negate:function(){return new g(-this.value,this.type)},ceiling:function(){return new g(Math.ceil(this.value),this.type)},floor:function(){return new g(Math.floor(this.value),this.type)},round:function(t){var e;if(0===t)e=Math.round(this.value);else{var n=Math.pow(10,-t);e=Math.round(this.value/n)*n}return new g(e,this.type)},roundHalfToEven:function(t){if(isNaN(this.value)||!isFinite(this.value))return this;var e=new v(Big(this.value)).roundHalfToEven(t);return 0==e.toNumber()&&this.value<0&&(e=S["double"].fromString("-0")),S[this.type].cast(e)}},d.prototype={value:0,type:"integer",toString:function(){return this.value.toString()},equals:function(t){return 0===this.compareTo(t)},compareTo:function(t){return"toNumber"in t?this.value-t.toNumber():void a(this.type,t.type)},hashCode:function(){return s(this.value)},matchKey:function(){return"n"+this.hashCode()},toDouble:function(){return new g(this.value)},toNumber:function(){return this.value},toBig:function(){return new Big(this.value)},abs:function(){return new d(Math.abs(this.value))},negate:function(){return new d(-this.value)},ceiling:function(){return this},floor:function(){return this},round:function(t){if(0>t){var e=Math.pow(10,-t);return new d(Math.round(this.value/e)*e)}return this},roundHalfToEven:function(t){if(0>t){var e=Math.pow(10,-t);return new d(parseInt(Big(this.value).div(e).round(0,2).times(e),10))}return this}},v.prototype={value:null,type:"decimal",toString:function(){return this.value.toFixed()},equals:function(t){return 0===this.compareTo(t)},compareTo:function(t){return t instanceof v?this.value.cmp(t.value):"toDouble"in t?this.value-t.toDouble().value:void a(this.type,t.type)},hashCode:function(){
return s(this.toNumber())},matchKey:function(){return"n"+this.hashCode()},toBig:function(){return this.value},toDouble:function(){return new g(parseFloat(this.value))},toNumber:function(){return parseFloat(this.value)},abs:function(){return new v(this.value.abs(),this.type)},negate:function(){var t=Big(this.value);return t.s=-t.s,new v(t,"decimal"==this.type?"decimal":"integer")},ceiling:function(){return new v(this.value.round(0,this.value.s<0?0:3),this.type)},floor:function(){return new v(this.value.round(0,this.value.s<0?3:0),this.type)},round:function(t){function e(t,e){var n=new Big(t);return n.e+=e,n}var n=this.value,r=0;0>t&&(r=t,t=0,n=e(n,r));var o=n.s>0?Big(0):this.floor().abs();return n=n.plus(o).round(t,1).minus(o),0!==e&&(n=e(n,-r)),new v(n,"decimal"==this.type?"decimal":"integer")},roundHalfToEven:function(t){var e;if(0>t){var n=Big(10).pow(-t);e=this.value.div(n).round(0,2).times(n)}else e=this.value.round(t,2);return new v(e,"decimal"==this.type?"decimal":"integer")}},y.prototype={value:null,type:"boolean",toString:function(){return this.value.toString()},toBoolean:function(){return this.value},compareTo:function(t){return t instanceof y?(this.value?1:0)-(t.value?1:0):void a(this.type,t.type)},equals:function(t){return 0===this.compareTo(t)},hashCode:function(){return this.value.toString()},matchKey:function(){return"b"+this.toString()}},x.prototype={prefix:null,uri:null,local:null,type:"QName",toEQName:function(){return"Q{"+this.uri+"}"+this.local},toString:function(){return(this.prefix.length>0?this.prefix+":":"")+this.local},equals:function(t){return t instanceof x&&this.local==t.local&&this.uri==t.uri},compareTo:function(){throw new r("QNames are not ordered","FORG0006")},hashCode:function(){return this.uri.substring(this.uri.length-3)+":"+new p(this.local).hashCode()},matchKey:function(){return"q"+this.toEQName()}},b.prototype={type:"dateTime",UTCdate:null,timezoneOffset:null,proxy:function(){var t=new Date,e=null!==this.timezoneOffset?this.timezoneOffset:-t.getTimezoneOffset();return new Date(this.UTCdate.getTime()+60*e*1e3)},_ISOEdit:function(t){if(t=t.substr(0,t.length-1),0===this.UTCdate.getUTCMilliseconds())t=t.replace(".000","");else for(;"0"==t.charAt(t.length-1);)t=t.substr(0,t.length-1);return t=t.replace(/^-0?0?/,"-")},toString:function(){function t(t){switch(t){case"dateTime":case"dateTimeStamp":return e;case"date":return e.substring(0,10+n);case"time":return e.substring(11+n);case"gYearMonth":return e.substring(0,7+n);case"gYear":return e.substring(0,4+n);case"gMonthDay":return"-"+e.substring(4+n,10+n);case"gMonth":return"-"+e.substring(4+n,7+n);case"gDay":return"--"+e.substring(7+n,10+n);default:throw"type not recognised "+t}}var e=this._ISOEdit(this.proxy().toISOString()),n="-"==e.charAt(0)?1:0;return t(this.type)+this.tzOffsetToString()},compareTo:function(t){return t instanceof b&&(e(t.type,this.type)||e(this.type,t.type))?+this.UTCdate.getTime()-t.UTCdate.getTime():void a(this.type,t.type)},equals:function(t){return 0===this.compareTo(t)},hashCode:function(){return s(this.UTCdate.getTime()-1454346732296)},matchKey:function(){return"t"+this.hashCode()},adjustByMinutes:function(t){return S.dateTime.fromDate(new Date(this.UTCdate.getTime()+60*t*1e3),this.timezoneOffset)},addMonths:function(t){var e=this.toString(),n=parseInt(e.substring(0,4),10),r=parseInt(e.substring(5,7),10),o=parseInt(e.substring(8,10),10),i=n+Math.floor((r+t-1)/12),a=0>i,u=(r+t-1)%12+1;for(0>=u&&(u+=12);!D([i,u,o,0,0,0]);)o-=1;return S[this.type].fromString((a?"-"+w(-i):w(i))+"-"+T(u)+"-"+T(o)+e.substring(10))},tzOffsetToString:function(){var t=this.timezoneOffset;if(null===t)return"";if(0===t)return"Z";var e=Math.abs(t);return(0>t?"-":"+")+T(Math.floor(e/60))+":"+T(e%60)}},E.prototype={type:"duration",months:0,milliseconds:0,parts:function(){function t(t,n){n.forEach(function(n){1e3!=n?(e.push(Math.floor(t/n)),t%=n):e.push(t/n)})}var e=[];return t(Math.abs(this.months),[12,1]),t(Math.abs(this.milliseconds),[864e5,36e5,6e4,1e3]),e},signum:function(){var t=this.months+this.milliseconds;return 0>t?-1:t>0?1:0},toString:function(){var t,e=this.signum();return 0===e?t="yearMonthDuration"==this.type?"P0M":"PT0S":(t=0>e?"-P":"P",this.parts().forEach(function(e,n){3==n&&(t+="T"),0!==e&&(t+=6==n?e/1e3+"S":e+["Y","M","D","H","M","S"][n])}),t=t.replace(/T$/,"")),t},compareTo:function(t){if(S.yearMonthDuration.matches(this)&&S.yearMonthDuration.matches(t))return this.months-t.months;if(S.dayTimeDuration.matches(this)&&S.dayTimeDuration.matches(t))return this.milliseconds-t.milliseconds;throw new r("Cannot compare durations that mix months and seconds","XPTY0004")},equals:function(t){return t instanceof E&&this.months==t.months&&this.milliseconds==t.milliseconds},hashCode:function(){return this.months.toString()+":"+this.milliseconds.toString()},matchKey:function(){return"d"+this.hashCode()}};var X={hierarchy:R,isSubtype:e,anyAtomicType:{name:"anyAtomicType",matches:function(t){return t instanceof p||t instanceof v||t instanceof d||t instanceof g||t instanceof h||t instanceof y||t instanceof E||t instanceof b||t instanceof x}},untypedAtomic:{name:"untypedAtomic",fromString:function(t){return new p(t,"untypedAtomic")},matches:function(t){return"untypedAtomic"==t.type},cast:function(t){return new p(t.toString(),"untypedAtomic")}},string:{name:"string",fromString:function(t){return new p(t,"string")},matches:function(t){return e(t.type,"string")},cast:function(t){return new p(t.toString(),"string")},isStringLike:function(t){return t instanceof p}},anyURI:{name:"anyURI",fromString:function(t){var e=t.replace(/[ \r\t\n]+/g," ").replace(/^[ ]|[ ]$/g,"");return new p(e,"anyURI")},matches:function(t){return"anyURI"==t.type},cast:function(t){return t instanceof p?S.anyURI.fromString(t.toString()):void n(t,"anyURI")}},"double":{name:"double",fromString:function(t){return new g(u(t,!0))},fromStringUnfailing:function(t){return new g(u(t,!1))},fromNumber:function(t){return new g(t)},matches:function(t){return"double"==t.type},cast:function(t){return null==t?S["double"].fromNumber(NaN):S.string.matches(t)||S.untypedAtomic.matches(t)?S["double"].fromString(t.toString()):S.numeric.matches(t)?S["double"].fromNumber(t.toNumber()):S["boolean"].matches(t)?S["double"].fromNumber(t.toBoolean()?1:0):"number"==typeof t?S["double"].fromNumber(t):void n(t,"double")}},decimal:{name:"decimal",fromString:function(t){return t=_.trim(t),/^(\+|-)?([0-9]+(\.[0-9]*)?|\.[0-9]+)$/.test(t)?new v(new Big(t)):(/INF|NaN/.test(t)&&i(t,"decimal"),void o(t,"decimal"))},fromBig:function(t){return new v(t)},fromNumber:function(t){if(isNaN(t)||!isFinite(t))throw new r("Cannot convert NaN or INF to a decimal","FOCA0002");return new v(new Big(t))},matches:function(t){return t instanceof v||t instanceof d},cast:function(t){return S.decimal.matches(t)?new v(t.value,"decimal"):S.string.matches(t)||S.untypedAtomic.matches(t)?S.decimal.fromString(t.toString()):S.numeric.matches(t)?S.decimal.fromNumber(t.toNumber()):S["boolean"].matches(t)?S.decimal.fromString(t.toBoolean()?"1":"0"):void n(t,"decimal")}},"float":{name:"float",fromString:function(t){return new g(u(t,!0),"float")},fromNumber:function(t){return Math.fround&&(t=Math.fround(t)),new g(t,"float")},matches:function(t){return"float"==t.type},cast:function(t){return S["float"].fromNumber(S["double"].cast(t).toNumber())}},"boolean":{name:"boolean",fromString:function(t){switch(_.trim(t)){case"true":case"1":return new y(!0);case"false":case"0":return new y(!1);default:o(t,"boolean")}},fromBoolean:function(t){return new y(t)},matches:function(t){return t instanceof y},cast:function(t){return S.string.matches(t)||S.untypedAtomic.matches(t)?S["boolean"].fromString(t.toString()):S.numeric.matches(t)?S["boolean"].fromBoolean(0!==t.toNumber()&&!isNaN(t.toNumber())):S["boolean"].matches(t)?t:"boolean"==typeof t?S["boolean"].fromBoolean(t):void n(t,"boolean")}},integer:{name:"integer",base:"decimal",matches:function(t){return e(t.type,"integer")},fromString:function(t){return/^\s*(\-|\+)?[0-9]+\s*$/.test(t)?t.length>9?new v(t,"integer"):new d(parseInt(t,10)):(/INF|NaN/.test(t)&&i(t,"integer"),void o(t,"integer"))},fromNumber:function(t){if(isNaN(t)||t==Number.NEGATIVE_INFINITY||t==Number.POSITIVE_INFINITY)throw new r("Cannot convert NaN or INF to an integer","FOCA0002");return new d(Math.trunc(t))},fromBig:function(t){return new v(t,"integer")},valid:function(t){return 0===t.value.mod(1)},cast:function(t){return S.string.matches(t)||S.untypedAtomic.matches(t)?S.integer.fromString(t.toString()):S.numeric.matches(t)?S.integer.fromNumber(t.toNumber()):S["boolean"].matches(t)?S.integer.fromNumber(t.toBoolean()?1:0):void n(t,"integer")},convertFromJS:function(t){return"number"==typeof t?S.integer.fromNumber(t):"boolean"==typeof t?S.integer.fromNumber(t?1:0):"string"==typeof t?S.integer.fromString(t):S.integer.fromString(t.toString())}},numeric:{name:"numeric",members:["double","decimal","float"],matches:function(t){return t instanceof g||t instanceof d||t instanceof v},cast:function(t){return S.string.matches(t)||S.untypedAtomic.matches(t)?S["double"].fromString(t.toString()):S.numeric.matches(t)?t:S["boolean"].matches(t)?S["double"].fromNumber(t.toBoolean()?1:0):void n(t,"numeric")},numberFn:function(t){var e=S["double"];if(null===t)return e.fromNumber(Number.NaN);if(S["boolean"].matches(t))return e.fromNumber(t.toBoolean()?1:0);if(S.numeric.matches(t))return e.cast(t);try{return e.fromString(t.toString())}catch(n){return e.fromNumber(Number.NaN)}}},QName:{name:"QName",matches:function(t){return t instanceof x},fromParts:function(t,e,n){return new x(t,e,n)},fromString:function(t,e){if(t=_.trim(t),"Q{"==t.substring(0,2))return S.QName.fromEQName(t);_.isQName(t)||o(t,"QName");var n=t.split(":");if(1==n.length)return S.QName.fromParts("",e(""),n[0]);var i=e(n[0]);if(null===i)throw r("Undeclared prefix: "+n[0],"FONS0004");return S.QName.fromParts(n[0],i,n[1])},fromEQName:function(t){var e=t.indexOf("{"),n=t.indexOf("}"),o=C.wsCollapse(t.substring(e+1,n));if("http://www.w3.org/2000/xmlns/"==o)throw r("Use of reserved namespace: "+o,"XQST0070");return new x("",o,t.substring(n+1))},cast:function(t,e){if(S.string.matches(t)||S.untypedAtomic.matches(t)){if(e)return S.QName.fromString(t.toString(),e);throw r("Casting to QName requires a namespace resolver","FORG0001")}return S.QName.matches(t)?t:void n(t,"QName")}},dateTime:{name:"dateTime",matches:function(t){return e(t.type,"dateTime")},fromString:function(t){return I(t,"dateTime")},fromDate:function(t,e){return new b(t,e,"dateTime")},cast:function(t){return S.dateTime.matches(t)?t:S.date.matches(t)?S.dateTime.fromDate(t.UTCdate,t.timezoneOffset):S.string.matches(t)||S.untypedAtomic.matches(t)?S.dateTime.fromString(t.toString()):void n(t,"dateTime")}},date:{name:"date",matches:function(t){return t instanceof b&&"date"==t.type},fromString:function(t){return I(t,"date")},fromDate:function(t,e){var n=new b(t,e,"date"),r=n.toString(),o="-"==r.charAt(0)?11:10,i=S.dateTime.fromString(r.substring(0,o)+"T00:00:00"+r.substring(o));return new b(i.UTCdate,e,"date")},cast:function(t){return S.date.matches(t)?t:S.dateTime.matches(t)?S.date.fromDate(t.UTCdate,t.timezoneOffset):S.string.matches(t)||S.untypedAtomic.matches(t)?S.date.fromString(t.toString()):void n(t,"date")}},time:{name:"time",matches:function(t){return t instanceof b&&"time"==t.type},fromString:function(t){return I(t,"time")},fromDate:function(t,e){var n=new b(t,e,"time"),r=S.dateTime.fromString("1972-01-01T"+n.toString());return new b(r.UTCdate,e,"time")},cast:function(t){return S.time.matches(t)?t:S.dateTime.matches(t)?S.time.fromDate(t.UTCdate,t.timezoneOffset):S.string.matches(t)||S.untypedAtomic.matches(t)?S.time.fromString(t.toString()):void n(t,"time")}},dateTimeStamp:{name:"dateTimeStamp",matches:function(t){return t instanceof b&&"dateTimeStamp"==t.type},fromString:function(t){return I(t,"dateTimeStamp")},fromDate:function(t,e){return new b(t,e,"dateTimeStamp")},cast:function(t){return S.dateTimeStamp.matches(t)?t:S.dateTime.matches(t)||S.date.matches(t)?S.dateTimeStamp.fromDate(t.UTCdate,t.timezoneOffset):S.string.matches(t)||S.untypedAtomic.matches(t)?S.dateTimeStamp.fromString(t.toString()):void n(t,"dateTimeStamp")}},duration:{name:"duration",matches:function(t){return e(t.type,"duration")},fromString:function(t){return P(t,"duration")},fromMonthsMilliseconds:function(t,e){return new E(t,e,"duration")},cast:function(t){return S.duration.matches(t)?t:S.string.matches(t)||S.untypedAtomic.matches(t)?S.duration.fromString(t.toString()):void n(t,"duration")}},hexBinary:{name:"hexBinary",matches:function(t){return"hexBinary"===t.type},fromString:function(t){return new h(m(t),"hexBinary")},cast:function(t){return t instanceof h?new h(t.value,"hexBinary"):S.string.matches(t)||S.untypedAtomic.matches(t)?new h(m(t.toString()),"hexBinary"):void n(t,"hexBinary")}},base64Binary:{name:"base64Binary",matches:function(t){return"base64Binary"===t.type},fromString:function(t){return new h(l(t),"base64Binary")},encodeFromString:function(t){return new h(t,"base64Binary")},cast:function(t){return t instanceof h?new h(t.value,"base64Binary"):S.string.matches(t)||S.untypedAtomic.matches(t)?new h(l(t.toString()),"base64Binary"):void n(t,"base64Binary")}}};O("gYearMonth"),O("gYear"),O("gMonthDay"),O("gMonth"),O("gDay");var J={dateTime:/^\s*(-?(?:[1-9][0-9]{4,}|[0-9]{4})-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(?:\.[0-9]+)?)(Z|(\+|-)[0-9]{2}:[0-9]{2})?\s*$/,date:/^\s*(-?(?:[1-9][0-9]{4,}|[0-9]{4})-[0-9]{2}-[0-9]{2})(Z|(\+|-)[0-9]{2}:[0-9]{2})?\s*$/,time:/^\s*([0-9]{2}:[0-9]{2}:[0-9]{2}(?:\.[0-9]+)?)(Z|(\+|-)[0-9]{2}:[0-9]{2})?\s*$/,dateTimeStamp:/^\s*(-?[0-9]+-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(?:\.[0-9]+)?)(Z|(\+|-)[0-9]{2}:[0-9]{2})\s*$/,gYearMonth:/^\s*(-?(?:[1-9][0-9]{4,}|[0-9]{4})-[0-9]{2})(Z|(\+|-)[0-9]{2}:[0-9]{2})?\s*$/,gYear:/^\s*(-?[1-9][0-9]{4,}|-?[0-9]{4})(Z|(\+|-)[0-9]{2}:[0-9]{2})?\s*$/,gMonthDay:/^\s*--([0-9]{2}-[0-9]{2})(Z|(\+|-)[0-9]{2}:[0-9]{2})?\s*$/,gMonth:/^\s*--([0-9]{2})(Z|(\+|-)[0-9]{2}:[0-9]{2})?\s*$/,gDay:/^\s*---([0-9]{2})(Z|(\+|-)[0-9]{2}:[0-9]{2})?\s*$/,duration:/^\s*\-?P(?:([0-9]+)Y)?(?:([0-9]+)M)?(?:([0-9]+)D)?(?:T(?:([0-9]+)H)?(?:([0-9]+)M)?(?:([0-9]+(?:\.[0-9]*)?)S)?)?\s*$/,dayTimeDuration:/^\s*\-?P(?:([0-9]+)D)?(?:T(?:([0-9]+)H)?(?:([0-9]+)M)?(?:([0-9]+(?:\.[0-9]*)?)S)?)?\s*$/,yearMonthDuration:/^\s*\-?P(?:([0-9]+)Y)?(?:([0-9]+)M)?\s*$/},L={dateTime:function(t){return A(t)},date:function(t){return t+"T00:00:00"},time:function(t){return"1972-01-01T"+A(t)},dateTimeStamp:function(t){return A(t)},gYearMonth:function(t){return t+"-01T00:00:00"},gYear:function(t){return t+"-01-01T00:00:00"},gMonthDay:function(t){return"1972-"+t+"T00:00:00"},gMonth:function(t){return"1972-"+t+"-01T00:00:00"},gDay:function(t){return"1972-01-"+t+"T00:00:00"}},$=function(t,e){return e*(void 0===t?0:parseInt(t,10))},z=function(t,e){return e*(void 0===t?0:Math.round(1e3*parseFloat(t)))},G=function(t,e){return e?-t:t},q=[function(t,e){return G($(t[1],12)+$(t[2],1),e.match(/^\s*\-.*/))},function(t,e){return G($(t[3],864e5)+$(t[4],36e5)+$(t[5],6e4)+z(t[6],1),e.match(/^\s*\-.*/))},function(t,e){return G($(t[1],864e5)+$(t[2],36e5)+$(t[3],6e4)+z(t[4],1),e.match(/^\s*\-.*/))},function(){return 0}],Q={duration:[0,1],dayTimeDuration:[3,2],yearMonthDuration:[0,3]};return X._init=U,X}(),N=function(){"use strict";function t(t,e,n,r){for(var o,i,a=S.numeric.matches,u=S.untypedAtomic.matches;null!==(o=t.next());)for(var s=A.ForArray(e);null!==(i=s.next());){var c=u(o)?u(i)?S.string.cast(o):a(i)?S["double"].cast(o):S[i.type].cast(o):o,l=u(i)?u(o)?S.string.cast(i):a(o)?S["double"].cast(i):S[o.type].cast(i):i;if(!(a(c)&&isNaN(c.value)||a(l)&&isNaN(l.value))){var f="="==n?r.equals(c,l):"!="==n?!r.equals(c,l):_(n,r.compare(c,l));if(f)return A.oneBoolean(!0)}}return A.oneBoolean(!1)}function e(t){return{equals:function(e,n){var r=S.numeric.matches,o=function(t){return S.numeric.numberFn(t).toNumber()};S.untypedAtomic.matches;return r(e)||r(n)?o(e)===o(n):t.equals(e,n)},compare:t.compare}}function n(e,n,r){var o=C,i=o.evalChild1(e,n),a=o.evalChild2(e,n).expand(),u=y(e.getAttribute("comp"),n);return r||(r=e.getAttribute("op")),t(i,a,r,u)}function o(t,e){return t.equals(e)}function i(t,e){return t.compareTo(e)}function a(t){return null===t}function u(t){return(S["double"].matches(t)||S["float"].matches(t))&&isNaN(t.toNumber())}function s(t,e){return function(n,r){return e(n)||e(r)?e(n)?e(r):!1:t(n,r)}}function c(t,e){return function(n,r){return e(n)||e(r)?e(n)?e(r)?0:-1:1:t(n,r)}}function l(t){return c(t,a)}function f(t){return c(t,u)}function m(t,e){return null===t?NaN:S.numeric.matches(t)?t.toNumber():e?S["double"].fromString(t.toString()).toNumber():S["double"].fromStringUnfailing(t.toString()).toNumber()}function p(t){return function(e,n){var r=m(e,t),o=m(n,t);return isNaN(r)?isNaN(o)?0:-1:isNaN(o)?1:r-o}}function h(t){return function(e,n){var r=m(e,t),o=m(n,t);return isNaN(r)?isNaN(o):isNaN(o)?!1:r-o===0}}function g(t,e){return function(n,r){var o=n.toString(),i=r.toString(),a=o.toLowerCase(),u=i.toLowerCase(),s=t(a,u);if(0===s){for(var c=0;c<o.length;c++)if(o.charAt(c)!=i.charAt(c))return e==(o.charAt(c)==o.charAt(c).toLowerCase())?-1:1;return 0}return s}}function d(t){return function(e,n){return S.string.isStringLike(e)&&S.string.isStringLike(n)?t(e.value,n.value):e.equals(n)}}function v(t){return function(e,n){return S.string.isStringLike(e)&&S.string.isStringLike(n)?t(e.value,n.value):e.compareTo(n)}}function y(t,e){var n=t.split("|");if("DESC"==n[0]){var c=y(t.slice(5),e);return{equals:c.equals,compare:function(t,e){return c.compare(e,t)}}}var m,g,N={};switch(n[0]){case"NC":return N.equals=h(!1),N.compare=p(!1),N;case"QUNC":return N.equals=h(!0),N.compare=p(!0),N;case"DblSC":return N.equals=s(o,u),N.compare=l(f(i)),N;case"CCC":return N.equals=d(Q().equals),N.compare=l(v(Q().compare)),N;case"TEXT":m=n[1]||H,g=G(m,e),q(g,m);var x=function(t,e){return g.equals(t.toString(),e.toString())};N.equals=s(x,a);var b=function(t,e){return v(g.compare)(S.string.cast(t),S.string.cast(e))};return N.compare=l(b),N;case"CAVC":case"DecSC":case"GAC":case"AtSC":case"CalVC":return{equals:s(o,a),compare:l(f(i))};case"EQC":return N.equals=s(o,a),N.compare=function(t,e){return N.equals(t,e)?0:1},N;case"CAC":return m=n[1]||H,g=G(m,e),q(g,m),N.equals=function(t,e){return g.equals(t.toString(),e.toString())},N.compare=function(t,e){return g.compare(t.toString(),e.toString())},N;default:throw new r("Unknown comparer "+t,"SXJS0003")}}function x(t,e){var n=C,o=null;t.hasAttribute("comp")&&(o=t.getAttribute("comp"),o=o.replace(/^DESC\|/,""));var i=n.evaluateIfPresent(n.argRole(t,"collation"),e).next(),a=n.evaluateIfPresent(n.argRole(t,"order"),e).next(),u=n.evaluateIfPresent(n.argRole(t,"lang"),e).next(),s=n.evaluateIfPresent(n.argRole(t,"caseOrder"),e).next(),c=n.evaluateIfPresent(n.argRole(t,"dataType"),e).next();s=null===i&&null!==s?s.toString():"#default";try{u=null===i&&null!==u&&""!==u.toString()?S.language.fromString(u.toString()):null}catch(l){throw r("@lang: "+l.message,"XTDE0030")}return a=null===a?"ascending":a.toString(),c=null===c?null:c.toString(),i=null===i?H:i.toString(),{comp:o,collation:i,order:a,lang:u,caseOrder:s,dataType:c}}function b(t,e){return O(x(t,e),e)}function O(t,e){function n(e){return"descending"==t.order?function(t,n){return e(n,t)}:e}var r=G(t.collation,e);q(r,t.collation);var o=r.compare,a="#default"!=t.caseOrder?g(o,"lower-first"==t.caseOrder):v(o);if("number"==t.dataType)return n(p(!1));if("text"==t.dataType){var u=function(t,e){return a(S.string.cast(t),S.string.cast(e))};return n(l(u))}if(t.comp){var s=t.comp;if("DblSC"==s)return n(l(f(i)));if("CalVC"==s||"DecSC"==s)return n(l(i));if("CCC"==s)return n(l(a))}return n(a)}function _(t,e){switch(t){case"=":case"eq":return 0===e;case"<":case"lt":return 0>e;case">":case"gt":return e>0;case">=":case"ge":return e>=0;case"<=":case"le":return 0>=e;case"!=":case"ne":return 0!==e;default:throw new r("Unknown operator "+t,"SXJS0003")}}function F(t,e){switch(t){case"=":case"eq":return e;case"!=":case"ne":return!e;case"<":case"lt":case">":case"gt":case">=":case"ge":case"<=":case"le":throw new r("Operator "+t+" not allowed for unordered types","SXJS0003");default:throw new r("Unknown operator "+t,"SXJS0003")}}function I(t,e,n){var r=t.expand(),o=e.expand();t=A.ForArray(r),e=A.ForArray(o);for(var i,a;;){if(i=t.next(),a=e.next(),null===i)return null===a;if(null===a)return!1;if(!M(i,a,n))return!1}}function M(t,e,n){var o=T;if(t===e)return!0;if(o.isNode(t)){if(!o.isNode(e)||!o.isSameNodeType(t.nodeType,e.nodeType))return!1;switch(t.nodeType){case o.DOCUMENT_NODE:case o.DOCUMENT_FRAGMENT_NODE:return I(E.child(t),E.child(e));case o.ELEMENT_NODE:if(!o.nameOfNode(t).equals(o.nameOfNode(e)))return!1;var i=E.attribute(t).expand();if(i.length!=E.attribute(e).count())return!1;var a;for(a=0;a<i.length;a++){var s=i[a],c=o.nameOfNode(s),l=c.uri?c.uri:null;if(!e.hasAttributeNS(l,c.local))return!1;if(e.getAttributeNS(l,c.local)!=s.value)return!1}return I(E.child(t),E.child(e),n);case o.ATTRIBUTE_NODE:return o.nameOfNode(t).equals(o.nameOfNode(e))&&t.value==e.value;case o.NAMESPACE_NODE:return t.prefix==e.prefix&&t.uri==e.uri;case o.PROCESSING_INSTRUCTION_NODE:return t.target==e.target&&(n?n(t.textContent,e.textContent):t.textContent==e.textContent);case o.TEXT_NODE:case o.COMMENT_NODE:return n?n(t.textContent,e.textContent):t.textContent==e.textContent;default:throw new r("Unknown node type "+t.nodeType,"SXJS0003")}}else{if(C.isArray(t)){if(!C.isArray(e)||e.value.length!=t.value.length)return!1;for(var f=0;f<t.value.length;f++)if(!I(A.ForArray(t.value[f]),A.ForArray(e.value[f],n)))return!1;return!0}if(C.isMap(t)){if(!C.isMap(e))return!1;var m=t.keys(),p=e.keys();return m.length!=p.length?!1:A.ForArray(m).every(function(n){return e.containsKey(n)&&I(A.ForArray(t.get(n)),A.ForArray(e.get(n)))})}if(u(t)&&u(e))return!0;if(n&&S.string.isStringLike(t)&&S.string.isStringLike(e))return n(t.value,e.value);try{return t.equals(e)}catch(h){return!1}}}function k(t,e,n){for(var r=t.next(),o=e.next();;){if(null===r)return null===o?0:-1;if(null===o)return 1;if(n){if(!M(r,o,n.equals))return u(r)?-1:S.string.matches(r)&&S.string.matches(o)?n.compare(r.value,o.value):r.compareTo(o);r=t.next(),o=e.next()}else{if(!M(r,o))return u(r)?-1:r.compareTo(o);r=t.next(),o=e.next()}}}function P(t,e){return t.map(function(t){var n=C.argRole(t,"dataType"),r=null===n?null:C.evaluate(n,e).next();return"number"==r?function(t){return null===t?null:S["double"].fromStringUnfailing(t.toString())}:"text"==r?function(t){return null===t?null:S.string.cast(t)}:function(t){return t}})}function U(t,e){var n=T,r=A.Tracker(C.evalChild1(t,e)),o=[],i=n.getChildElements(t,"sortKey"),a=i.map(function(t){return b(t,e)}),u=P(i,e),s=e.newContext(!1);return s.tempOutputState="sort key",s.focus=r,r.forEachItem(function(t){var e=i.map(function(t,e){return u[e](C.evalChild1(t,s).next())});o.push({item:t,keys:e})}),o.sort(function(t,e){var n;for(n=0;n<a.length;n++){var r=a[n](t.keys[n],e.keys[n]);if(0!==r)return r}return 0}),A.ForArray(o).mapOneToOne(function(t){return t.item})}function R(t,e){function n(t){var e=[];return o.forEachItem(function(n){t(e,n)}),e}var o=A.Tracker(C.evaluate(C.argRole(t,"select"),e)),i=e.newContext(!1);i.focus=o;var a={starting:function(){var e=D(C.argRole(t,"match"));return n(function(t,n){1==o.position||e(n,i)?t.push({group:[n]}):t[t.length-1].group.push(n)})},ending:function(){var e=D(C.argRole(t,"match")),r=!1;return n(function(t,n){1==o.position||r?t.push({group:[n]}):t[t.length-1].group.push(n),r=e(n,i)})},adjacent:function(){var r=C.argRole(t,"collation"),a=r?C.evaluate(r,e).next().toString():H,u=G(a,e),s=C.argRole(t,"key"),c=null;return n(function(t,e){var n=C.evaluate(s,i).expand();1!=o.position&&I(A.ForArray(n),A.ForArray(c),u.equals)?t[t.length-1].group.push(e):(t.push({group:[e],key:n}),c=n)})},by:function(){var r=C.argRole(t,"collation"),o=r?C.evaluate(r,e).next().toString():H,a=G(o,e),u=N.trieWithCollation(a),s=C.argRole(t,"key");return n(function(t,e){var n,r=[];C.evaluate(s,i).forEachItem(function(o){u.containsKey(o)?(n=u.get(o),r.findIndex(function(t){return t==n})<0&&(t[n].group.push(e),r.push(n))):(n=t.length,t.push({group:[e],key:[o]}),u.inSituPut(o,n),r.push(n))})})},by_c:function(){var o=C.argRole(t,"collation"),a=o?C.evaluate(o,e).next().toString():H,u=G(a,e),s=C.argRole(t,"key"),c=new w,l=u.collationKey;if(!l)throw new r("Collation is unsuitable for keys and grouping","XTDE1110");return c.options={sameKey:function(t,e){return I(A.ForArray(t),A.ForArray(e),u.equals)},hash:function(t){return t.map(function(t){return S.string.isStringLike(t)?l(t.matchKey()):t.matchKey()}).join()}},n(function(t,e){var n,r=C.evaluate(s,i).expand();c.containsKey(r)?(n=c.get(r),t[n].group.push(e)):(n=t.length,t.push({group:[e],key:r}),c.inSituPut(r,n))})}};a.adjacent_c=a.adjacent;var u=t.getAttribute("algorithm")+(C.hasFlag(t,"c")?"_c":""),s=a[u](),c=T.getChildElements(t,"sortKey");if(c.length>0){var l=A.Tracker(A.ForArray(s)),f=e.newContext(!1);f.focus=l;var m=c.map(function(t){return b(t,e)});l.forEachItem(function(t,e){t.sortKeys=c.map(function(n){var r=f.focus;return r.current=t.group[0],r.position=e+1,f.currentGroup=t.group,f.currentGroupingKey=t.key,C.evalChild1(n,f).next()})}),s.sort(function(t,e){for(var n=0;n<m.length;n++){var r=m[n](t.sortKeys[n],e.sortKeys[n]);if(0>r)return-1;if(r>0)return 1}return 0})}var p=e.newContext(!1);p.focus=A.Tracker(A.ForArray(s));for(var h,g=C.argRole(t,"content"),d=[],v=0;null!==(h=p.focus.next());){var y=s[v++],x=p.focus;x.current=y.group[0],x.position=v,p.currentGroup=y.group,p.currentGroupingKey=y.key,Array.prototype.push.apply(d,C.evaluate(g,p).expand())}return A.ForArray(d)}function B(t,e){for(var n=C,r=n.stringToCodepoints(t.toString()),o=n.stringToCodepoints(e.toString()),i=0;;){if(i==r.length)return i==o.length?0:-1;if(i==o.length)return 1;if(r[i]!=o[i])return r[i]-o[i];i++}}function X(t,e){if(C.isAstral(t)||C.isAstral(e)){var n=B(t,e);return 0>n?-1:0===n?0:1}return e>t?-1:t==e?0:1}function J(t,e){return t.substring(0,e.length)===e}function L(t,e){return t.substring(t.length-e.length)===e}function $(t,e,n){return G(z(t,e),n)}function z(t,e){return e?e.next().toString():T.getAttribute(t,"collation")}function G(t,e){var n=t&&!J(t,W)?e.fixed.options.collations[t]:Q();if(!n)throw r("Unrecognized collation "+t,"FOCH0002");return n}function q(t,e){if(!t.hasOwnProperty("compare")||!t.hasOwnProperty("compare"))throw r("Collation "+e+" cannot be used for sorting","XTDE1035")}function Q(){return{equals:function(t,e){return t===e},compare:function(t,e){return X(t,e)},contains:function(t,e){return-1!=t.indexOf(e)},startsWith:function(t,e){return J(t,e)},endsWith:function(t,e){return L(t,e)},indexOf:function(t,e){return t.indexOf(e)},collationKey:function(t){return t}}}function K(){function t(t){return t?(t+"").toUpperCase():""}return{equals:function(e,n){return t(e)===t(n)},compare:function(e,n){return X(t(e),t(n))},contains:function(e,n){return-1!=t(e).indexOf(t(n))},startsWith:function(e,n){return J(t(e),t(n))},endsWith:function(e,n){return L(t(e),t(n))},indexOf:function(e,n){return t(e).indexOf(t(n))},collationKey:function(e){return t(e)}}}function V(t){var e=new w,n=t.collationKey;if(!n)throw new r("Collation is unsuitable for keys and grouping","XTDE1110");var o=function(t){return S.string.isStringLike(t)?n(t.matchKey()):t.matchKey()};return e.options={sameKey:function(t,e){return o(t)===o(e)},hash:function(t){return o(t)}},e}function j(t,e,n,o){var i=z(t,e),a=G(i,o),u=a[n];if(!u)throw r("Collation "+i+" has no "+n+" method","FOCH0002",t);return u}var Y="http://www.w3.org/2005/xpath-functions/collation/html-ascii-case-insensitive",H="http://www.w3.org/2005/xpath-functions/collation/codepoint",W="http://www.w3.org/2013/collation/UCA",Z="http://www.w3.org/2010/09/qt-fots-catalog/collation/caseblind",tt="http://www.w3.org/xslts/collation/caseblind";return{allocateCodedComparer:y,allocateCompareFn:b,caseblindCollation:K,cmpFn:v,codepointCollation:Q,codepointCollationUri:H,codepointComparison:X,compareFnWithProps:O,deepEqualItems:M,deepEqualSequences:I,eqFn:d,fotsCaseblindCollationUri:Z,gc:t,gc10comparer:e,generalComparison:n,getCollation:$,getCollatingFn:j,getConverters:P,grouping:R,htmlCaseInsensitiveCollationUri:Y,itemIsNaN:u,lexicographicCompare:k,sortKeyProps:x,sortSequence:U,testComparison:_,testEquality:F,trieWithCollation:V,xsltsCaseblindCollationUri:tt}}(),x=13;e.prototype={prefix:null,uri:null,parentNode:null,nodeType:x};var b=2;n.prototype={qname:null,value:null,parent:null,nodeType:b};var T=function(){"use strict";var t=1;return{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION:4,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NAMESPACE_NODE:13,shallowCopy:function(t,o,i,a){if(T.isNode(t)){var u,s;switch(t.nodeType){case T.DOCUMENT_NODE:case T.DOCUMENT_FRAGMENT_NODE:u=o.resultDocument.createDocumentFragment();var c=o.newContext(!1);C.makeComplexContent(u,a(c),o);break;case T.ELEMENT_NODE:s=T.nameOfNode(t),u=o.createElement(s.uri,s.toString()),i&&i.indexOf("c")>=0&&!(SaxonJS.getPlatform().inBrowser&&u instanceof HTMLElement)&&T.inScopeNamespaces(t).forEach(function(t){T.declareNS(u,t.prefix,t.uri)}),u._saxonBaseUri=T.baseURI(t),C.makeComplexContent(C.markLocal(u,i),a(o),o);break;case T.ATTRIBUTE_NODE:u=new n(T.nameOfNode(t),t.value,null);break;case T.TEXT_NODE:u=o.resultDocument.createTextNode(t.textContent);break;case T.COMMENT_NODE:u=o.resultDocument.createComment(t.textContent);break;case T.PROCESSING_INSTRUCTION_NODE:u=o.resultDocument.createProcessingInstruction(t.target,t.textContent);break;case T.NAMESPACE_NODE:u=new e(t.prefix,t.uri);break;default:throw r("Unknown node type "+t.nodeType,"SXJS0003")}return A.Singleton(C.markLocal(u,i))}return A.Singleton(t)},copyItem:function(t,r,o){if(!T.isNode(t))return t;var i,a,u,s=function(t,e){o&&o.indexOf("m")>=0&&(e._saxonOriginal=t)};switch(t.nodeType){case T.DOCUMENT_NODE:case T.DOCUMENT_FRAGMENT_NODE:var c=r.resultDocument.createDocumentFragment();return i=T.obtainDocumentNumber(c),i._saxonBaseUri=t._saxonBaseUri,C.makeComplexContent(i,E.child(t).mapOneToOne(function(t){return T.copyItem(t,r,o)}),r),s(t,i),C.markLocal(i,o);case T.NAMESPACE_NODE:return new e(t.prefix,t.uri);case T.ELEMENT_NODE:return u=T.nameOfNode(t),a=r.createElement(u.uri,u.toString()),o&&o.indexOf("c")>=0&&!(SaxonJS.getPlatform().inBrowser&&a instanceof HTMLElement)&&T.inScopeNamespaces(t).forEach(function(t){T.declareNS(a,t.prefix,t.uri)}),E.attribute(t).forEachItem(function(t){var e=""===t.namespaceURI?null:t.namespaceURI;a.setAttributeNS(e,t.name,t.value)}),E.child(t).forEachItem(function(t){var e=T.copyItem(t,r,o);e.nodeType==T.ELEMENT_NODE&&""===T.nameOfNode(e).uri&&""!==u.uri&&T.declareNS(e,"",""),a.appendChild(e)}),a._saxonBaseUri=T.baseURI(t),s(t,a),C.markLocal(a,o);case T.DOCUMENT_TYPE_NODE:return null;case T.ATTRIBUTE_NODE:return new n(T.nameOfNode(t),t.value,null);default:return a=SaxonJS.getPlatform().inBrowser?window.document.importNode(t,!0):cloneNode(r.resultDocument,t,!0),s(t,a),C.markLocal(a,o)}},ownerDocument:function(t){return E.ancestorOrSelf(t).expand().pop()},obtainDocumentNumber:function(e){return"_saxonDocumentNumber"in e||(e._saxonDocumentNumber=t++),e},documentNumber:function(t){return T.obtainDocumentNumber(t)._saxonDocumentNumber},nameOfNode:function(t){if(!t||!t.nodeType)return null;switch(t.nodeType){case T.ELEMENT_NODE:return SaxonJS.getPlatform().inBrowser&&t instanceof HTMLElement&&"http://www.w3.org/1999/xhtml"==t.namespaceURI?S.QName.fromParts("","",t.localName):S.QName.fromParts(t.prefix,t.namespaceURI,t.localName);case T.ATTRIBUTE_NODE:return"xml"==t.prefix?S.QName.fromParts(t.prefix,C.KNOWN_URI.xml,t.localName):t.qname;case T.PROCESSING_INSTRUCTION_NODE:return S.QName.fromParts("","",t.target);case T.NAMESPACE_NODE:return t.prefix?S.QName.fromParts("","",t.prefix):null;
default:return null}},getChildElements:function(t,e){for(var n=[],r=t.firstChild;null!==r;)r.nodeType!=T.ELEMENT_NODE||e&&e!=r.tagName||n.push(r),r=r.nextSibling;return n},firstElementChild:function(t,e){for(var n=t.firstChild;null!==n;){if(n.nodeType==T.ELEMENT_NODE&&(!e||e==n.tagName))return n;n=n.nextSibling}return null},inDocumentOrder:function(t){var e=t.expand();return e.sort(T.compareDocumentOrder),A.ForArray(e).mapOneToOne(function(t,n){return n>0&&T.isSameNode(t,e[n-1])?null:t})},compareDocumentOrder:function(t,e){function n(t){return E.ancestor(t).count()}if(T.isSameNode(t,e))return 0;var o=T.xdmParentNode(t),i=T.xdmParentNode(e);if(null===o){if(null===i){var a=T.obtainDocumentNumber;return a(t)._saxonDocumentNumber<a(e)._saxonDocumentNumber?-1:1}return t===i?-1:T.compareDocumentOrder(t,i)}if(null===i)return e===o?1:T.compareDocumentOrder(o,e);if(o!==i){if(t===i)return-1;if(e===o)return 1;var u=n(o),s=n(i);return u==s?T.compareDocumentOrder(o,i):u>s?T.compareDocumentOrder(o,e):T.compareDocumentOrder(t,i)}var c=t.nodeType,l=e.nodeType;if(c==T.ATTRIBUTE_NODE){if(l==T.ATTRIBUTE_NODE){var f,m=o.attributes;for(f=0;f<m.length;f++){var p=S.QName.fromParts(m[f].prefix,m[f].namespaceURI,m[f].localName);if(p.equals(T.nameOfNode(t)))return-1;if(p.equals(T.nameOfNode(e)))return 1}throw r("Att not found in parent","SXJS0004")}return l==T.NAMESPACE_NODE?1:-1}if(c==T.NAMESPACE_NODE)return l==T.NAMESPACE_NODE?t.prefix<e.prefix?-1:1:-1;if(l==T.ATTRIBUTE_NODE||l==T.NAMESPACE_NODE)return 1;for(var h=t,g=e;;){if(h=h.previousSibling,null===h)return-1;if(h===e)return 1;if(g=g.previousSibling,null===g)return 1;if(g===t)return-1}},xdmParentNode:function(t){return T.isAttr(t)?t.parent:t.parentNode},declareNS:function(t,e,n){t.setAttributeNS("http://www.w3.org/2000/xmlns/",""===e?"xmlns":"xmlns:"+e,n)},inScopeNamespaces:function(t){for(var e,n=[{prefix:"xml",uri:C.KNOWN_URI.xml}],r={xml:!0},o=E.ancestorOrSelf(t);null!==(e=o.next())&&e.nodeType==T.ELEMENT_NODE;){var i,a=e.attributes;for(i=0;i<a.length;i++){var u=a[i].name;if("xmlns"==u.substring(0,5))if(5!=u.length||r[""]){if(":"==u.charAt(5)){var s=u.substring(6);r[s]||(r[s]=!0,n.push({prefix:s,uri:a[i].value}))}}else r[""]=!0,""!==a[i].value&&n.push({prefix:"",uri:a[i].value})}}return n},hasNamespaceUndeclaration:function(t){var e=t.attributes.getNamedItem("xmlns");return e&&""===e.value},getInheritedAttribute:function(t,e){for(var n=t;n&&n.nodeType==T.ELEMENT_NODE;){if(n.hasAttribute(e))return n.getAttribute(e);n=n.parentNode}return null},getAttribute:function(t,e,n){return t.hasAttribute(e)?t.getAttribute(e):arguments.length>2?n:null},getAttributeAsEQName:function(t,e,n){var r=T.getAttributeAsQName(t,e,n);return null===r?null:"Q{"+r.uri+"}"+r.local},getAttributeAsQName:function(t,e,n){return t.hasAttribute(e)?T.resolveLexicalQName(t,t.getAttribute(e),n):null},resolveLexicalQName:function(t,e,n){var r=S.QName;if(/^Q\{/.test(e))return r.fromEQName(e);if(/:/.test(e)){var o=function(e){return"xml"==e?C.KNOWN_URI.xml:t.lookupNamespaceURI(e)};return r.fromString(e,o)}var i=n?t.lookupNamespaceURI(null)||"":"";return r.fromParts("",i,e)},isAttr:function(t){return t instanceof n},isNSNode:function(t){return t instanceof e},isNode:function(t){return t instanceof Node&&!(t.nodeType==T.PROCESSING_INSTRUCTION_NODE&&"xml"==t.target)||T.isAttr(t)||T.isNSNode(t)},isSameNode:function(t,e){return t===e||T.isNSNode(t)&&T.isNSNode(e)&&t.parentNode&&e.parentNode&&t.parentNode==e.parentNode&&t.prefix==e.prefix||T.isAttr(t)&&T.isAttr(e)&&t.parent&&e.parent&&t.parent==e.parent&&T.nameOfNode(t).equals(T.nameOfNode(e))},isSameNodeType:function(t,e){return t==e||t==T.DOCUMENT_NODE&&e==T.DOCUMENT_FRAGMENT_NODE||e==T.DOCUMENT_NODE&&t==T.DOCUMENT_FRAGMENT_NODE},isAbsoluteURI:function(t){return/^(?:[a-z]+:)?\/\//i.test(t)},baseURI:function(t){function e(t){var e=T.xdmParentNode(t);return e?T.baseURI(e):t._saxonBaseUri?t._saxonBaseUri:null}if(null===t||T.isNSNode(t))return null;if(t.nodeType==T.ELEMENT_NODE&&t.hasAttribute("xml:base")){var n=t.getAttribute("xml:base");return T.isAbsoluteURI(n)?n:SaxonJS.getPlatform().resolveUri(n.toString(),e(t)).toString()}return e(t)},xmlToString:function(t,e){function n(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function o(t,e,a,c){function f(){S.length-y>i&&(S+="\n"+e+l,y=S.length)}var m,p,h,g,d=a,v=c,y=0,S="",N=!1,x=!1,b=!1;switch(t.nodeType){case T.DOCUMENT_NODE:for(p=t.childNodes,g=0;g<p.length;++g)h=p[g],y=S.length,S+=(g>0?"\n":"")+o(h,"");break;case T.DOCUMENT_FRAGMENT_NODE:for(p=t.childNodes,g=0;g<p.length;++g)h=p[g],y=S.length,S+="\n"+o(h,"");break;case T.ELEMENT_NODE:m=T.nameOfNode(t),S+=(u?e:"")+"<"+m;var w="",C=t.parentNode;if(C&&C.nodeType!=T.ELEMENT_NODE&&(C=null),E.namespace(t).forEachItem(function(t){w="";var e=C?C.lookupNamespaceURI(t.prefix):"unknown";e||""!=t.prefix||(e=C.lookupNamespaceURI(null)),C&&e==t.uri||"xml"==t.prefix||(w=""==t.prefix?' xmlns="'+t.uri+'"':" xmlns:"+t.prefix+'="'+t.uri+'"'),S+=w,f()}),T.hasNamespaceUndeclaration(t)&&(w=' xmlns=""',S+=w,f()),E.attribute(t).forEachItem(function(t){w=" "+t.name+'="'+n(t.value)+'"',S+=w,f()}),S=S.replace(/\s+$/,""),p=t.childNodes,0===p.length)S+="/>";else{for(S+=">",g=0;g<p.length;++g)h=p[g],N=h.nodeType==T.TEXT_NODE&&""!==h.nodeValue,b=!u||N||x,S+=b?"":"\n",S+=o(h,b?"":e+s,d,v),x=N;b||(S+="\n"+e),S+="</"+m+">"}break;case T.ATTRIBUTE_NODE:m=T.nameOfNode(t).toString(),S+=m+'="'+n(t.value)+'"';break;case T.TEXT_NODE:S=t.nodeValue.replace(/&/g,"&amp;").replace(/</g,"&lt;");break;case T.COMMENT_NODE:S+="<!--"+t.nodeValue+"-->";break;case T.PROCESSING_INSTRUCTION_NODE:S+="<?"+t.target+" "+t.nodeValue+"?>";break;case T.DOCUMENT_TYPE_NODE:S+="<!DOCTYPE "+t.name+' SYSTEM "'+t.systemId+'">';break;case T.NAMESPACE_NODE:break;case T.CDATA_SECTION:return t.data;default:throw r("Unknown node type "+t.nodeType,"SXJS0003")}return S}for(var i=e["saxon:line-length"],a=e["saxon:indent-spaces"],u=!0,s="",c=a;c-->0;)s+=" ";var l="  ";return o(t,"",[],"")}}}(),w=function(){"use strict";function e(t,n){if(""===n)return t.leafKVPs;var r=n.charAt(0);return t.subTries.hasOwnProperty(r)?e(t.subTries[r],n.substring(1)):[]}function n(t,n){for(var r=e(t,t.options.hash(n)),o=0;o<r.length;o++)if(t.options.sameKey(r[o].k,n))return r[o];return null}function r(t,e,n,o){if(""===o){for(var i=0;i<t.leafKVPs.length;i++)if(t.options.sameKey(t.leafKVPs[i].k,e))return void(t.leafKVPs[i]={k:e,v:n});t.leafKVPs.push({k:e,v:n})}else{var a,c=o.charAt(0);t.subTries.hasOwnProperty(c)?a=t.subTries[c]:(a=new u(t.options),a.id=s++,t.subTries[c]=a),r(a,e,n,o.substring(1))}}function o(t,e,n,r){var i=new u(t.options),a=!1;if(""===r)return i.leafKVPs=t.leafKVPs.map(function(r){return t.options.sameKey(r.k,e)?(a=!0,{k:e,v:n}):r}),a||i.leafKVPs.push({k:e,v:n}),i.subTries=t.subTries,i;var s=r.charAt(0);for(var c in t.subTries)t.subTries.hasOwnProperty(c)&&(c==s?(i.subTries[c]=o(t.subTries[c],e,n,r.substring(1)),a=!0):i.subTries[c]=t.subTries[c]);if(!a){var l=new u(t.options);l=o(l,e,n,r.substring(1)),i.subTries[s]=l}return i.leafKVPs=t.leafKVPs,i}function i(t,e,n){var r=new u(t.options);if(""===n)return r.leafKVPs=t.leafKVPs.filter(function(n){return!t.options.sameKey(n.k,e)}),r.subTries=t.subTries,r;var o=n.charAt(0);for(var a in t.subTries)t.subTries.hasOwnProperty(a)&&(r.subTries[a]=a==o?i(t.subTries[a],e,n.substring(1)):t.subTries[a]);return r.leafKVPs=t.leafKVPs,r}function u(t){this.leafKVPs=[],this.subTries={},this.options=t||{hash:c.hash,sameKey:c.sameKey}}var s=0,c={hash:function(t){return t.hashCode()},sameKey:function(t,e){function n(t){return"timezoneOffset"in t&&null!==t.timezoneOffset}try{return(t.equals(e)||N.itemIsNaN(t)&&N.itemIsNaN(e))&&n(t)==n(e)}catch(r){return a(r),!1}}};return u.prototype={leafKVPs:[],subTries:{},options:c,containsKey:function(t){return null!==n(this,t)},get:function(t){var e=n(this,t);return null===e?[]:e.v},inSituPut:function(t,e){r(this,t,e,this.options.hash(t))},put:function(t,e){return o(this,t,e,this.options.hash(t))},remove:function(t){return i(this,t,this.options.hash(t))},forAllPairs:function(t){this.leafKVPs.forEach(t);for(var e in this.subTries)this.subTries.hasOwnProperty(e)&&this.subTries[e].forAllPairs(t)},display:function(){function e(n,r){r>0&&a("Subtrie "+r),n.leafKVPs.forEach(function(e){a(t(e.k)+": "+t(e.v))});for(var o in n.subTries)n.subTries.hasOwnProperty(o)&&e(n.subTries[o],r+1)}a("HashTrie:"),e(this,0)},keys:function(){var t=[];return this.forAllPairs(function(e){t.push(e.k)}),t},conforms:function(t,e,n){var r=this;return A.ForArray(r.keys()).every(function(o){var i=r.get(o);return t(o)&&n(i.length)&&A.ForArray(i).every(e)})}},u}(),E=function(){"use strict";var t=T,r={ancestor:function(e){var n;switch(e.nodeType){case t.DOCUMENT_NODE:case t.DOCUMENT_FRAGMENT_NODE:return A.Empty;case t.ATTRIBUTE_NODE:return e.parent?A.Stepping(e.parent,function(t){return t.parentNode}):A.Empty;default:return n=e.parentNode,n?A.Stepping(n,function(t){return t.parentNode}):A.Empty}},ancestorOrSelf:function(t){return A.Join([A.Singleton(t),E.ancestor(t)])},attribute:function(e){if(e.nodeType==t.ELEMENT_NODE){var r,o,i=e.attributes,a=[];for(r=0;r<i.length;r++)o=i[r].name,("xmlns"!=o.substring(0,5)||5!=o.length&&":"!=o.charAt(5))&&a.push(new n(S.QName.fromParts(i[r].prefix,i[r].namespaceURI,i[r].localName),i[r].value,e));return A.ForArray(a)}return A.Empty},child:function(e){function n(t){return A.Stepping(t.firstChild,function(t){return t.nextSibling})}if(null===e)return A.Empty;switch(e.nodeType){case t.DOCUMENT_NODE:return n(e).filter(function(e){return!(e.nodeType==t.PROCESSING_INSTRUCTION_NODE&&"xml"==e.target||e.nodeType==t.TEXT_NODE)});case t.DOCUMENT_FRAGMENT_NODE:case t.ELEMENT_NODE:return n(e);default:return A.Empty}},descendant:function(t){return E.child(t).mapOneToMany(function(t){return E.descendantOrSelf(t)})},descendantOrSelf:function(t){return A.Join([A.Singleton(t),E.descendant(t)])},following:function(e){switch(e.nodeType){case t.DOCUMENT_NODE:case t.DOCUMENT_FRAGMENT_NODE:return A.Empty;case t.ATTRIBUTE_NODE:case t.NAMESPACE_NODE:var n=t.xdmParentNode(e);return null===n?A.Empty:A.Join([E.descendant(n),E.following(n)]);default:return E.ancestorOrSelf(e).mapOneToMany(function(t){return E.followingSibling(t).mapOneToMany(E.descendantOrSelf)})}},followingSibling:function(e){switch(e.nodeType){case t.DOCUMENT_NODE:case t.DOCUMENT_FRAGMENT_NODE:case t.ATTRIBUTE_NODE:case t.NAMESPACE_NODE:return A.Empty;default:return A.Stepping(e.nextSibling,function(t){return t.nextSibling})}},namespace:function(n){return n.nodeType==t.ELEMENT_NODE?A.ForArray(t.inScopeNamespaces(n).map(function(t){return new e(t.prefix,t.uri,n)})):A.Empty},parent:function(e){return A.Singleton(t.xdmParentNode(e))},preceding:function(t){return E.ancestorOrSelf(t).mapOneToMany(function(t){return E.precedingSibling(t).mapOneToMany(function(t){return A.ForArray(E.descendantOrSelf(t).expand().reverse())})})},precedingSibling:function(e){switch(e.nodeType){case t.DOCUMENT_NODE:case t.DOCUMENT_FRAGMENT_NODE:case t.ATTRIBUTE_NODE:case t.NAMESPACE_NODE:return A.Empty;default:return A.Stepping(e.previousSibling,function(t){return t.previousSibling})}},self:function(t){return A.Singleton(t)}};return r["ancestor-or-self"]=r.ancestorOrSelf,r["descendant-or-self"]=r.descendantOrSelf,r["following-sibling"]=r.followingSibling,r["preceding-sibling"]=r.precedingSibling,r}();r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r.prototype.code=null,r.prototype.xsltLineNr=null,r.prototype.xsltModule=null,r.prototype.compiledLineNr=null,r.prototype.isGlobal=!1,r.prototype.setExpr=function(t){this.xsltLineNr=T.getInheritedAttribute(t,"line"),this.xsltModule=T.getInheritedAttribute(t,"module"),this.compiledLineNr=t.lineNumber,null!==this.xsltLineNr&&(this.message+=" at "+this.xsltModule+"#"+this.xsltLineNr)},r.test=function(t){if(t)throw r.call(this,arguments[1],arguments[2],arguments[3])};var C=function(){"use strict";function n(){}function o(t,e){var n=gt.getChildElements(t);return A.Block(n,e)}function i(t){var e=t.split("|"),n=e[0],r=e[1],o=""===e[2]?"XPTY0004":e[2],i=e[3],a=["ancestor","ancestor-or-self","attribute","child","descendant","descendant-or-self","following","following-sibling","namespace","parent","preceding","preceding-sibling","self","preceding-or-ancestor"],u=function(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}},s=function(){switch(parseInt(n,10)){case 0:return u(+r+1)+" argument of "+(""===i?"anonymous function":i+"()");case 1:return u(+r+1)+" operand of '"+i+"'";case 9:return"operand of '-'";case 2:return"value in '"+i+"' expression";case 3:return"saxon:context-item"==i?"context item":"value of variable $"+i;case 4:var t=i.split("/");return"@"+t[1]+" attribute of "+("LRE"==t[0]?"a literal result element":t[0]);case 5:return"result of call to "+(""===i?"anonymous function":"function "+i);case 7:return"result of template "+i;case 6:return u(+r+1)+" sort key";case 8:return"value of parameter $"+i;case 11:return"value of the grouping key";case 12:return"result of evaluate()";case 13:return"the context item";case 14:return"the context item for the "+a[r]+" axis";case 15:return"the value of the "+i+" option";case 17:return"document-order sorter";default:return""}};return{required:s(),code:o}}function u(t,e,n,o,i){if(!n.match(/^[smijxq]*$/))throw r("Illegal flags for regular expression: "+n,"FORX0001");var a=_.prepareRegex(e,n+"g",t);if(!o&&a.test(""))throw r("Regular expression matches zero-length string","FORX0003");for(var u,s=[],c=0,l=0;null!==(u=a.exec(t));)if((u.index>c||u.index==c&&i)&&s.push({matching:!1,string:S.string.fromString(t.substring(c,u.index))}),s.push({matching:!0,groups:u,string:S.string.fromString(u[0])}),c=a.lastIndex,0===u[0].length&&a.lastIndex++,l++>1e3)throw r("looping???","SXJS0004");return t.length>c&&s.push({matching:!1,string:S.string.fromString(t.substring(c,t.length))}),s}function s(t){return t.replace(/[ \n\r\t]+/g," ").replace(/^[ ]|[ ]$/g,"")}function c(t){if(gt.isNode(t))return A.Singleton(l(t));if(ut(t))return A.Join(t.value.map(function(t){return A.ForArray(t)})).mapOneToMany(c);if(st(t))throw r("Cannot atomize a map","FOTY0013");return A.Singleton(t)}function l(t){var e=S.string.fromString,n=S.untypedAtomic.fromString;switch(t.nodeType){case gt.DOCUMENT_NODE:return n(t.documentElement.textContent);case gt.DOCUMENT_FRAGMENT_NODE:case gt.ELEMENT_NODE:case gt.TEXT_NODE:return n(t.textContent||"");case gt.ATTRIBUTE_NODE:return n(t.value);case gt.COMMENT_NODE:return e(t.textContent);case gt.PROCESSING_INSTRUCTION_NODE:return e(t.data);case gt.NAMESPACE_NODE:return e(t.uri);default:throw r("Unknown node type "+t.nodeType,"SXJS0003")}}function f(t){function e(t){throw r("Effective boolean value is not defined for "+t,"FORG0006")}function n(){return null===t.next()?!0:void e("an atomic sequence of length > 1")}var o=t.next();if(null===o)return!1;if(gt.isNode(o))return!0;if(S["boolean"].matches(o))return n()&&o.toBoolean();if(S.numeric.matches(o)){var i=o.toNumber();return n()&&!isNaN(i)&&0!==i}return S.string.matches(o)||S.untypedAtomic.matches(o)||S.anyURI.matches(o)?n()&&0!==o.toString().length:void e("type "+o.type)}function m(t){return"untypedAtomic"===t.type?S["double"].cast(t):t}function p(t,e){var n=M["i+i"],r=S.integer.fromNumber(1);return A.Stepping(t,function(t){var o=n(t,r);return o.compareTo(e)>0?null:o})}function h(t,e,n){var r=gt.getChildElements(t,"withParam"),o=[{},{}];for(var i in e.tunnelParams)e.tunnelParams.hasOwnProperty(i)&&(o[1][i]=e.tunnelParams[i]);var a=e.tempOutputState;e.tempOutputState="template parameter",r.forEach(function(t){var n=gt.getAttributeAsEQName(t,"name"),r=X(t,"t")?1:0;o[r][n]=P(t,e).expand()}),e.tempOutputState=a,n.localParams=o[0],n.tunnelParams=o[1]}function g(t,e){return e&&e.indexOf("l")>=0&&(t._saxonIsLocal=!0),t}function d(t,e,n){var o,i,a="compAtt"==t.tagName,u=_.trim(St(R(t,"name"),e).next().toString()),s=R(t,"namespace");if(null===s){if(a&&"xmlns"==u)throw r("Attribute must not be named xmlns","XTDE0855",t);i=$(t,u,!a),o=i.uri}else if(o=St(s,e).next().value,a)if(""===o&&u.includes(":"))u=u.replace(/^.*:/,""),i=S.QName.fromParts("",o,u);else if(u.includes(":")){var c=u.split(":");if(""==c[0]||""==c[1])throw r((a?"Attribute":"Element")+" name '"+u+"' is not a lexical QName",a?"XTDE0850":"XTDE0820",t);i=S.QName.fromParts(c[0],o,c[1])}else i=S.QName.fromParts("",o,u);if("http://www.w3.org/2000/xmlns/"==o)throw r("Disallowed namespace "+o,"XTDE0835",t);return a?A.Singleton(n(i)):A.Singleton(n(o,u))}function v(t,e,n){var r=P(t,e).next(),o=U(t,e).next();return null===r||null===o?null:n(r,o)}function y(t){if("xs:"==t.substring(0,3)){var e=S[t.substring(3)];if(!e)throw r("Unimplemented type "+t,"SXJS0002");return e}throw r("Unknown type "+t,"SXJS0003")}function x(t,e){if(null!==e.fixed.staticBaseURI)return e.fixed.staticBaseURI;for(var n=t;;){if(n.hasAttribute("baseUri"))return n.getAttribute("baseUri");if(n=gt.xdmParentNode(n),null===n||n.nodeType!=gt.ELEMENT_NODE)return null}}function b(t,e,n){var r=e.resultDocument.createDocumentFragment(),o=gt.obtainDocumentNumber(r);o._saxonBaseUri=x(t,e);var i=e.newContext(!1);return n&&(i.resultDocument=window.document),ot(o,St(t,i),i),o}function O(t,e){throw r("The "+t+" construct is not implemented in Saxon-JS","SXJS0002",e)}function D(t,e){throw r("The SEF is out of date, regenerate using Saxon-EE "+t+" or later","SXJS0002",e)}function P(t,e){var n=gt.getChildElements(t)[0];if(!n)throw r("Expr has no children","SXJS0004",t);return St(n,e)}function U(t,e){return St(gt.getChildElements(t)[1],e)}function R(t,e){var n,r=t.childNodes;for(n=0;n<r.length;n++){var o=r[n];if(o.nodeType==gt.ELEMENT_NODE&&o.getAttribute("role")==e)return o}return null}function X(t,e){return t.hasAttribute("flags")&&t.getAttribute("flags").indexOf(e)>=0}function J(t){var e={},n=gt.getInheritedAttribute(t,"ns");if(null!==n)for(var r=n.split(" "),o=0;o<r.length;o++){var i=r[o].split("=");"~"==i[1]?e[i[0]]=yt[i[0]]:e[i[0]]=i[1]}return e}function L(t,e){var n=J(t);return function(t){if(""===t&&!e)return"";var o=n[t];if(o)return o;if(""===t)return"";throw r("Undeclared prefix: "+t,"XTDE0290")}}function $(t,e,n){return S.QName.fromString(e,L(t,n))}function z(t){return"undefined"==typeof t?void 0:G(t,"module",20)+"#"+G(t,"line",10)}function G(t,e,n){if(null!==t&&n>0){var r=gt.getAttribute(t,e);return null!==r&&""!==r?r:G(t.parentNode,e,n-1)}return void 0}function q(t){throw a("*** Internal error: "+t),Error.dumpStack&&Error.dumpStack(),r("Internal error: "+t,"SXJS0004")}function Q(t,e,n){var o,i,a=t.getAttribute("bSlot");if(a?(a=parseInt(a),i=e.currentComponent.bindings[a],o=e.fixed.components[i]):(i=t.getAttribute("coId"),i?o=e.fixed.components[parseInt(i)]:q("No binding slot or component Id for component")),o||q("Target component not found"),"ABSENT"===o.visibility)throw r("Cannot invoke absent component "+o.actor.tagName+" "+o.actor.getAttribute("name"),"XTDE3052");return n&&o.actor.tagName!=n&&q("Expected "+n+", found "+o.actor.tagName),o}function K(t,e){for(var n=t.parentNode;"package"!=n.tagName;)n=n.parentNode;return e.fixed.packages[n.getAttribute("name")]}function V(t,e){var n=vt[t.tagName];n||q("Unknown expr: "+t.tagName);try{return n(t,e)}catch(o){throw o instanceof r?(e.currentError=o,null===o.compiledLineNr&&null===o.xsltLineNr&&(o.setExpr(t),null!==o.xsltLineNr),o):o}}function j(t){var e=vt[t.tagName];return e||q("Unknown expr: "+t.tagName),function(n){try{return e(t,n)}catch(o){throw o instanceof r&&(n.currentError=o,null===o.compiledLineNr&&o.setExpr(t)),o}}}function Y(t){return j(gt.getChildElements(t)[1])}function H(t,e){return null===t?A.Empty:St(t,e)}function W(t){if(1>t||t>55295&&57344>t||t>65533&&65536>t||t>1114111)throw r("Invalid XML character 0x"+t.toString(16),"FOCH0001")}function Z(t){for(var e=0;e<t.length;e++){var n=t.charCodeAt(e);if(n>=55296&&56319>=n)return!0}return!1}function tt(t){var e="";return t.forEach(function(t){return W(t),e+=65536>t?String.fromCharCode(t):String.fromCharCode((t-65536>>10)+55296)+String.fromCharCode((t-65536&1023)+56320)}),e}function et(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);e.push(r>=55296&&56319>=r?1024*(r-55296)+(t.charCodeAt(++n)-56320)+65536:r)}return e}function nt(t,e){function n(t,e){return S.decimal.matches(t)?"decimal"==e||"float"==e||"double"==e:S["float"].matches(t)?"float"==e||"double"==e:!1}if(S[e].matches(t))return t;if(n(t,e))return S[e].cast(t);throw r("Incompatible operands: "+t.type+" and "+e,"XPTY0004")}function rt(t){var e="";return t.forEachItem(function(t){""!==e&&(e+=" "),e+=t.toString()}),e}function ot(n,o,i){function a(t,o){function i(t){return t instanceof e?"a namespace":"an attribute"}if(o)throw r("Cannot create "+i(t)+" node after creating children","XTDE0410");if(n.nodeType==gt.DOCUMENT_FRAGMENT_NODE||n.nodeType==gt.DOCUMENT_NODE)throw r("Cannot add "+i(t)+" to a document node","XTDE0410")}function u(t,e){var n=e._saxonIsLocal?e._saxonIsLocal:!1,o=!1;if(ut(e))e.value.forEach(function(e){e.forEach(function(e){u(t,e)})});else{if(st(e))throw r("A map can't be a child of an XML node","XPTY0004");if(gt.isNode(e)?(c=!1,o=e.nodeType==gt.TEXT_NODE):(e=i.resultDocument.createTextNode((c?" ":"")+e.toString()),c=!0),t.nodeType==gt.ELEMENT_NODE||t.nodeType==gt.DOCUMENT_FRAGMENT_NODE)if(gt.isNSNode(e))if(SaxonJS.getPlatform().inBrowser&&t instanceof HTMLElement)t.appendChild(t.ownerDocument.importNode(e,!0));else{if(a(e,s),e.prefix==t.prefix&&e.uri!=t.namespaceURI)throw r("Saxon-JS restriction: namespace nodes in content clash with the element prefix","SXJS0002");if(""===e.prefix){if(""===t.namespaceURI)throw r("Cannot add a default namespace to a no-namespace element","XTDE0440");if(t.hasAttributeNS("","xmlns")){if(t.getAttributeNS("","xmlns")!=e.uri)throw r("Cannot have two different default namespaces","XTDE0430")}else SaxonJS.getPlatform().inBrowser&&t instanceof HTMLElement||t.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns",e.uri)}else{var f="http://www.w3.org/2000/xmlns/",m="xmlns:"+e.prefix,p=e.uri;if("~"==e.uri&&null!=yt[e.prefix]&&(p=yt[e.prefix]),t.hasAttributeNS(f,e.prefix)&&t.getAttributeNS(f,e.prefix)!=p)throw r("Cannot have two namespaces with the same prefix '"+e.prefix+"'","XTDE0430");t.setAttributeNS(f,m,p)}}else if(e.nodeType==gt.ATTRIBUTE_NODE){if(a(e,s),""!==e.namespaceURI){var h=e.name.split(":");if(2!=h.length||t.lookupNamespaceURI(h[0])!=e.namespaceURI)if(2==h.length&&null===t.lookupNamespaceURI(h[0]))t.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:"+h[0],e.namespaceURI);else for(var g=2==h.length?h[0]:"ns";;){if(null===t.lookupNamespaceURI(g)){t.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:"+g,e.namespaceURI),e.name=g+":"+h[h.length-1];break}g+="_1"}}var d=""===e.namespaceURI?null:e.namespaceURI;t.setAttributeNS(d,e.name,e.value)}else if(e.nodeType==gt.TEXT_NODE){if(e.nodeValue&&""!=e.nodeValue){var v=t.lastChild;v&&v.nodeType==gt.TEXT_NODE?v.nodeValue=v.nodeValue+e.nodeValue:t.appendChild(gt.copyItem(e,i,""))}l=o}else if(e.nodeType==gt.DOCUMENT_NODE||e.nodeType==gt.DOCUMENT_FRAGMENT_NODE)E.child(e).forEachItem(function(e){u(t,e)});else{if(s=!0,!(SaxonJS.getPlatform().inBrowser&&i.resultDocument==window.document||e.nodeType!=gt.ELEMENT_NODE||SaxonJS.getPlatform().inBrowser&&e instanceof HTMLElement)){var y=e.prefix||"",S=e.lookupNamespaceURI(y)||"",N=e.namespaceURI||"";S!==N&&gt.declareNS(e,y,N),!e.lookupNamespaceURI(null)&&t.lookupNamespaceURI(null)&&gt.declareNS(e,"","")}if(!n||SaxonJS.getPlatform().inBrowser&&t instanceof HTMLElement!=e instanceof HTMLElement){var x=gt.copyItem(e,i,"c");e=x}t.appendChild(e),e._saxonIsLocal=!1}else{if(t.nodeType!=gt.DOCUMENT_NODE)throw r("Unknown parent node type "+t.nodeType,"SXJS0003");null!==e&&(t.documentElement=e)}}}i||q("No context in makeComplexContent for "+t(n));var s=!1,c=!1,l=!1;o.forEachItem(function(t){u(n,t)})}function it(t,e){function n(e){return"Context item for template "+t.getAttribute("name")+" must be "+e}if(e.noCurrentFocus()&&-1==t.getAttribute("flags").indexOf("o"))throw r(n("supplied"),"XTTE3090",t);e.noCurrentFocus()||-1!=t.getAttribute("flags").indexOf("s")||(e.focus={});var o=t.getAttribute("jsTest");if(o&&!e.noCurrentFocus()&&!new Function("item",o)(e.getCurrentFocus()))throw r(n("instance of "+t.getAttribute("cxt")),"XTTE0590",t)}function at(t){this.value=t}function ut(t){return t instanceof at}function st(t){return t instanceof w||t instanceof lt}function ct(t,e,n,o){function i(t){return gt.isNode(t)||S.untypedAtomic.matches(t)||S.string.matches(t)||S["boolean"].matches(t)||S["double"].matches(t)}function a(t,e){return null===t||i(t)?t:ft(t,e)}if(void 0===n)return t;if(Array.isArray(t)){if(!e(t.length))throw r("Supplied value for parameter "+o+" has wrong cardinality","XTTE0590");return t.map(function(t){return a(n(t),!0)})}return a(n(t))}function lt(t){this.value=t}function ft(t,e){if(S.anyAtomicType.matches(t))return t;switch(typeof t){case"undefined":return[];case"string":return S.string.fromString(t);case"number":return S["double"].fromNumber(t);case"boolean":return S["boolean"].fromBoolean(t);case"function":return new lt(t);case"object":if(T.isNode(t))return t;if(t instanceof Date)return S.dateTime.fromString(t.toISOString());if(Array.isArray(t)){var n=[];return e?(t.forEach(function(t){var e=ft(t,!0),r=Array.isArray(e)?e:[e];n.push(r)}),new C.XdmArray(n)):(t.forEach(function(t){n.push(ft(t,!0))}),n)}return null===t?[]:new lt(t);default:return t}}function mt(e){if(S.string.matches(e)||S.anyURI.matches(e)||S.duration.matches(e)||S.hexBinary.matches(e)||S.base64Binary.matches(e)||S.untypedAtomic.matches(e))return e.toString();if(S.numeric.matches(e))return e.toNumber();if(S["boolean"].matches(e))return e.toBoolean();if(S.dateTime.matches(e)||S.date.matches(e)||S.dateTimeStamp.matches(e))return e.toString();if(S.time.matches(e)||S.gYearMonth.matches(e)||S.gYear.matches(e)||S.gMonthDay.matches(e)||S.gMonth.matches(e)||S.gDay.matches(e))return e.toString();if(S.QName.matches(e))return e.toEQName();var n;if(gt.isNode(e))return e;if(e instanceof C.XdmArray)return n=[],0===e.value.length||e.value.forEach(function(t){n.push(mt(t))}),n;if(Array.isArray(e))return n=[],0===e.length?null:1==e.length?mt(e[0]):(e.forEach(function(t){n.push(mt(t))}),n);if(e instanceof w){var o={};return e.forAllPairs(function(t){o[t.k.toString()]=mt(t.v)}),o}if(e instanceof lt)return e.value;throw r("convertToJS() not implemented for "+t(e)+", "+typeof e+", "+e.constructor.name,"SXJS0004")}function pt(t){return t.mapOneToMany(function(t){return ut(t)?A.Join(t.value.map(function(t){return pt(A.ForArray(t))})):A.Singleton(t)})}function ht(e,n){function r(e){if(ut(e)){var n="[";return e.value.forEach(function(t){"["!=n&&(n+=","),n+=o(t)}),n+"]"}if(st(e)){var i="{";return e.forAllPairs(function(t){"{"!=i&&(i+=",\n"),i+=r(t.k)+":",i+=o(t.v)}),i+"}"}return gt.isNode(e)?gt.xmlToString(e,a):S.string.matches(e)||S.untypedAtomic.matches(e)?'"'+e.toString().replace(/""/g,'"').replace(/''/g,"'")+'"':S.integer.matches(e)||S.numeric.matches(e)||S["boolean"].matches(e)?e.toString():e instanceof A.Singleton?r(e.next()):t(e)}function o(t){if(void 0===t)return"(undefined)";if(1==t.length)return r(t[0]);var e="(";return t.forEach(function(t){"("!=e&&(e+=","),e+=r(t)}),e+")"}var i={},a={"saxon:line-length":80,"saxon:indent-spaces":3,indent:"  "};n&&(i=n instanceof A.AnyIterator?SaxonJS.U.convertToJS(n.next()):n);for(var u in i)a[u]=i[u];return o(e.expand())}var gt=T,dt=function(){},vt={among:function(t,e){var n=P(t,e).next(),r=U(t,e);return r.filter(function(t){return t===n})},analyzeString:function(t,e){var n=St(R(t,"select"),e).next();if(null===n)return A.Empty;n=n.toString();var r=St(R(t,"regex"),e).next().toString(),o=St(R(t,"flags"),e).next().toString(),i=R(t,"matching"),a=R(t,"nonMatching"),s=u(n,r,o,!0,!1),c=e.newContext(!1),l=s.map(function(t){return t.string});return c.focus=A.Tracker(A.ForArray(l)),c.focus.mapOneToMany(function(t){var e=s[c.focus.position-1];return e.matching?(c.focus.regexGroups=e.groups,i?St(i,c):A.Empty):(c.focus.regexGroups=[],a?St(a,c):A.Empty)})},and:function(t,e){return A.oneBoolean(f(P(t,e))&&f(U(t,e)))},applyImports:function(t,e){var n=e.currentMode.mode;if(!n)throw r("applyImports: no current mode","XTDE0560",t);if(e.noCurrentFocus())throw r("applyImports: no context item","XTDE0560",t);var o=e.newContext(!0);return o.currentComponent=e.currentMode,h(t,e,o),o.focus=A.Solo(e.getCurrentFocus()),o.focus.regexGroups=e.focus.regexGroups,n.applyImports(o)},applyT:function(t,e){var n,o=e.newContext(!0);if(X(t,"c")){var i=e.currentComponent.actor.tagName,a="function"===i||"globalVariable"===i||"globalParam"===i;n=a?e.fixed.modes[""]:e.currentMode.mode}else{var u=Q(t,e,"mode");if(n=u.mode,n.mustBeTyped)throw r("Mode "+T.getAttribute(n._expr,"name")+" only handles typed nodes","XTTE3100",t);o.currentComponent=u}return h(t,e,o),o.focus=A.Tracker(P(t,e)),o.focus.regexGroups=e.focus?e.focus.regexGroups:null,n.applyTemplates(o)},arith:function(t,e){var n=M[t.getAttribute("calc")];return n||O("arithmetic ("+t.getAttribute("calc")+")",t),A.Singleton(v(t,e,n))},arith10:function(t,e){function n(t){var e=t.next();return null===e?S["double"].fromNumber(NaN):S["double"].cast(e)}var r=M[t.getAttribute("calc")];return A.Singleton(r(n(P(t,e)),n(U(t,e))))},array:function(t,e){var n=gt.getChildElements(t).map(function(t){return St(t,e).expand()});return A.Singleton(new at(n))},arrayBlock:function(t,e){var n=gt.getChildElements(t).map(function(t){return St(t,e).expand()});return A.Singleton(new at(n))},atomic:function(t){var e=t.getAttribute("val"),n=t.getAttribute("type").substring(3);return S[n]||q("Unknown type: "+n,t),A.Singleton(S[n].fromString(e))},atomSing:function(t,e){var n=P(t,e).mapOneToMany(c);if(!t.hasAttribute("card")&&(n=A.LookAhead(n),null===n.peek())){var o=i(t.getAttribute("diag"));throw r("The "+o.required+" is empty",o.code,t)}return n},att:function(t,e){var n=P(t,e),o=rt(n),i=gt.getAttributeAsQName(t,"name");if(null===i)throw r("Invalid attribute name "+t.getAttribute("name"),"XTDE0850",t);var a=e.createAttributeFromQName(i);a.value=o;var u=t.hasAttribute("flags")?t.getAttribute("flags"):"";return A.Singleton(g(a,u))},attVal:function(t,e){var n=gt.getAttributeAsQName(t,"name");if(e.noCurrentFocus())throw r("attVal: no context item","XPDY0002",t);var o=e.getCurrentFocus();if(!gt.isNode(o))throw r("Context item for 'attVal' must be a node","XPTY0020",t);if(o.nodeType!=gt.ELEMENT_NODE)return A.Empty;var i;return i=""===n.uri?o.hasAttribute(n.local)?o.getAttribute(n.local):null:n.uri===yt.xml?o.hasAttribute("xml:"+n.local)?o.getAttribute("xml:"+n.local):null:o.hasAttributeNS(n.uri,n.local)?o.getAttributeNS(n.uri,n.local):null,null===i?A.Empty:A.Singleton(S.untypedAtomic.fromString(i))},axis:function(t,e){var n=new Function("item",t.getAttribute("jsTest")),o=t.getAttribute("name");if(e.noCurrentFocus())throw r("Context item is absent for "+o+" axis","XPDY0002",t);var i=e.getCurrentFocus();if(!gt.isNode(i))throw r("Context item for "+o+" axis is not a node","XPTY0020",t);return E[o](i).filter(n)},"break":function(t,e){var r=new n;return null!==t.firstChild&&(r.content=P(t,e).expand()),A.Join([A.Empty,A.Singleton(r)])},callT:function(t,e){var n=Q(t,e,"template"),r=e.newContext(!0);return r.currentMergeGroup=null,r.currentComponent=n,it(n.actor,r),h(t,e,r),P(n.actor,r)},cast:function(t,e){var n=P(t,e),o=n.next(),i=t.getAttribute("as");if(null===o){if("?"==i.slice(-1)||"1"==t.getAttribute("emptiable"))return A.Empty;throw r("Empty sequence casting to "+i,"XPTY0004",t)}if(null!==n.next())throw r("Multiple sequence casting to "+i,"XPTY0004",t);try{i=i.replace(/(\?|\*)$/,"");var a=y(i),u="QName"==a.name?L(t,!0):null;return A.Singleton(a.cast(o,u))}catch(s){if(null!==s.code)throw s;throw r("Failed to cast to type "+i,"XPTY0004",t)}},castable:function(t,e){var n,r=P(t,e).mapOneToMany(c).expand();if(0===r.length)n="1"==t.getAttribute("emptiable");else if(r.length>1)n=!1;else try{
var o=y(t.getAttribute("as")),i="QName"==o.name?L(t,!0):null;o.cast(r[0],i),n=!0}catch(a){n=!1}return A.oneBoolean(n)},cfn:function(t,e){var n,r=t.getAttribute("name");return"_format-number_1"==r?(n=[P(t,e),A.oneString(t.getAttribute("pic"))],t.hasAttribute("format")&&n.push(A.oneString(t.getAttribute("format"))),F["format-number"](n,e,t)):"_translate_1"==r?(n=[P(t,e),A.oneString(t.getAttribute("a1")),A.oneString(t.getAttribute("a2"))],F.translate(n,e)):void q("Unimplemented: cfn "+r,t)},check:function(e,n){function o(t){var n=i(e.getAttribute("diag"));throw r("Required cardinality of "+n.required+" is "+u[a]+"; supplied value "+t,n.code,e)}var a=e.getAttribute("card"),u={"*":"zero or more","+":"one or more","?":"zero or one","":"zero",1:"exactly one"},s=P(e,n);if("*"==a)return s;var c=A.LookAhead(s),l=c.peek();if(null===l){if("?"==a||""==a)return A.Empty;o("is empty")}else""==a&&o("is not empty (first item "+t(l)+")");if("+"==a)return c;c.next();var f=c.next();if(null!==f){var m=c.count()+2;o("contains "+m+" items ("+t(l)+", "+t(f)+(m>2?",... )":")"))}return A.Singleton(l)},choose:function(t,e){var n,r=gt.getChildElements(t);for(n=0;n<r.length;n+=2)if(f(St(r[n],e)))return St(r[n+1],e);return A.Empty},comment:function(t,e){var n=P(t,e),r=e.resultDocument.createComment(rt(n).replace(/--/g,"- -").replace(/-$/,"- ")),o=t.hasAttribute("flags")?t.getAttribute("flags"):"";return A.Singleton(g(r,o))},compareToInt:function(t,e){var n=t.getAttribute("op"),r=P(t,e).next();if(null===r)return A.Empty;if(N.itemIsNaN(r))return A.oneBoolean("ne"==n);var o=S.integer.fromString(t.getAttribute("val"));return A.oneBoolean(N.testComparison(n,r.compareTo(o)))},compAtt:function(t,e){var n=t.hasAttribute("flags")?t.getAttribute("flags"):"";return d(t,e,function(r){var o=e.createAttributeFromQName(r);return o=g(o,n),o.value=rt(St(R(t,"select"),e)),o})},compElem:function(t,e){var n=t.hasAttribute("flags")?t.getAttribute("flags"):"";return d(t,e,function(r,o){var i=o.split(":");""===r&&2==i.length&&(o=i[1]);var a=e.createElement(r,o);return""!==r&&gt.declareNS(a,1==i.length?"":i[0],r),ot(a,St(R(t,"content"),e),e),g(a,n)})},condCont:function(t,e){var n=P(t,e);return n.filter(function(t){if(!gt.isNode(t))return st(t)?t.keys().length>0:""!=S.string.cast(t);switch(t.nodeType){case gt.DOCUMENT_NODE:case gt.DOCUMENT_FRAGMENT_NODE:case gt.ELEMENT_NODE:return t.hasChildNodes();default:return""!=l(t)}})},condSeq:function(t,e){function n(t){if(t instanceof Node){if(t.nodeType==gt.DOCUMENT_NODE||t.nodeType==gt.DOCUMENT_FRAGMENT_NODE)return!t.hasChildNodes();if(t.nodeType==gt.TEXT_NODE)return""==t.nodeValue}else{if(t.isAtomic)return""==S.string.cast(t);if(ut(t))return!pt(A.Singleton(t)).some(function(t){!n(t)})}return!1}var r=[],o=[],i=!0,a=gt.getChildElements(t);a.map(function(t){if("onEmpty"==t.tagName)i&&(r=St(t,e).expand());else if("onNonEmpty"==t.tagName){var a=r.length;o.unshift(function(){r.splice.apply(r,[a,0].concat(St(t,e).expand()))})}else St(t,e).forEachItem(function(t){n(t)||(i=!1),r.push(t)})});return i||o.forEach(function(t){t()}),A.ForArray(r)},conditionalSort:function(t,e){return f(P(t,e))?U(t,e):P(gt.getChildElements(t)[1],e)},convert:function(t,e){var n=y(t.getAttribute("to"));return P(t,e).mapOneToOne(X(t,"p")?function(t){return nt(t,n.name)}:n.cast)},copy:function(t,e){if(e.noCurrentFocus())throw r("copy: no context item","XTTE0945",t);var n=e.getCurrentFocus(),o=t.getAttribute("flags");return gt.shallowCopy(n,e,o,function(e){return P(t,e)})},copyOf:function(t,e){var n=t.getAttribute("flags");return P(t,e).mapOneToOne(function(t){return gt.copyItem(t,e,n)})},currentGroup:function(t,e){if(e&&e.currentGroup)return A.ForArray(e.currentGroup);throw r("There is no current group","XTDE1061",t)},currentGroupingKey:function(t,e){if(e&&e.currentGroupingKey)return A.ForArray(e.currentGroupingKey);throw r("There is no current grouping key","XTDE1071",t)},cvUntyped:function(t,e){var n=P(t,e),r=t.getAttribute("to"),o=y(r).cast,i="xs:string"==r;return n.mapOneToOne(function(t){return S.untypedAtomic.matches(t)||i&&S.anyURI.matches(t)?o(t):t})},data:function(t,e){return P(t,e).mapOneToMany(c)},dbl:function(t){var e=t.getAttribute("val");return A.Singleton(S["double"].fromString(e))},dec:function(t){var e=t.getAttribute("val");return A.oneDecimal(Big(e))},doc:function(t,e){var n=b(gt.getChildElements(t)[0],e),r=t.hasAttribute("flags")?t.getAttribute("flags"):"";return A.Singleton(g(n,r))},docOrder:function(t,e){return gt.inDocumentOrder(P(t,e))},dot:function(t,e){if(e.noCurrentFocus())throw r("dot: no context item","XPDY0002",t);return A.Singleton(e.getCurrentFocus())},elem:function(t,e){var n=!1,o=t.getAttribute("name"),i=o.split(":"),a=null;if(t.hasAttribute("nsuri")&&(a=t.getAttribute("nsuri"),n=!0),2==i.length&&null===a&&(a=t.lookupNamespaceURI(i[0]),null===a&&(a=L(t,!0)(i[0])),n=!0),null===a&&(a=""),"http://www.w3.org/2000/xmlns/"==a)throw r("Disallowed namespace "+a,"XTDE0835",t);var u;try{u=e.createElement(a,o)}catch(s){throw r("Element name '"+o+"' is not a lexical QName","XTDE0820",t)}if(t.hasAttribute("namespaces")){var c,l=t.getAttribute("namespaces").toString().split(" ");for(c=0;c<l.length;c++){var f=l[c].split("="),m=f[0];"#"==m&&(m="");var p=2==f.length?f[1]:L(t,!0)(m);gt.declareNS(u,m,p)}}n&&gt.declareNS(u,2==i.length?i[0]:"",a),ot(u,P(t,e),e);var h=t.hasAttribute("flags")?t.getAttribute("flags"):"";return A.Singleton(g(u,h))},empty:function(){return A.Empty},emptyTextNodeRemover:function(t,e){return P(t,e).filter(function(t){return!(t instanceof Node&&t.nodeType==gt.TEXT_NODE&&""===t.textContent)})},error:function(t){throw r(t.getAttribute("message"),t.getAttribute("code"),t)},evaluate:function(t,e){var n={language:"XSLT",contextType:"item()"},o=St(R(t,"xpath"),e).next().toString(),i=St(R(t,"cxt"),e),a=new w,u=gt.getChildElements(t,"withParam");u.forEach(function(t){a.inSituPut(S.string.fromString(t.getAttribute("name")),P(t,e).expand())});var s=St(R(t,"wp"),e);if(s){var c=s.next();c.forAllPairs(function(e){if(!S.QName.matches(e.k))throw r("Parameter names in xsl:evaluate/@with-params map must be QNames:"+e.k.toString(),"XTTE3165",t);a.inSituPut(e.k,e.v)})}a=A.Singleton(a);var l={},f=R(t,"sa");if(f){var m=St(f,e).next().toString();if("true"==m||"yes"==m||"1"==m)throw r("Saxon-JS does not support schema-aware evaluation","XTDE1665",t)}var p=t.getAttribute("as");p&&(n.requiredType=p.toString());var h=t.getAttribute("dxns");h&&(n.xpathDefaultNamespace=h.toString());var g,d=R(t,"nsCxt");if(d){var v=St(d,e).next(),y=v.attributes;for(g=0;g<y.length;++g){var N=y[g];"xmlns"==N.prefix?l[N.localName]=N.value:"xmlns"==N.name&&(l[""]=N.value,n.xpathDefaultNamespace=N.value)}}else l=J(t);n.params=a,n.namespaces=l,n.staticTyping=!0;var x=R(t,"baseUri");x&&(n.staticBaseURI=St(x,e).next().toString());var b=SaxonJS.XPath.evaluateXDM(o,i,a,e,l,n);return b},every:function(t,e){var n=parseInt(t.getAttribute("slot"),10),r=P(t,e),o=Y(t);return A.oneBoolean(!r.some(function(t){return e.localVars[n]=[t],!f(o(e))}))},except:function(t,e){var n=P(t,e),r=U(t,e);return A.Difference(n,r,gt.compareDocumentOrder)},"false":function(){return A.oneBoolean(!1)},filter:function(t,e){var n=P(t,e),r=Y(t);if(X(t,"i")){var o=r(e).expand();if(1==o.length&&S.numeric.matches(o[0])){var i=o[0].toNumber();if(n instanceof A.ForArray)return A.Singleton(n.expand()[i-1]);var a=A.Tracker(n);return a.filter(function(){return a.position==i})}return f(A.ForArray(o))?n:A.Empty}var u=e.newContext(!1);u.focus=A.Tracker(n);var s;return s=X(t,"p")?function(){var t=r(u).expand();return 1==t.length&&S.numeric.matches(t[0])?u.focus.position==t[0].toNumber():f(A.ForArray(t))}:function(){return f(r(u))},u.focus.filter(s)},first:function(t,e){return A.Singleton(P(t,e).next())},fnRef:function(t){throw r("Saxon-JS does not support higher-order functions","XTSE3540",t)},follows:function(t,e){return A.Singleton(v(t,e,function(t,e){return S["boolean"].fromBoolean(gt.compareDocumentOrder(t,e)>0)}))},"for":function(t,e){var n=parseInt(t.getAttribute("slot"),10),r=Y(t);return P(t,e).mapOneToMany(function(t){return e.localVars[n]=[t],r(e)})},forEach:function(t,e){var n=e.newContext(!1);n.focus=A.Tracker(P(t,e)),n.currentTemplate=null;var r=Y(t),o=function(){return r(n)};return n.focus.mapOneToMany(o)},forEachGroup:function(t,e){return N.grouping(t,e)},fork:o,fn:function(t,e){var n=F[t.getAttribute("name")];n||O(t.getAttribute("name")+"()",t);var r=gt.getChildElements(t).map(function(t){return St(t,e)});return n(r,e,t)},functionCall:function(t){O(t.getAttribute("name")+"()",t)},gc:N.generalComparison,gc10:function(t,e){function n(t){return 1==t.length&&S["boolean"].matches(t[0])}function r(t){return[S["boolean"].fromBoolean(f(A.ForArray(t)))]}function o(t){return A.ForArray(t).mapOneToMany(c).expand()}function i(t){return A.ForArray(t).mapOneToOne(S.numeric.numberFn).expand()}var a=P(t,e).expand(),u=U(t,e).expand();n(a)?u=r(u):n(u)?a=r(a):(a=o(a),u=o(u));var s=N.allocateCodedComparer(t.getAttribute("comp"),e),l=t.getAttribute("op");return"="!==l&&"!="!==l?(a=i(a),u=i(u)):s=N.gc10comparer(s),N.gc(A.ForArray(a),u,l,s)},gcEE:N.generalComparison,gVarRef:function(t,e){var n=Q(t,e),o=n.actor,i=o.getAttribute("name");if(n.value===dt){var a=r("Circularity in global variable "+i,"XTDE0640");throw a.isGlobal=!0,a}if(null===n.value||void 0===n.value){if("globalParam"==o.tagName){var u=e.fixed.options.stylesheetParams[i];if(void 0===u&&/^Q\{\}/.test(i)&&(u=e.fixed.options.stylesheetParams[S.QName.fromEQName(i).local]),void 0!==u){null===u&&(u=[]);var s=new Function("val",o.getAttribute("jsAcceptor")),c=new Function("n",o.getAttribute("jsCardCheck")+" return c(n);"),l=ct(u,c,s,i);n.value=Array.isArray(l)?l:[l]}else{if(X(o,"r"))throw r("Parameter "+i+" is required","XTDE0050",o);if(X(o,"i"))throw r("Parameter "+i+" cannot be empty","XTDE0700",o);0===gt.getChildElements(o).length&&(n.value=[])}}if(null===n.value||void 0===n.value){var f=e.newContext(!0);f.tempOutputState="variable",f.currentMode={},f.currentTemplate=null,f.currentComponent=n,f.focus=A.Solo(e.fixed.globalContextItem);try{n.value=dt,n.value=P(o,f).expand()}catch(m){throw m instanceof r&&S.QName.fromEQName(i).uri!=yt.saxon+"generated-variable"&&(m.isGlobal=!0),m}}}return A.ForArray(n.value)},homCheck:function(t,e){var n=new A.LookAhead(P(t,e)),o=n.peek();if(null===o)return A.Empty;var i=gt.isNode(o),a=n.filter(function(e){if(gt.isNode(e)!=i)throw r("Cannot mix nodes and atomic values in the result of a path expression","XPTY0018",t);return!0});return i?gt.inDocumentOrder(a):a},ifCall:function(t,e){var n,o,i,a,u,s=gt.getAttributeAsQName(t,"name",!1);if("schedule-action"==s.local){var c=2==gt.getChildElements(t).length,l=4==gt.getChildElements(t).length,f=gt.getChildElements(t).length>4;if(f)throw r("Only attributes @wait, @document and @http-request are available on ixsl:schedule-action in this version of Saxon-JS","SXJS0002",t);n=P(t,e).next().toNumber(),a=c?null:U(t,e).next(),u=l?St(gt.getChildElements(t)[3],e).next():null,o=e.newContext(!0),o.clearGrouping();var m=gt.getChildElements(t)[c?1:2],p=Q(m,e,"template"),g=p.actor;if(null===u&&(e.noCurrentFocus()||(o.focus=new A.Tracker(new A.Singleton(e.getCurrentFocus())),o.focus.next()),o.currentMergeGroup=null,o.currentComponent=p,it(p.actor,o),h(m,e,o)),i=function(){P(g,o).expand()},null!==u){var d=function(t){o.focus=new A.Tracker(new A.Singleton(ft(t))),o.focus.next(),o.currentMergeGroup=null,o.currentComponent=p,it(p.actor,o),h(m,e,o),i()};SaxonJS.getPlatform().makeHttpRequest(mt(u),d)}else if(null!==a){var v=a.toString().split(" "),y=v.map(function(n){return SaxonJS.getPlatform().resolveUri(n,C.staticBaseUri(t,e))});SaxonJS.getPlatform().addMultipleXml(y,e.fixed.documentPool,i)}else 0!==n&&setTimeout(i,n);return A.Empty}var S=gt.getChildElements(t).map(function(t,n){return St(t,e)});return I(s.uri,s.local,S,e,t)},indexedFilter:function(t,e){var n=e.newContext(!1);n.focus=A.Tracker(P(t,e));var r=Y(t),o=function(){return f(r(n))};return n.focus.filter(o)},indexedLookup:function(t,e){return N.generalComparison(t,e,"=")},inlineFn:function(t){O("inline function",t)},instance:function(t,e){var n={"*":{min:0,max:1/0},"+":{min:1,max:1/0},"?":{min:0,max:1},"":{min:0,max:0},1:{min:1,max:1}},r=P(t,e),o=t.getAttribute("of");if("empty-sequence()"==o)return A.oneBoolean(null===r.next());var i=o.charAt(o.length-1),a="*+?".indexOf(i)>=0,u=n[a?i:"1"];a&&(o=o.substring(0,o.length-1));for(var s,c=new Function("item",t.getAttribute("jsTest")),l=0;null!==(s=r.next());)if(++l>u.max||!c(s))return A.oneBoolean(!1);return A.oneBoolean(l>=u.min)},"int":function(t){var e=t.getAttribute("val");return A.Singleton(S.integer.fromString(e))},intersect:function(t,e){var n=P(t,e),r=U(t,e);return A.Intersect(n,r,gt.compareDocumentOrder)},intRangeTest:function(t,e){var n=P(t,e),r=gt.getChildElements(t),o=St(r[1],e).next(),i=St(r[2],e).next();if(!o||!i)return A.oneBoolean(!1);var a=o.toNumber(),u=i.toNumber(),s=n.some(function(t){var e=t.value;return e>=a&&u>=e});return A.oneBoolean(s)},is:function(t,e){return A.Singleton(v(t,e,function(t,e){return S["boolean"].fromBoolean(gt.isSameNode(t,e))}))},isLast:function(t,e){return A.oneBoolean(e.focus.position==e.focus.last()==("1"==t.getAttribute("test")))},iterate:function(t,e){var r=gt.getChildElements(gt.getChildElements(t)[1]);r.forEach(function(t){St(t,e)});var o=e.newContext(!1);o.focus=A.Tracker(P(t,e)),o.currentTemplate=null;for(var i,a=R(t,"action"),u=R(t,"on-completion"),s=[],c=!1;null!==(i=o.focus.next());){var l=o.newContext(!1);l.focus.current=i;var f=C.evaluate(a,l);if(Array.prototype.push.apply(s,f.expand()),s[s.length-1]instanceof n){var m=s.pop();Array.prototype.push.apply(s,m.content),c=!0;break}o.localVars=l.localVars}return c||null===u||Array.prototype.push.apply(s,C.evaluate(u,o).expand()),A.ForArray(s)},lastOf:function(t,e){var n=A.LookAhead(P(t,e));return n.filter(function(){return null===n.peek()})},let:function(t,e){var n=e.tempOutputState;e.tempOutputState="variable";var r=P(t,e).expand();e.tempOutputState=n;var o=parseInt(t.getAttribute("slot"),10);return e.localVars[o]=r,U(t,e)},literal:o,map:function(t,e){var n=new w,r=null;return gt.getChildElements(t).forEach(function(t){null===r?r=St(t,e).next():(n.inSituPut(r,St(t,e).expand()),r=null)}),A.Singleton(n)},merge:function(t,e){return B.merge(t,e)},mergeAdj:function(t,e){function n(t){return t instanceof Node&&t.nodeType==gt.TEXT_NODE}for(var r,o=[],i=P(t,e),a=!1;null!==(r=i.next());){var u=n(r);u&&""===r.nodeValue||(a&&u?o.push(e.resultDocument.createTextNode(o.pop().nodeValue+r.nodeValue)):(a=u,o.push(r)))}return A.ForArray(o)},message:function(t,e){var n="",o=e.tempOutputState;e.tempOutputState="variable",P(t,e).mapOneToMany(c).forEachItem(function(t){n+=" "+t.toString()});var i=St(R(t,"terminate"),e).next(),a=St(R(t,"error"),e).next();if("yes"==i||"true"==i||"1"==i)throw r("Terminated with "+n,a.toString(),t);return e.fixed.options.deliverMessage&&e.fixed.options.deliverMessage(n),e.tempOutputState=o,A.Empty},minus:function(t,e){return P(t,e).mapOneToOne(function(t){return t.negate()})},namespace:function(t,n){var o=P(t,n).next().toString(),i=U(t,n).next().toString();if(""!==o&&!_.isNCName(o))throw r("Prefix "+o+" is not an NCName","XTDE0920",t);if(""==i)throw r("Namespace is zero-length","XTDE0930",t);if("xmlns"==o||"http://www.w3.org/2000/xmlns/"==i)throw r("Disallowed prefix/namespace "+i,"XTDE0835",t);return A.Singleton(new e(o,i))},nextIteration:function(t,e){var n,r=gt.getChildElements(t,"withParam"),o=[];r.forEach(function(t){n=parseInt(t.getAttribute("slot"),10),o[n]=P(t,e).expand()});for(n in o)e.localVars[n]=o[n];return A.Empty},nextMatch:function(t,e){var n=e.currentMode.mode;if(!n)throw r("next-match: no current mode","XTDE0560",t);var o=e.currentTemplate;if(!o)throw r("next-match: no current template","XTDE0560",t);var i=e.newContext(!0);return i.currentComponent=e.currentMode,h(t,e,i),n.nextMatch(i)},nodeNum:function(t,e){return k.nodeNum(t,e)},numSeqFmt:function(t,e){return k.numSeqFmt(t,e)},onEmpty:o,onNonEmpty:o,or:function(t,e){return A.oneBoolean(f(P(t,e))||f(U(t,e)))},param:function(t,e){var n=gt.getAttributeAsEQName(t,"name"),o=parseInt(t.getAttribute("slot"),10),i=X(t,"t"),a=i?e.tunnelParams:e.localParams,u=a[n];if(!u){var s=R(t,"select");if(!s||X(t,"r"))throw r("Required parameter $"+n+" not supplied","XTDE0700",t);var c=e.tempOutputState;e.tempOutputState="xsl:param",u=St(s,e).expand(),e.tempOutputState=c}if(!("object"==typeof u&&"length"in u))throw r("Param value of $"+n+" is not an array","SXJS0004",t);e.localVars[o]=u;var l=R(t,"conversion");return null!==l&&(e.localVars[o]=St(l,e).expand()),A.Empty},precedes:function(t,e){return A.Singleton(v(t,e,function(t,e){return S["boolean"].fromBoolean(gt.compareDocumentOrder(t,e)<0)}))},procInst:function(t,e){var n=P(t,e).next().value,r=U(t,e),o=e.resultDocument.createProcessingInstruction(n,rt(r).replace(/\?>/g,"? >").replace(/^\s+/,""));return A.Singleton(o)},qName:function(t){var e=t.getAttribute("pre"),n=t.getAttribute("uri"),r=t.getAttribute("loc");return A.Singleton(S.QName.fromParts(e,n,r))},range:function(t){var e=S.integer.fromString(t.getAttribute("from")),n=S.integer.fromString(t.getAttribute("to"));return p(e,n)},resultDoc:function(t,e){if(e.tempOutputState)throw r("Cannot call xsl:result-document while evaluating "+e.tempOutputState,"XTDE1480",t);var n=R(t,"href"),o=null===n?"":St(n,e).next().toString(),i=!1;t.getAttribute("local").split(/\r?\n/).forEach(function(t){/^method=/.test(t)&&(i=/interactiveXSLT\}replace-content$/.test(t))});var u,s="#"==o.charAt(0)||"?."==o,c=b(R(t,"content"),e,s),l=function(t,e){E.child(t).forEachItem(function(t){e.appendChild(t)})};if(""===o)return A.Singleton(c);if(s)return(u="?."==o?e.getCurrentFocus():window.document.getElementById(o.substring(1)))?(i&&(u.innerHTML=""),l(c,u),A.Empty):(a("Result document href="+o+": no such node"),A.Empty);if(e.fixed.resultDocUris[o])throw r("A result document with URI "+o+" has already been created","XTDE1490",t);return e.fixed.resultDocUris[o]=!0,e.fixed.options.deliverResultDocument(o,c),A.Empty},root:function(t,e){if(e.noCurrentFocus())throw r("Focus is absent","XPDY0002",t);var n=e.getCurrentFocus();if(!gt.isNode(n))throw r("Context item for '/' must be a node","XPTY0020",t);var o=gt.ownerDocument(n);if(o.nodeType!=gt.DOCUMENT_NODE&&o.nodeType!=gt.DOCUMENT_FRAGMENT_NODE)throw r("Root node for '/' must be a document node","XPDY0050",t);return A.Singleton(gt.ownerDocument(n))},sequence:o,slash:function(t,e){var n=e.newContext(!1);n.focus=A.Tracker(P(t,e));var r=Y(t),o=function(){return r(n)};return n.focus.mapOneToMany(o)},some:function(t,e){var n=parseInt(t.getAttribute("slot"),10),r=P(t,e),o=Y(t);return A.oneBoolean(r.some(function(t){return e.localVars[n]=[t],f(o(e))}))},sort:N.sortSequence,str:function(t){var e=t.getAttribute("val");return A.oneString(e)},subscript:function(t,e){var n=P(t,e),r=U(t,e).next().value;if(n instanceof A.ForArray){var o=n.expand()[r-1];return void 0===o&&(o=null),A.Singleton(o)}var i=n.mapOneToOne(function(t,e){return e+1==r?t:null}).next();return A.Singleton(i)},supplied:function(t,e){var n=parseInt(t.getAttribute("slot"),10),r=e.localVars[n];return A.ForArray(r)},"switch":function(t,e){var n=e.fixed.options.saxonVersion;n&&"9.7.0"==n.substring(0,5)&&parseInt(n.split(".")[3],10)<15&&D("9.7.0.15",t);var r=P(t,e).next();if(null===r)return A.oneBoolean(!1);r=S.base64Binary.cast(r);for(var o=gt.getChildElements(t,"case"),i=0;i<o.length;i++){var a=P(o[i],e).next();if(a.equals(r))return U(o[i],e)}return St(R(t,"default"),e)},tail:function(t,e){var n=parseInt(t.getAttribute("start"),10)-1;return P(t,e).filter(function(t){return n--<=0})},tailCallLoop:function(t,e){return P(t,e)},to:function(t,e){var n=P(t,e).next(),r=U(t,e).next();return null===n||null===r||n.compareTo(r)>0?A.Empty:p(n,r)},treat:function(e,n){var o=new Function("item",e.getAttribute("jsTest"));return P(e,n).mapOneToOne(function(n){if(o(n))return n;var a=i(e.getAttribute("diag"));throw r("Required item type of "+a.required+" is "+e.getAttribute("as")+"; supplied value is "+t(n),a.code,e)})},"true":function(){return A.oneBoolean(!0)},"try":function(t,e){var n=!0;if(!n)return P(t,e);try{return A.ForArray(P(t,e).expand())}catch(o){if(o instanceof r&&!o.isGlobal){e.currentError=o,null===o.compiledLineNr&&o.setExpr(t);for(var i,a=S.QName.fromParts("","http://www.w3.org/2005/xqt-errors",o.code),u=A.ForArray(gt.getChildElements(t,"catch"));null!==(i=u.next());){var s=new Function("q","return "+i.getAttribute("test")+";");if(s(a))return P(i,e)}throw o}throw o instanceof r?o:(Error.dumpStack&&Error.dumpStack(),o)}},ufCall:function(t,e){var n=Q(t,e,"function"),r=n.actor,o=gt.getChildElements(t),i=e.newContext(!0);return i.currentComponent=n,i.clearGrouping(),i.tempOutputState="function",i.currentMode={},i.currentTemplate=null,i.focus=null,i.localVars=o.map(function(t){return St(t,e).expand()}),i.localParams={},St(R(r,"body"),i)},union:function(t,e){var n=P(t,e),r=U(t,e);return A.Union(n,r,gt.compareDocumentOrder)},useAS:function(t,e){var n=Q(t,e,"attributeSet"),r=n.actor,o=e.newContext(!0);return o.tempOutputState="attribute set",o.currentComponent=n,P(r,o)},valueOf:function(t,e){var n=P(t,e),r=e.resultDocument.createTextNode(rt(n)),o=t.hasAttribute("flags")?t.getAttribute("flags"):"";return A.Singleton(g(r,o))},varRef:function(t,e){var n=parseInt(t.getAttribute("slot"),10),r=e.localVars[n];return A.ForArray(r)},vc:function(t,e){function n(t){return null===t?null:S.untypedAtomic.matches(t)?S.string.cast(t):t}var o=t.getAttribute("op"),i=t.getAttribute("onEmpty"),a=P(t,e),u=U(t,e),s=n(a.next()),c=n(u.next());if(null===s||null===c)return i?A.oneBoolean("1"==i):A.Empty;if(null!==a.next()||null!==u.next())throw r("Value comparison only applicable to single values","XPTY0004",t);if(S.isSubtype(s.type,"numeric")&&isNaN(s.value)||S.isSubtype(c.type,"numeric")&&isNaN(c.value))return A.oneBoolean("ne"==o);var l=N.allocateCodedComparer(t.getAttribute("comp"),e);return"="==o||"eq"==o||"!="==o||"ne"==o?A.oneBoolean(N.testEquality(o,l.equals(s,c))):A.oneBoolean(N.testComparison(o,l.compare(s,c)))},xslNumber:function(t,e){return k.xslNumber(t,e)}},yt={xsl:"http://www.w3.org/1999/XSL/Transform",fn:"http://www.w3.org/2005/xpath-functions",math:"http://www.w3.org/2005/xpath-functions/math",map:"http://www.w3.org/2005/xpath-functions/map",array:"http://www.w3.org/2005/xpath-functions/array",xml:"http://www.w3.org/XML/1998/namespace",xs:"http://www.w3.org/2001/XMLSchema",xsi:"http://www.w3.org/2001/XMLSchema-instance",ixsl:"http://saxonica.com/ns/interactiveXSLT",js:"http://saxonica.com/ns/globalJS",saxon:"http://saxon.sf.net/"},St=V;return at.prototype={value:[],get:function(t){if("number"!=typeof t)throw r("Array subscript is not numeric","XPTY0004");if(1>t||t>=this.value.length)throw r("Array index ("+t+") out of bounds (1 to "+this.value.length+")","FOAY0001");return this.value[t-1]}},lt.prototype={value:null,containsKey:function(t){return null!==this.value[t]},get:function(t){var e=ft(this.value[t]);return Array.isArray(e)?e:[e]},inSituPut:function(t,e){throw r("inSituPut() not allowed for JSValue","SXJS0005")},put:function(t,e){throw r("put() not allowed for JSValue","SXJS0005")},remove:function(t){throw r("remove() not allowed for JSValue","SXJS0005")},keys:function(){var t=[];for(var e in this.value)this.value.hasOwnProperty(e)&&t.push(S.string.fromString(e));return t},forAllPairs:function(t){var e=this;e.keys().forEach(function(n){t({k:n,v:e.get(n)})})},conforms:function(t,e,n){var r=this;return A.ForArray(r.keys()).every(function(o){var i=r.get(o);return t(o)&&n(i.length)&&A.ForArray(i).every(e)})}},{analyze:u,argRole:R,atomize:c,checkTemplateFocus:it,codepointsToString:tt,convertFromJS:ft,convertToJS:mt,declaringPackage:K,ebv:f,evalChild1:P,evalChild2:U,evaluate:St,evaluateIfPresent:H,flatten:pt,getSourceLoc:z,hasFlag:X,internalError:q,isArray:ut,isAstral:Z,isMap:st,JSValue:lt,makeComplexContent:ot,markLocal:g,notImplemented:O,promote:nt,roleDiagnostic:i,serialize:ht,staticBaseUri:x,stringToCodepoints:et,stylesheetResolver:L,untypedToDouble:m,wsCollapse:s,XdmArray:at,KNOWN_URI:yt}}(),O=function(){"use strict";function e(t,e){return t.prec==e.prec?t.prio==e.prio?t.seq-e.seq:t.prio-e.prio:t.prec-e.prec}function n(t,e){return t.prec==e.prec?t.prio==e.prio?0:t.prio-e.prio:t.prec-e.prec}function o(t){return JSON.stringify({prec:t.prec,prio:t.prio,seq:t.seq,line:t.line,match:t.pattern})}function i(t){return D(C.argRole(t,"match"))}function a(t){this._expr=t,this.onNoMatch=t.getAttribute("onNo"),this.mustBeTyped=C.hasFlag(t,"t"),C.hasFlag(t,"F")&&(this.failOnMultipleMatch=!0),this._rules=T.getChildElements(t).map(function(t){return{rule:t,prec:parseInt(t.getAttribute("prec"),10),prio:parseFloat(t.getAttribute("prio")),seq:parseInt(t.getAttribute("seq"),10),minImp:parseInt(t.getAttribute("minImp"),10),pattern:i(t),action:C.argRole(t,"action")}}).sort(e).reverse()}var u={TC:function(t,e,n){if(!T.isNode(t))return S.anyAtomicType.matches(t)?A.Singleton(n.resultDocument.createTextNode(t.toString())):A.Singleton(t);switch(t.nodeType){case T.DOCUMENT_NODE:case T.DOCUMENT_FRAGMENT_NODE:case T.ELEMENT_NODE:var r=n.newContext(!1);return r.focus=A.Tracker(E.child(t)),e.applyTemplates(r);case T.TEXT_NODE:case T.CDATA_SECTION:return A.Singleton(T.copyItem(t,n));case T.ATTRIBUTE_NODE:return A.Singleton(n.resultDocument.createTextNode(t.value));default:return A.Empty}},SC:function(t,e,n){function r(n){var r=n.newContext(!1),o=[];return o[0]=A.Tracker(E.attribute(t)),o[1]=A.Tracker(E.child(t)),r.focus=A.Join(o),e.applyTemplates(r)}return T.shallowCopy(t,n,"c",r)},DC:function(t,e,n){return A.Singleton(T.copyItem(t,n,"c"))},DS:function(t,e,n){return A.Empty},SS:function(t,e,n){if(!T.isNode(t))return A.Singleton(t);switch(t.nodeType){case T.DOCUMENT_NODE:case T.DOCUMENT_FRAGMENT_NODE:case T.ELEMENT_NODE:var r=n.newContext(!1),o=[];return o[0]=A.Tracker(E.attribute(t)),o[1]=A.Tracker(E.child(t)),r.focus=A.Join(o),e.applyTemplates(r);default:return A.Empty}},bubble:function(t,e,n){if(!T.isNode(t))return A.Singleton(t);switch(t.nodeType){case T.ELEMENT_NODE:var r=n.newContext(!1);return r.focus=A.Tracker(E.parent(t)),e.applyTemplates(r);default:return A.Empty}}};return a.prototype={_expr:null,_rules:null,onNoMatch:"TC",mustBeTyped:!1,failOnMultipleMatch:!1,applyTemplates:function(t){var e=this;return t.focus.mapOneToMany(function(n){return e._processItem(n,t)})},applyImports:function(t){var e=t.currentTemplate;if(!e)throw r("No current template rule","XTDE0560");return this._processItem(t.getCurrentFocus(),t,function(t){return t.prec>=e.minImp&&t.prec<e.prec})},nextMatch:function(t){var n=t.currentTemplate;if(!n)throw r("No current template rule","XTDE0560");return this._processItem(t.getCurrentFocus(),t,function(t){return e(t,n)<0})},findBestRule:function(t,o,i){var a=this._rules,u=null;return this.failOnMultipleMatch?a.forEach(function(e){if((!i||i(e))&&(!u||n(e,u)>=0)){var a=!1;try{a=e.pattern(t,o)}catch(s){}if(a){if(null!==u&&0==n(e,u)){var c="Multiple templates matched item:";throw c+=C.serialize(A.Singleton(t)),c+="\n    "+u.rule.getAttribute("module"),c+="\nand "+e.rule.getAttribute("module"),r(c,"XTDE0540")}u=e}}}):a.forEach(function(n){if((!i||i(n))&&(!u||e(n,u)>0)){var r=!1;try{r=n.pattern(t,o)}catch(a){}r&&(u=n)}}),u},isNonDOMmode:function(t){return null!==this.findBestRule(C.JSValue(window),t)},_processItem:function(e,n,o){var i=this.findBestRule(e,n,o);if(null!==i)return C.checkTemplateFocus(i.rule,n),n.currentTemplate=i,n.currentMode=n.currentComponent,C.evaluate(i.action,n);var a,s=T.getAttribute(this._expr,"name");a=null!==s&&s.split("}")[0]=="Q{"+C.KNOWN_URI.ixsl?"bubble":this.onNoMatch.split("+")[0];var c=u[a];if(c)return c(e,this,n);throw r("No matching template rule for "+t(e)+" onNoMatch = "+this.onNoMatch,"XTDE0555")},printRules:function(){var t=this._rules,e="";return t.forEach(function(t){e+=o(t)}),e}},a}(),A=function(){"use strict";function t(){}function n(e){return this instanceof n?(t.call(this),void(this._item=e)):new n(e)}function r(e){return this instanceof r?(t.call(this),Array.isArray(e)||C.internalError("ForArray expects array"),void(this._array=e)):new r(e)}function o(e,n){return this instanceof o?(t.call(this),this._base=e,this._predicate=n,void(n||C.internalError("Filter iterator undefined predicate"))):new o(e,n)}function i(e,n){return this instanceof i?(t.call(this),this._base=e,void(this._mapper=n)):new i(e,n)}function u(e,n){return this instanceof u?(t.call(this),this._base=e,"object"==typeof e&&"next"in e||C.internalError("Base not an iterator"),void(this._mapper=n)):new u(e,n)}function s(e,n){return this instanceof s?(t.call(this),this._next=e,void(this._step=n)):new s(e,n)}function c(e){return this instanceof c?(t.call(this),Array.isArray(e)||C.internalError("Join iterator expects array"),void(this._iterators=e)):new c(e)}function l(e,n,r){return this instanceof l?(t.call(this),this._iter1=A.LookAhead(e),this._iter2=A.LookAhead(n),void(this._compare=r)):new l(e,n,r)}function f(e,n,r){return this instanceof f?(t.call(this),this._iter1=A.LookAhead(e),this._iter2=A.LookAhead(n),void(this._compare=r)):new f(e,n,r)}function m(e,n,r){return this instanceof m?(t.call(this),this._iter1=A.LookAhead(e),this._iter2=A.LookAhead(n),void(this._compare=r)):new m(e,n,r)}function p(e){return"peek"in e?e:this instanceof p?(t.call(this),this._base=e,void(this._nextButOne=e.next())):new p(e)}function h(e){return this instanceof h?(t.call(this),void(this._base=e)):new h(e)}function g(e){return this instanceof g?(t.call(this),void(this.current=e)):new g(e)}function d(e,n){return this instanceof d?(t.call(this),Array.isArray(e)||C.internalError("Block iterator expects array"),this._instructions=e,this._currentIterator=null,void(this._context=n)):new d(e,n)}t.prototype={filter:function(t){return o(this,t)},mapOneToOne:function(t){return u(this,t)},mapOneToMany:function(t){return new i(this,t)},forEachItem:function(t){for(var e;null!==(e=this.next());)t(e)},some:function(t){for(var e;null!==(e=this.next());)if(t(e))return!0;return!1},every:function(t){for(var e;null!==(e=this.next());)if(!t(e))return!1;return!0},count:function(){var t=0;return this.forEachItem(function(){t++}),t},expand:function(){var t=[];return this.forEachItem(function(e){t.push(e)}),t}},n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._item=null,n.prototype.next=function(){var t=this._item;return this._item=null,t},n.prototype.peek=function(){return this._item},n.prototype.expand=function(){return null===this._item?[]:[this._item]};var v={next:function(){return null},peek:function(){return null},expand:function(){return[]},count:function(){return 0},filter:function(){return v},mapOneToOne:function(){return v},mapOneToMany:function(){return v},forEachItem:function(){},some:function(){return!1}};return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._array=null,r.prototype._index=0,r.prototype.next=function(){return this._index<this._array.length?this._array[this._index++]:null},r.prototype.peek=function(){return this._index<this._array.length?this._array[this._index]:null},r.prototype.expand=function(){return this._array},r.prototype.count=function(){return this._array.length},o.prototype=Object.create(t.prototype),o.prototype.constructor=o,o.prototype._base=null,o.prototype._predicate=null,o.prototype.next=function(){for(;;){var t=this._base.next();if(!t)return null;if(this._predicate(t))return t}},i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._base=null,i.prototype._mapper=null,i.prototype._currentIter=null,i.prototype.next=function(){for(;;){if(null!==this._currentIter){var t=this._currentIter.next();if(t)return t}var e=this._base.next();if(null===e)return null;this._currentIter=this._mapper(e),this._currentIter&&!this._currentIter.next&&C.internalError("Result of mapper is not an iterator, mapper = "+this._mapper);
}},u.prototype=Object.create(t.prototype),u.prototype.constructor=u,u.prototype._base=null,u.prototype._mapper=null,u.prototype._position=0,u.prototype.next=function(){for(;;){var t=this._base.next();if(null===t)return null;var e=this._mapper(t,this._position++);if(e)return e}},s.prototype=Object.create(t.prototype),s.prototype.constructor=s,s.prototype._step=null,s.prototype._next=null,s.prototype.next=function(){var t=this._next;return t?(this._next=this._step(t),t):null},s.prototype.peek=function(){return this._next},c.prototype=Object.create(t.prototype),c.prototype.constructor=c,c.prototype._iterators=[],c.prototype.current=null,c.prototype.next=function(){for(;;){if(0===this._iterators.length)return this.current=null,null;var t=this._iterators[0].next();if(null!==t)return this.current=t,t;this._iterators.shift()}},l.prototype=Object.create(t.prototype),l.prototype.constructor=l,l.prototype._iter1=null,l.prototype._iter2=null,l.prototype._compare=null,l.prototype.current=null,l.prototype.next=function(){var t=this._iter1.peek(),e=this._iter2.peek();if(t&&e){var n=this._compare(t,e);return 0>n?(this.current=this._iter1.next(),this.current):n>0?(this.current=this._iter2.next(),this.current):(this.current=this._iter1.next(),this._iter2.next(),this.current)}return t?(this.current=this._iter1.next(),this.current):e?(this.current=this._iter2.next(),this.current):(this.current=null,null)},f.prototype=Object.create(t.prototype),f.prototype.constructor=f,f.prototype._iter1=null,f.prototype._iter2=null,f.prototype._compare=null,f.prototype.current=null,f.prototype.next=function(){for(var t=this._iter1.peek(),e=this._iter2.peek();t&&e;){var n=this._compare(t,e);if(0>n)this._iter1.next(),t=this._iter1.peek();else{if(!(n>0))return this.current=this._iter1.next(),this._iter2.next(),this.current;this._iter2.next(),e=this._iter2.peek()}}return this.current=null,null},m.prototype=Object.create(t.prototype),m.prototype.constructor=m,m.prototype._iter1=null,m.prototype._iter2=null,m.prototype._compare=null,m.prototype.current=null,m.prototype.next=function(){for(var t=this._iter1.peek(),e=this._iter2.peek();t&&e;){var n=this._compare(t,e);if(0>n)return this.current=this._iter1.next(),this.current;n>0?(this._iter2.next(),e=this._iter2.peek()):(this._iter1.next(),this._iter2.next(),t=this._iter1.peek(),e=this._iter2.peek())}return t&&!e?(this.current=this._iter1.next(),this.current):(this.current=null,null)},p.prototype=Object.create(t.prototype),p.prototype.constructor=p,p.prototype._base=null,p.prototype.next=function(){var t=this._nextButOne;return t&&(this._nextButOne=this._base.next()),t},p.prototype.peek=function(){return this._nextButOne},h.prototype=Object.create(t.prototype),h.prototype.constructor=h,h.prototype._base=null,h.prototype._last=-1,h.prototype.position=0,h.prototype.current=null,h.prototype.regexGroups=[],h.prototype.next=function(){return this.position++,this.current=this._base.next(),null===this.current&&(this.position=-1),this.current},h.prototype.last=function(){if(this._last<0)if(this._base instanceof r)this._last=this._base.expand().length;else{for(var t,e=[];null!==(t=this._base.next());)e.push(t);this._last=this.position+e.length,this._base=A.ForArray(e)}return this._last},g.prototype=Object.create(t.prototype),g.prototype.constructor=g,g.prototype.position=1,g.prototype.current=null,g.prototype.next=function(){return null},g.prototype.last=function(){return 1},d.prototype=Object.create(t.prototype),d.prototype.constructor=d,d.prototype._instructions=[],d.prototype._currentIterator=null,d.prototype._context=null,d.prototype.current=null,d.prototype.next=function(){for(;;){if(null===this._currentIterator){if(0===this._instructions.length)return this.current=null,null;this._currentIterator=C.evaluate(this._instructions[0],this._context)}var t=this._currentIterator.next();if(null!==t)return this.current=t,t;this._instructions.shift(),this._currentIterator=null}},{Empty:v,Singleton:n,Join:c,Stepping:s,LookAhead:p,Tracker:h,Solo:g,ForArray:r,Union:l,Intersect:f,Difference:m,AnyIterator:t,Block:d,trace:function(t,n,r){for(var o,i=[];null!==(o=n.next());){var u;u="object"==typeof o?o instanceof Node?r?o.toString():o.nodeType+":"+(o.tagName||o.textContent):o instanceof e?"xmlns:"+o.prefix+"="+o.uri:o.toString():typeof o,a(t+": "+u),i.push(o)}return 0===i.length&&a(t+": <empty>"),A.ForArray(i)},oneString:function(t){return A.Singleton(S.string.fromString(t))},oneInteger:function(t){return A.Singleton(S.integer.fromNumber(t))},oneDouble:function(t){return A.Singleton(S["double"].fromNumber(t))},oneFloat:function(t){return A.Singleton(S["float"].fromNumber(t))},oneDecimal:function(t){return A.Singleton(S.decimal.fromBig(t))},oneBoolean:function(t){return A.Singleton(S["boolean"].fromBoolean(t))}}}(),D=function(t){"use strict";var e={"p.any":function(t){return function(){return!0}},"p.booleanExp":function(t){return function(e,n){var r=n.newContext();return r.focus=A.Solo(e),C.ebv(C.evalChild1(t,r))}},"p.genNode":function(t){var e=T.getChildElements(t)[0];return function(t,n){if(!T.isNode(t))return!1;for(var r,o=E.ancestorOrSelf(t);null!==(r=o.next());){var i=n.newContext(!1);i.focus=A.Solo(r);for(var a,u=C.evaluate(e,i);null!==(a=u.next());)if(T.isSameNode(a,t))return!0}return!1}},"p.genPos":function(t){var e=new Function("item",t.getAttribute("jsTest"));return function(n,r){if(!e(n))return!1;var o=E["preceding-sibling"](r.getCurrentFocus()).filter(e).expand(),i=r.newContext(!1);return i.focus=A.Solo(n),i.focus.position=o.length+1,C.ebv(C.evalChild1(t,i))}},"p.nodeSet":function(t){return function(e,n){for(var r,o=C.evalChild1(t,n);null!==(r=o.next());)if(r==e)return!0;return!1}},"p.nodeTest":function(t){return new Function("item",t.getAttribute("jsTest"))},"p.simPos":function(t){var e=new Function("item",t.getAttribute("jsTest")),n=parseInt(t.getAttribute("pos"),10);return function(t,r){return e(t)&&E.precedingSibling(t).filter(e).count()==n-1}},"p.venn":function(t){var e=T.getChildElements(t),n=D(e[0]),o=D(e[1]),i=t.getAttribute("op");switch(i){case"union":return function(t,e){return n(t,e)||o(t,e)};case"intersect":return function(t,e){return n(t,e)&&o(t,e)};case"except":return function(t,e){return n(t,e)&&!o(t,e)};default:throw r("unknown op "+i,"SXJS0003")}},"p.withCurrent":function(t){var e=D(T.getChildElements(t)[0]);return function(t,n){var r=n.newContext(!0);return r.localVars[0]=[t],e(t,r)}},"p.withPredicate":function(t){var e=T.getChildElements(t),n=D(e[0]),r=e[1];return function(t,e){if(!n(t,e))return!1;var o=e.newContext(!1);return o.focus=A.Solo(t),C.ebv(C.evaluate(r,o))}},"p.withUpper":function(t){var e=T.getChildElements(t),n=D(e[0]),r=D(e[1]),o=t.getAttribute("axis");return"parent"==o?"true"==t.getAttribute("upFirst")?function(t,e){var o=T.xdmParentNode(t);return o&&r(o,e)&&n(t,e)}:function(t,e){var o=T.xdmParentNode(t);return o&&n(t,e)&&r(o,e)}:function(t,e){if(!n(t,e))return!1;for(var i,a=E[o](t);null!==(i=a.next());)if(r(i,e))return!0;return!1}}},n=e[t.tagName];if(n)return n(t);throw r("Unimplemented pattern "+t.tagName,"SXJS0002")},_=function(){"use strict";function t(){if(null===o){a("Loading categories.json");var t=SaxonJS.getPlatform().readResource("opt/categories.json");o=JSON.parse(t),a("Finished loading categories.json")}return o}function e(e,n,o){function u(e,n){function r(t){for(var e=t.toString(16);e.length<4;)e="0"+e;return"\\u"+(i&&e.length>4?"{"+e+"}":e)}function o(t){for(var e="",n=0;n<t.length;n+=2)(i||t[n+1]<65536)&&(e+=r(t[n]),t[n+1]>t[n]&&(e+="-"+r(t[n+1])));return e}function u(t){var e=[];0!==t[0]&&(e.push(0),e.push(t[0]-1));for(var n=2;n<t.length;n+=2)e.push(t[n-1]+1),e.push(t[n]-1);var r=t[t.length-1];return(i||65535>r)&&(e.push(r+1),e.push(i?1114111:65535)),e}function f(t,e,n){n&&(t=u(t));var r=o(t);return e||(r="["+r+"]"),r}function m(t,e,n){var r=[];return t.forEach(function(t){r.push(parseInt(t[0],16)),r.push(parseInt(t[1],16))}),f(r,e,n)}var d=e.charAt(n+1);if(l&&"nrt\\|.-^?*+{}()[]pPsSiIcCdDwW$".indexOf(d)<0&&(0!==S||!/[0-9]/.test(d))&&c("\\"+d+" is not allowed in XPath regular expressions"),"p"==d||"P"==d){var y=e.indexOf("}",n),N=e.substring(n+3,y);s("x")&&(N=N.replace(/[ \n\r\t]+/g,""));var x=t(),b=x[N];b||c("Unknown category "+N);var T;1==N.length?(T=[],b.split("|").forEach(function(t){T=T.concat(x[t])})):T=b,p+=m(T,S>0,"P"==d),n=y}else"d"==d?(p+=m(t().Nd,S>0,!1),n++):"i"==d?(p+=f(h,S>0,!1),n++):"c"==d?(p+=f(g,S>0,!1),n++):"I"==d?(p+=f(h,S>0,!0),n++):"C"==d?(p+=f(g,S>0,!0),n++):/[0-9]/.test(d)?S>0?c("Numeric escape within charclass"):(v[parseInt(d,10)]?a("Capture #"+d+" ok"):c("No capturing expression #"+d),p+="\\"+d,n++):"-"==d||"$"==d?(p+=d,n++):(p+="\\"+d,n++);return{output:p,i:n}}function s(t){return n.indexOf(t)>=0}function c(t){throw new r("Invalid XPath regular expression: "+t,"FORX0002")}var l=!0;if(n=n?n.toString():"",!i&&o&&C.isAstral(o))throw new r("Cannot handle non-BMP characters with regular expressions in this browser","SXJS0002");var f=(s("i")?"i":"")+(s("m")?"m":"")+(s("g")?"g":"")+(i?"u":"");if(s("j"))return new RegExp(e,n.replace("j",""));if(s("q"))return new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),f);var m,p="",h=[58,58,65,90,95,95,97,122,192,214,216,246,248,767,880,893,895,8191,8204,8205,8304,8591,11264,12271,12289,55295,63744,64975,65008,65533,65536,983039],g=[45,46,48,58,65,90,95,95,97,122,183,183,192,214,216,246,248,893,895,8191,8204,8205,8255,8256,8304,8591,11264,12271,12289,55295,63744,64975,65008,65533,65536,983039],d=[],v=[],y=1,S=0,N=[];for(m=0;m<e.length;m++){var x=e.charAt(m);switch(x){case"[":l&&S>0&&c("Nested square brackets");var b,T=!1,w=!1;for(b=m+2;b<e.length-3;b++){if(!w&&"-["==e.substring(b,b+2)){var E,O,A=e.substring(m+1,b);for(O=b+2;O<e.length;O++)if("]"==e.charAt(O)&&"\\"!=e.charAt(O-1)){E=e.substring(b+2,O+1);break}"^"==A&&c("Invalid subtraction");var D=e.substring(0,m)+"(?!["+E+")["+A+"]"+e.substring(O+2);e=D,m--,T=!0;break}if(!w&&"]"==e.charAt(b))break;w="\\"==e.charAt(b)&&!w}if(T)break;"]"==e.charAt(m+1)&&c("Character group is empty"),S++,N.push(p.length),p+=x;break;case"]":0===S&&c("Unmatched ']'"),S--,N.pop(),p+=x;break;case"(":var _=!0;m+2<e.length&&"?"==e.charAt(m+1)&&(":"==e.charAt(m+2)||T&&"!"==e.charAt(m+2)?_=!1:c("'(?' must be followed by ':'")),d.push(_?y++:-1),p+=x;break;case")":0===d.length&&c("Unmatched ')'");var F=d.pop();F>0&&(v[F]=!0),p+=x;break;case".":p+=0===S&&s("s")?"[^]":x;break;case"{":if(l&&","==e.charAt(m+1))throw r("{,x} not allowed in XPath regex dialect","FORX0002");p+=x;break;case" ":case"\n":case"\r":case"	":(!s("x")||S>0)&&(p+=x);break;case"\\":if(s("q"))p+="\\\\";else{if(!(m+1<e.length))throw r("No character for escape code in XPath regex","FORX0002");s("x")&&/\s/.test(e.charAt(m+1))&&m++;var I=u(e,m);p=I.output,m=I.i}break;default:p+=x}}S>0&&c("Unmatched '['"),0!==d.length&&c("Unmatched '(");try{return new RegExp(p,f)}catch(M){throw/^[imsxjqg]*$/.test(n)?new r("Invalid regular expression /"+e+"/: "+M.message,"FORX0002"):new r("Invalid regex flags: "+n,"FORX0001")}}function n(t,e){if(e=e.toString(),/j/.test(e))return t;if(/q/.test(e))return/\$['`]/.test(t)&&(t=t.replace(/\$'/g,"$$$$'").replace(/\$`/g,"$$$$`")),t.replace(/\$/g,"$$");if(/(^|[^\\])\$([^0-9]|$)/.test(t)||/(^|[^\\])\\([^\\\$]|$)/.test(t))throw new r("Invalid replacement string: "+t,"FORX0004");return t.replace(/\\\\/g,"\\").replace(/\\\$/g,"$$$$").replace(/\$0/g,"$$&")}var o=null,i=!1;try{i=1=="".match(new RegExp(".","gu")).length}catch(u){i=!1}var s=e("^\\i\\c*$",""),c=e("^\\c+$","");return{obtainCategoryEscapes:t,prepareRegex:e,convertReplacement:n,isNCName:function(t){return s.test(t)&&!/:/.test(t)},isName:function(t){return s.test(t)},isNMTOKEN:function(t){return c.test(t)},isQName:function(t){return s.test(t)&&/^[^:]+(:[^:]+)?$/.test(t)},trim:function(t){return t.replace(/^[ \t\r\n]+|[ \t\r\n]+$/g,"")}}}(),F=function(){"use strict";function n(t,e,n){var o=e.fixed.documentPool[t];if(!o){try{o=n()}catch(i){o=i}e.fixed.documentPool[t]=o}if(o instanceof r)throw o;return o}function o(t,e){if(t.indexOf("#")>=0)throw r("Fragments not supported in external document URIs","FODC0002");return n(t,e,function(){var e=SaxonJS.getPlatform().readFile(t),n=I.obtainDocumentNumber(SaxonJS.getPlatform().parseXmlFromString(e));return n._saxonBaseUri=t,n})}function i(t,e){if(t.indexOf("#")>=0)throw r("Fragments not supported in external document URIs","FODC0002");return n(t,e,function(){return SaxonJS.getPlatform().readFile(t,"utf-8")})}function u(t,e,n){var r=F.staticBaseUri(n,e),o=t[0].next();return null===o?null:SaxonJS.getPlatform().resolveUri(o.toString(),r)}function s(t,e,o){var i;try{i=u(t,e,o)}catch(a){throw r(a.message,"FOUT1170",o)}if(i.match(/#/))throw r("Fragment identifier for unparsed-text"+i.toString(),"FOUT1170",o);var s="";if(t[1]&&(s=h(t[1]).toLowerCase(),"utf-8"!=s&&"utf-16"!=s))throw r("Unrecognized encoding "+s,"FOUT1190");return null===i?null:n(i,e,function(){try{return SaxonJS.getPlatform().readFile(i,s)}catch(t){throw r("Cannot retrieve unparsed-text "+i.toString(),"FOUT1170",o)}})}function c(t){try{return t(),A.oneBoolean(!0)}catch(e){return A.oneBoolean(!1)}}function l(t,e,n,o){var i=t.next();if(i){var a=_.trim(i.toString());if(o&&_.isNCName(a))return"Q{"+o+"}"+a;var u=S.QName.fromString(a,F.stylesheetResolver(e,!1));if(null===u)throw new r("Invalid QName "+a,n,e);return"Q{"+u.uri+"}"+u.local}return null}function f(t,e){var n=h(t[0]),r="";return C.stringToCodepoints(n).forEach(function(t){var n=C.codepointsToString([t]);r+=e(t,n)?encodeURIComponent(n):n}),A.oneString(r)}function m(t,e){if(2!=e.length&&5!=e.length)throw new r("Wrong number of arguments ("+e.length+") for  "+t,"XPST0017")}function p(t){var e=t[0].next(),n=t[1].next(),r=C.atomize(n.value[0][0]).next();return e instanceof C.XdmArray&&(r=S.numeric.matches(r)?r.toNumber():S["double"].cast(r).toNumber()),A.ForArray(e.get(r))}function h(t){var e=t.next();return e?e.value:""}function g(t){return F.stringToCodepoints(h(t))}function d(t,e,n){var r=Math.round(e.next().toNumber()),o=n?r+Math.round(n.next().toNumber()):t.length+1;return t.filter(function(t,e){return e+1>=r&&o>e+1})}function v(t,e,n){var r=e;return t.forEachItem(function(t){r=n(t,r)}),r}function y(t){function e(t){throw new r(t,"FORG0006")}var n="max"==t?function(t){return t>0}:function(t){return 0>t};return function(r,o,i){var a=r[0];F.hasFlag(i,"i")&&(a=a.filter(function(t){return!N.itemIsNaN(t)}));var u=N.getCollatingFn(i,r[1],"compare",o),s=N.cmpFn(u),c=S.untypedAtomic.matches,l=S.numeric.matches,f=S["double"].matches,m=S["float"].matches,p=S.anyURI.matches,h=S.string.matches,g=S.duration.matches,d=S.yearMonthDuration.matches,y=S.dayTimeDuration.matches,x=S.QName.matches,b=S["double"].cast,T=S["float"].cast,w=S.string.cast;a=a.mapOneToOne(function(t){return c(t)?b(t):t});var E=a.next();return null===E?A.Empty:(x(E)&&e(t+"() not defined over QName"),!g(E)||d(E)||y(E)||e(t+"() not defined over mixed duations"),A.Singleton(v(a,E,function(t,r){return(h(t)&&l(r)||h(r)&&l(t))&&e("Cannot compare string with numeric"),(d(t)&&!d(r)||y(t)&&!y(r))&&e("Cannot compare mixed duations"),N.itemIsNaN(r)?f(t)?b(r):r:N.itemIsNaN(t)?f(r)?b(t):t:(f(r)&&!h(t)?t=b(t):f(t)&&!h(r)?r=b(r):m(r)&&!h(t)?t=T(t):m(t)&&!h(r)&&(r=T(r)),p(r)&&h(t)?r=w(r):p(t)&&h(r)&&(t=w(t)),n(s(t,r))?t:r)})))}}function x(t,e){var n=t[0].next();if(null===n)return A.Empty;if("timezone"==e)return null===n.timezoneOffset?A.Empty:A.Singleton(S.dayTimeDuration.fromNumberOfMinutes(n.timezoneOffset));if("seconds"==e){var r=n.proxy();return A.oneDecimal(r.getUTCSeconds()+r.getUTCMilliseconds()/1e3)}var o=n.proxy()[e]();return"getUTCMonth"==e&&o++,A.oneInteger(o)}function b(t,e){var n=t[0].next();return null===n?A.Empty:5!=e?A.oneInteger(n.parts()[e]*n.signum()):A.oneDecimal(n.parts()[e]*n.signum())}function O(t,e,n){function o(t,n){return A.Singleton(S[e].fromDate(t,n))}var i=t[0].next();if(!i)return A.Empty;var a,u=n.fixed.currentDate.getTimezoneOffset();if(t[1]){var s=t[1].next();if(a=null!==s?s.milliseconds/6e4:null,null!==a&&(-840>a||a>840))throw new r("timezone out of bounds "+s,"FODT0003")}else a=-u;var c=i.timezoneOffset;return null===c&&null===a?A.Singleton(i):null===c&&null!==a?o(i.adjustByMinutes(-u-a).UTCdate,a):null!==c&&null===a?o(i.adjustByMinutes(u+c).UTCdate,null):null!==c&&null!==a?o(i.UTCdate,a):void 0}var F=C,I=T,P={version:"3.0",vendor:"Saxonica","vendor-url":"http://www.saxonica.com/","product-name":"Saxon-JS","product-version":"1.0.0","is-schema-aware":"no","supports-serialization":"no","supports-backwards-compatibility":"yes","supports-namespace-axis":"yes","supports-streaming":"no","supports-dynamic-evaluation":"yes","supports-higher-order-functions":"no","xpath-version":"3.1","xsd-version":"1.1"};return{abs:function(t){var e=t[0].next();return null===e?A.Empty:A.Singleton(e.abs())},"accumulator-after":function(t,e,n){var r=l(t[0],n,"XTDE3340");return A.ForArray(R.accumAfter(r,e.getCurrentFocus(),e))},"accumulator-before":function(t,e,n){var r=l(t[0],n,"XTDE3340");return A.ForArray(R.accumBefore(r,e.getCurrentFocus(),e))},"adjust-date-to-timezone":function(t,e){return O(t,"date",e)},"adjust-dateTime-to-timezone":function(t,e){return O(t,"dateTime",e)},"adjust-time-to-timezone":function(t,e){return O(t,"time",e)},"analyze-string":function(t,e){var n=h(t[0]),r=e.resultDocument.createDocumentFragment(),o=C.KNOWN_URI.fn,i=e.resultDocument.createElementNS(o,"analyze-string-result");if(r.appendChild(i),""===n)return A.Singleton(i);var a=t[1].next().toString(),u=t[2]?t[2].next().toString():"",s=C.analyze(n,a,u,!1,!1);return s.forEach(function(t){var n,r;if(t.matching){var a,u=t.groups;n=e.resultDocument.createElementNS(o,"match");var s,c=0;for(s=1;s<u.length;s++)if(u[s]){a=u[0].indexOf(u[s],c),a>c&&(r=e.resultDocument.createTextNode(u[0].substring(c,a)),n.appendChild(r));var l=e.resultDocument.createElementNS(o,"group");l.setAttribute("nr",s);var f=e.resultDocument.createTextNode(u[s]);l.appendChild(f),n.appendChild(l),c=a+u[s].length}c<u[0].length&&(r=e.resultDocument.createTextNode(u[0].substring(c,a)),n.appendChild(r)),i.appendChild(n)}else n=e.resultDocument.createElementNS(o,"non-match"),r=e.resultDocument.createTextNode(t.string),n.appendChild(r),i.appendChild(n)}),A.Singleton(i)},apply:p,_APPLY:p,"available-environment-variables":function(){return A.Empty},"available-system-properties":function(){var t=[];for(var e in P)t.push(S.QName.fromParts("xsl",C.KNOWN_URI.xsl,e));return A.ForArray(t)},avg:function(t){var e=t[0].mapOneToOne(F.untypedToDouble),n=e.next();if(null===n)return A.Empty;var o={sum:n,count:1},i=M["a+a"];try{var a=v(e,o,function(t,e){return{sum:i(e.sum,t),count:e.count+1}});return A.Singleton(M["a/a"](a.sum,S.integer.fromNumber(a.count)))}catch(u){throw new r("Input to avg() contains a mix of numeric and non-numeric values ","FORG0006")}},"base-uri":function(t){return t[0].mapOneToOne(function(t){var e=I.baseURI(t);return null===e?null:S.anyURI.fromString(e)})},"boolean":function(t){return A.oneBoolean(F.ebv(t[0]))},ceiling:function(t){var e=t[0].next();return A.Singleton(null===e?null:e.ceiling())},"codepoint-equal":function(t){var e=t[0].next(),n=t[1].next();return null===e||null===n?A.Empty:A.oneBoolean(e.toString()===n.toString())},"codepoints-to-string":function(t){return A.oneString(F.codepointsToString(t[0].expand().map(function(t){return t.toNumber()})))},"collation-key":function(t,e,n){var r=t[0].next(),o=N.getCollatingFn(n,t[1],"collationKey",e);return A.Singleton(S.base64Binary.encodeFromString(o(r.value)))},collection:function(t,e,n){var o=e.fixed.options.collectionFinder;if(o&&"function"==typeof o){var i=null;if(t[0]){var a=t[0].next();null!==a&&(i=SaxonJS.getPlatform().resolveUri(a.toString(),F.staticBaseUri(n,e)))}var u=i?o(i):o();if("undefined"==typeof u)throw new r("No available collection for supplied URI: "+i,"FODC0002",n);u=F.convertFromJS(u);var s=e.fixed.spaceStripper;if(null!==s)for(var c=0;c<u.length;c++)u[c]=s(u[c]);return Array.isArray(u)?A.ForArray(u):A.Singleton(u)}if(t[0])throw new r("Unknown collection (no collectionFinder supplied)","FODC0002",n);return A.Empty},compare:function(t,e,n){var r=t[0].next(),o=t[1].next();if(null===r||null===o)return A.Empty;var i=N.getCollatingFn(n,t[2],"compare",e);return A.oneInteger(i(r.value,o.value))},concat:function(t){return A.oneString(t.map(function(t){var e=t.next();return null===e?"":S.string.cast(e)}).join(""))},contains:function(t,e,n){var r=h(t[0]),o=h(t[1]),i=N.getCollatingFn(n,t[2],"contains",e);return A.oneBoolean(i(r,o))},"contains-token":function(t,e,n){var r=h(t[1]);if(r=_.trim(r),""===r)return A.oneBoolean(!1);for(var o,i=N.getCollatingFn(n,t[2],"equals",e);null!=(o=t[0].next());)if(o.toString().split(/[ \n\r\t]+/).findIndex(function(t){return i(t,r)})>=0)return A.oneBoolean(!0);return A.oneBoolean(!1)},count:function(t){return A.oneInteger(t[0].count())},"current-date":function(t,e){return A.Singleton(S.date.fromDate(e.fixed.currentDate,-e.fixed.currentDate.getTimezoneOffset()))},"current-dateTime":function(t,e){return A.Singleton(S.dateTimeStamp.fromDate(e.fixed.currentDate,-e.fixed.currentDate.getTimezoneOffset()))},"current-merge-group":function(t,e){if(null==e.currentMergeGroup)throw r("There is no current merge group","XTDE3480");if(t[0]){var n=t[0].next().value,o=e.currentMergeGroup.groups[n];if(o)return A.ForArray(o);throw r("Unknown merge source "+n,"XTDE3490")}return A.ForArray(e.currentMergeGroup.items)},"current-merge-key":function(t,e){if(null==e.currentMergeGroup)throw r("There is no current merge group","XTDE3510");return A.ForArray(e.currentMergeGroup.keys)},"current-time":function(t,e){return A.Singleton(S.time.fromDate(e.fixed.currentDate,-e.fixed.currentDate.getTimezoneOffset()))},data:function(t){return t[0].mapOneToOne(F.atomize)},dateTime:function(t){var e=t[0].next(),n=t[1].next();if(null===e||null===n)return A.Empty;var o="";if(null!==e.timezoneOffset)if(null===n.timezoneOffset)o=e.tzOffsetToString();else if(null!==n.timezoneOffset&&e.timezoneOffset!=n.timezoneOffset)throw new r("timezones are incompatible ","FORG0005");return A.Singleton(S.dateTime.fromString(e.toString().substring(0,10)+"T"+n.toString()+o))},"day-from-date":function(t){return x(t,"getUTCDate")},"day-from-dateTime":function(t){return x(t,"getUTCDate")},"days-from-duration":function(t){return b(t,2)},"deep-equal":function(t,e,n){var r=N.getCollatingFn(n,t[2],"equals",e);return A.oneBoolean(N.deepEqualSequences(t[0],t[1],r))},"default-collation":function(){return A.oneString(N.codepointCollationUri)},"default-language":function(){return A.Singleton(S.language.fromString("en"))},"distinct-values":function(t,e,n){var r=N.getCollation(n,t[1],e),o=N.trieWithCollation(r);return t[0].filter(function(t){return o.containsKey(t)?!1:(o.inSituPut(t,!0),!0)})},doc:function(t,e,n){var r=u(t,e,n);if(null===r)return A.Singleton(null);var i=o(r,e),a=e.fixed.spaceStripper;return null!==a&&(i=a(i)),A.Singleton(i)},"doc-available":function(t,e,n){var r=u(t,e,n);return null===r?A.oneBoolean(!1):c(function(){o(r,e)})},document:function(t,e,n){var i;if(t[1]){var a=I.baseURI(t[1].next());a&&(i=a)}return i||(i=F.staticBaseUri(n,e)),t[0].mapOneToMany(function(t){var n=I.isNode(t)?I.baseURI(t):i;return F.atomize(t).mapOneToOne(function(t){if(null===n)throw new r("No base URI for document('"+t+"')","XTDE1162");return o(SaxonJS.getPlatform().resolveUri(t.toString(),n),e)})})},"document-uri":function(t){var e=t[0].next();return null!==e&&e.nodeType==I.DOCUMENT_NODE&&e._saxonBaseUri?A.Singleton(S.anyURI.fromString(e._saxonBaseUri)):A.Empty},"element-available":function(t,e,n){l(t[0],n,"XTDE1440").split("}");return A.oneBoolean(!0)},"element-with-id":function(t,e){var n=h(t[0]);if(e.noCurrentFocus())throw new r("No context item for element-with-id()","XPDY0002");return A.Singleton(I.ownerDocument(e.getCurrentFocus()).getElementById(n))},empty:function(t){return A.oneBoolean(null===t[0].next())},"encode-for-uri":function(t){var e=encodeURIComponent(h(t[0])).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()});return A.oneString(e)},"ends-with":function(t,e,n){var r=h(t[0]),o=h(t[1]),i=N.getCollatingFn(n,t[2],"endsWith",e);return A.oneBoolean(i(r,o))},"environment-variable":function(){return A.Empty},error:function(t){if(void 0===t[0])throw new r("fn:error() invoked","FOER0000");var e=t[0].next();e=e?e.local:"FOER0000";var n=t[1]?h(t[1]):"";throw new r(n,e)},"escape-html-uri":function(t){return f(t,function(t){return 32>t||t>126})},"exactly-one":function(t){var e=t[0].expand();if(1!=e.length)throw new r("Required length 1, actual length "+e.length,"FORG0005");return A.Singleton(e[0])},exists:function(t){return A.oneBoolean(null!==t[0].next())},"false":function(){return A.oneBoolean(!1)},floor:function(t){return t[0].mapOneToOne(function(t){return t.floor()})},"format-date":function(t){return m("format-date",t),t[2]?A.oneString(k.formatDateTime("date",t[0].next(),t[1].next().toString(),t[2].next(),t[3].next(),t[4].next())):A.oneString(k.formatDateTime("date",t[0].next(),t[1].next().toString()))},"format-dateTime":function(t){return m("format-dateTime",t),t[2]?A.oneString(k.formatDateTime("dateTime",t[0].next(),t[1].next().toString(),t[2].next(),t[3].next(),t[4].next())):A.oneString(k.formatDateTime("dateTime",t[0].next(),t[1].next().toString()))},"format-integer":function(t){var e=t[0].next();return null===e?A.oneString(""):A.oneString(k.formatInteger(e,t[1].next().toString()))},"format-number":function(t,e,n){var o=t[2]?l(t[2],n,"XTDE1260"):"Q{}",i=C.declaringPackage(n,e),a=i.decimalFormats[null!==o?o:"Q{}"];if(!a)throw r("Unknown decimal format "+o,"FODF1280");var u=t[0].next();return u=null===u?Number.NaN:u.toDouble().value,A.oneString(k.formatNumber(u,t[1].next().toString(),a,e))},"format-time":function(t){return m("format-time",t),t[2]?A.oneString(k.formatDateTime("time",t[0].next(),t[1].next().toString(),t[2].next(),t[3].next(),t[4].next())):A.oneString(k.formatDateTime("time",t[0].next(),t[1].next().toString()))},"function-available":function(t,e,n){var r=!1,o=l(t[0],n,"XTDE1400",C.KNOWN_URI.fn),i=t[1]?t[1].next().toNumber():-1;if(e.fixed.userFunctions[o+"#"+i])r=!0;else{var a=S.QName.fromEQName(o),u=SaxonJS.getPlatform().readResource("opt/functions.json"),s=JSON.parse(u),c=s[a.uri];r=c&&c[a.local]?i>=0?c[a.local].indexOf(i)>=0:!0:!1}return A.oneBoolean(r)},"generate-id":function(t,n){var r=t[0].next();if(null===r)return A.oneString("");var o,i=E.ancestorOrSelf(r).expand().reverse(),a="";for(o=0;o<i.length;o++){var u;i[o]instanceof e?a+="N"+i[o].prefix:i[o].nodeType==I.ATTRIBUTE_NODE?a+="A"+I.nameOfNode(i[o]).local:(u=E.precedingSibling(i[o]).count()+1,a+=k.formatInteger(u,o%2===0?"a":"A"))}return a="d"+I.documentNumber(i[0],n)+a,A.oneString(a)},"has-children":function(t){return A.oneBoolean(null!==E.child(t[0].next()).next())},head:function(t){return A.Singleton(t[0].next())},"hours-from-dateTime":function(t){return x(t,"getUTCHours")},"hours-from-duration":function(t){return b(t,3)},"hours-from-time":function(t){return x(t,"getUTCHours")},id:function(t,e){var n=h(t[0]).trim(),o=t[1]?t[1].next():I.ownerDocument(e.getCurrentFocus());if(!I.isNode(o))throw new r("Context item is not a node for fn:id()","XPTY0004");if(o.nodeType!=T.DOCUMENT_NODE&&(o=I.ownerDocument(o)),o.nodeType==T.DOCUMENT_NODE)return A.Singleton(o.getElementById(n));if(o.nodeType==T.DOCUMENT_FRAGMENT_NODE)for(var i,a=E.descendant(o);null!==(i=a.next());)if(i.nodeType==T.ELEMENT_NODE&&i.getAttributeNS(C.KNOWN_URI.xml,"id")===n)return A.Singleton(i);return A.Empty},idref:function(){return A.Empty},"implicit-timezone":function(t,e){return A.Singleton(S.dayTimeDuration.fromNumberOfMinutes(-e.fixed.currentDate.getTimezoneOffset()))},"index-of":function(t,e,n){var r=A.Tracker(t[0]),o=t[1].next(),i=N.getCollatingFn(n,t[2],"equals",e),a=N.eqFn(i);return r.mapOneToOne(function(t){try{return a(t,o)?S.integer.fromNumber(r.position):null}catch(e){return null}})},innermost:function(t){var e=[];return t[0].forEachItem(function(t){e.length>0&&E.ancestor(t).some(function(t){return t==e[e.length-1]})&&e.pop(),e.push(t)}),A.ForArray(e)},"in-scope-prefixes":function(t){var e=t[0].next();return A.ForArray(I.inScopeNamespaces(e).map(function(t){return S.string.fromString(t.prefix)}))},"insert-before":function(t){var e=t[1].next().value,n=t[2],r=A.Tracker(t[0]);return 1>e?A.Join([n,r]):e>r.last()?A.Join([r,n]):r.mapOneToMany(function(n){return r.position==e?A.Join([t[2],A.Singleton(n)]):A.Singleton(n)})},"iri-to-uri":function(t){return f(t,function(t,e){return 32>=t||t>126||/[<>"{}|\\\^`]/.test(e)})},"json-doc":function(t,e,n){var r=u(t,e,n);if(!r)return A.Empty;var o=i(r,e),a=t[1]?t[1].next():null;return A.Singleton(U.parseToMap(o,a))},"json-to-xml":function(t,e,n){var r=t[0].next();if(!r)return A.Empty;var o=t[1]?t[1].next():null,i=U.parseToXml(r.toString(),o,e),a=e.resultDocument.createDocumentFragment();return a.appendChild(i),a._saxonBaseUri=F.staticBaseUri(n,e),A.Singleton(a)},key:function(t,e,n){function o(t){return{visibility:"PRIVATE",decl:t,pack:a,actor:t,bindings:t.getAttribute("binds").split(" ").map(function(t){return parseInt(t)})}}var i=l(t[0],n,"XTDE1260"),a=C.declaringPackage(n,e),u=a.keys[i];if(!u)throw r("Unknown key "+i,"XTDE1280");var s,c;if(t[2])s=t[2].next(),I.isNode(s)&&(c=I.ownerDocument(s));else{var f=e.getCurrentFocus();I.isNode(f)&&(s=I.ownerDocument(f),c=s)}if(!c||c.nodeType!==I.DOCUMENT_NODE&&c.nodeType!==I.DOCUMENT_FRAGMENT_NODE)throw new r("No containing document for key()","XTDE1270",n);"_saxonIndexes"in c||(c._saxonIndexes={});var m=c._saxonIndexes,p=m[i];if(!p){var h=N.getCollation(u[0],null,e);p=N.trieWithCollation(h),m[i]=p;for(var g=0;g<u.length;g++){var d,v=u[g],y=I.getChildElements(v)[0],S=e.newContext(!0);if(S.currentComponent=o(v),S.focus=A.Solo(c),"p.nodeSet"==y.tagName)d=F.evaluate(I.getChildElements(y)[0],S);else{var x=D(y),b=v.hasAttribute("flags")?v.getAttribute("flags"):"";d=E.descendantOrSelf(c);var w=-1!=b.indexOf("a"),O=-1!=b.indexOf("n");if(w||O){var _;_=w&&O?function(t){return A.Join([E.namespace(t),E.attribute(t)])}:w?function(t){return E.attribute(t)}:function(t){return E.namespace(t)},d=d.mapOneToMany(_)}d=d.filter(function(t){return S.focus=A.Solo(c),x(t,S)})}var M=I.getChildElements(v)[1],k=e.newContext(!0);k.currentComponent=o(v);for(var P;null!==(P=d.next());){k.focus=A.Solo(P);for(var U,R=F.evaluate(M,k);null!==(U=R.next());)if(!N.itemIsNaN(U))if(p.containsKey(U)){var B=p.get(U);-1==B.indexOf(P)&&(p.get(U).push(P),u.length>1&&p.get(U).sort(T.compareDocumentOrder))}else p.inSituPut(U,[P])}}}var X=t[1];return X.mapOneToMany(function(t){if(p.containsKey(t)){var e=A.ForArray(p.get(t));return c==s?e:e.filter(function(t){return null!==E.ancestorOrSelf(t).filter(function(t){return t==s}).next()})}return A.Empty})},lang:function(t,e){var n=t[1]?t[1].next():e.getCurrentFocus();if(!n)throw new r("No context item for lang()","XPDY0002");if(!I.isNode(n))throw new r("Context item is not a node in lang()","XPTY0004");var o=h(t[0]).toLowerCase(),i=E.ancestorOrSelf(n).filter(function(t){return t.nodeType==I.ELEMENT_NODE&&t.hasAttribute("xml:lang")}),a=i.next();if(!a)return A.oneBoolean(!1);var u=a.getAttribute("xml:lang").toLowerCase(),s=o==u||u.length>o.length+1&&u.substring(0,o.length)==o&&"-"==u.charAt(o.length);return A.oneBoolean(s)},last:function(t,e){if(e.noCurrentFocus())throw new r("No context item for last()","XPDY0002");return A.oneInteger(e.focus.last())},"load-xquery-module":function(){throw new r("No XQuery processor available","FOQM0006")},"local-name":function(t){var e=I.nameOfNode(t[0].next());return A.oneString(e?e.local:"")},"local-name-from-QName":function(t){var e=t[0].next();return null===e?A.Empty:A.Singleton(S.NCName.fromString(e.local))},"lower-case":function(t){return A.oneString(h(t[0]).toLowerCase())},matches:function(t){var e=h(t[0]),n=t[1].next().toString(),o=t[2]?t[2].next().toString():"";if(!o.match(/^[smijxq]*$/))throw new r("Illegal flags for regular expression: "+o,"FORX0001");
var i=_.prepareRegex(n,o,e);return A.oneBoolean(e.search(i)>=0)},max:y("max"),min:y("min"),"minutes-from-dateTime":function(t){return x(t,"getUTCMinutes")},"minutes-from-duration":function(t){return b(t,4)},"minutes-from-time":function(t){return x(t,"getUTCMinutes")},"month-from-date":function(t){return x(t,"getUTCMonth")},"month-from-dateTime":function(t){return x(t,"getUTCMonth")},"months-from-duration":function(t){return b(t,1)},name:function(t){var e=I.nameOfNode(t[0].next());return A.oneString(e?e.toString():"")},"namespace-uri":function(t){var e=I.nameOfNode(t[0].next());return A.Singleton(S.anyURI.fromString(e?e.uri:""))},"namespace-uri-for-prefix":function(t){var e=h(t[0]),n=t[1].next(),r="xml"==e?C.KNOWN_URI.xml:n.lookupNamespaceURI(""==e?null:e);return r?A.Singleton(S.anyURI.fromString(r)):A.Empty},"namespace-uri-from-QName":function(t){var e=t[0].next();return null===e?A.Empty:A.Singleton(S.anyURI.fromString(e.uri))},nilled:function(t){var e=t[0].next();return e&&e.nodeType==I.ELEMENT_NODE?A.oneBoolean(!1):A.Empty},"node-name":function(t){return A.Singleton(I.nameOfNode(t[0].next()))},"normalize-space":function(t){var e=h(t[0]);return A.oneString(C.wsCollapse(e))},"normalize-unicode":function(t){if(String.prototype.normalize){var e=h(t[0]),n=t[1].next().toString().toUpperCase().trim();if("NFC"==n||"NFD"==n||"NFKC"==n||"NFKD"==n)return A.oneString(e.normalize(n));if(""===n)return A.oneString(e)}throw new r("normalize-unicode(): not supported on this Javascript platform","FOCH0003")},not:function(t){return A.oneBoolean(!F.ebv(t[0]))},number:function(t){return A.Singleton(S.numeric.numberFn(t[0].next()))},"one-or-more":function(t){var e=A.LookAhead(t[0]);if(null===e.peek())throw new r("Required length >= 1, actual length zero","FORG0004");return e},outermost:function(t,e,n){var r=F.hasFlag(n,"p"),o=t[0];r||(o=I.inDocumentOrder(o));var i=null;return o.filter(function(t){return null===i?(i=t,!0):null===E.ancestor(t).filter(function(t){return t===i}).next()?(i=t,!0):!1})},"parse-ietf-date":function(t){return t[0].mapOneToOne(function(t){var e=function(){throw new r("Invalid IETF date/time "+t.toString(),"FORG0010")},n=function(t){return 1==t.length?"0"+t:t},o=t.toString().trim().toLowerCase();o=o.replace(/^(monday|tuesday|wednesday|thursday|friday|saturday|sunday|mon|tue|wed|thu|fri|sat|sun),?\s+/,"");var i,a,u,s,c,l,f;/^[a-z]/.test(o)?(i=/^([a-z]{3})(?:\s*\-\s*|\s+)(\d\d\d?\d?)\s+([\d:\.]+)\s*([a-z]+|[+\-]\d\d?:?(?:\d\d)?(?:\s*\(\s*[a-z]+\s*\))?)?\s+(\d+)$/,a=i.exec(o),null!==a?(u=a[1],s=a[2],l=a[3],f=a[4],c=a[5]):e()):(i=/^(\d+)(?:\s*\-\s*|\s+)([a-z]{3})(?:\s*\-\s*|\s+)(\d\d\d?\d?)\s+([\d:\.]+)\s*([a-z]+|[+\-]\d\d?:?(?:\d\d)?(?:\s*\(\s*[a-z]+\s*\))?)?$/,a=i.exec(o),null!==a?(s=a[1],u=a[2],c=a[3],l=a[4],f=a[5]):e()),2==c.length&&(c="19"+c);var m="jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec".indexOf(u);0>m&&e();var p={ut:"Z",utc:"Z",gmt:"Z",est:"-05:00",edt:"-04:00",cst:"-06:00",cdt:"-05:00",mst:"-07:00",mdt:"-06:00",pst:"-08:00",pdt:"-07:00"};if(/^[0-9]:/.test(l)&&(l="0"+l),5==l.length&&(l+=":00"),f){var h=/([a-z]+)|([+\-]\d\d?:?(?:\d\d)?)(?:\s*\(\s*([a-z]+)\s*\))?$/.exec(f);(h[3]&&!(h[3]in p)||h[1]&&!(h[1]in p))&&e(),f=h[1]?h[1]:h[2],/^[+\-][0-9]((:|$)|[0-9]{2}$)/.test(f)&&(f=f.substring(0,1)+"0"+f.substring(1)),f in p?f=p[f]:3==f.length?f+=":00":4==f.length?f+="00":5==f.length&&(f=f.substring(0,3)+":"+f.substring(3))}var g=c+"-"+n((m/4+1).toString())+"-"+n(s)+"T"+l+(f||"Z");return S.dateTime.fromString(g)})},"parse-json":function(t){var e=t[0].next().toString(),n=t[1]?t[1].next():null;return A.Singleton(U.parseToMap(e,n))},"parse-xml":function(t,e,n){var o=t[0].next().toString();try{var i=SaxonJS.getPlatform().parseXmlFromString(o);return i._saxonBaseUri=F.staticBaseUri(n,e),A.Singleton(i)}catch(a){throw new r("Misplaced or malformed XML:","FODC0006")}},"parse-xml-fragment":function(t,e,n){return t[0].mapOneToOne(function(t){var r=/^<\?xml(?:\s+version\s*=\s*(['"])1.[0-9]+['"])?\s+encoding\s*=\s*(['"][A-Za-z](?:[A-Za-z0-9._\-])*)['"]\s*\?>/,o=t.toString().replace(r,""),i=SaxonJS.getPlatform().parseXmlFromString("<z>"+o+"</z>"),a=e.resultDocument.createDocumentFragment();return E.child(i.documentElement).forEachItem(function(t){a.appendChild(t)}),a._saxonBaseUri=F.staticBaseUri(n,e),a})},path:function(t){return t[0].mapOneToOne(function(t){var e="";return E.ancestorOrSelf(t).forEachItem(function(t){var n,r=function(t){return E.precedingSibling(t).filter(function(e){return t.nodeType==e.nodeType})},o=function(t){return 1+r(t).count()};switch(t.nodeType){case I.DOCUMENT_NODE:case I.DOCUMENT_FRAGMENT_NODE:break;default:break;case I.ELEMENT_NODE:n=I.nameOfNode(t),e="/"+n.toEQName()+"["+(1+r(t).filter(function(t){return I.nameOfNode(t).equals(n)}).count())+"]"+e;break;case I.TEXT_NODE:e="/text()["+o(t)+"]";break;case I.COMMENT_NODE:e="/comment()["+o(t)+"]";break;case I.PROCESSING_INSTRUCTION_NODE:e="/processing-instruction("+t.target+")["+(1+r(t).filter(function(e){return t.target==e.target}).count())+"]";break;case I.ATTRIBUTE_NODE:e="/@"+(t.name.indexOf(":")<0?t.name:I.nameOfNode(t).toEQName());break;case I.NAMESPACE_NODE:e="/namespace::"+(""!==t.prefix?t.prefix:"*[Q{"+C.KNOWN_URI.fn+'}local-name()=""]')}}),""===e&&(e="/"),S.string.fromString(e)})},"prefix-from-QName":function(t){return t[0].mapOneToOne(function(t){return""===t.prefix?null:S.NCName.fromString(t.prefix)})},position:function(t,e){if(e.noCurrentFocus())throw new r("No context item for position()","XPDY0002");return A.oneInteger(e.focus.position)},QName:function(t){var e=t[1].next().value.split(":"),n=2==e.length?e[0]:"",o=h(t[0]);if(""!==n&&""===o)throw new r("Prefix but no URI for QName()","FOCA0002");if(2==e.length&&""===n||""!==n&&!_.isNCName(n))throw new r("$paramQName not valid for QName()","FOCA0002");var i=2==e.length?e[1]:e[0];if(!_.isNCName(i))throw new r("$paramQName not valid for QName()","FOCA0002");return A.Singleton(S.QName.fromParts(n,o,i))},"regex-group":function(t,e){var n=t[0].next().toNumber();try{return A.oneString(e.focus.regexGroups[n]||"")}catch(r){return A.oneString("")}},remove:function(t){var e=t[1].next().toNumber(),n=A.Tracker(t[0]);return n.filter(function(t){return n.position!=e})},replace:function(t){var e=h(t[0]),n=t[3]?t[3].next().toString():"";if(!n.match(/^[smijxq]*$/))throw new r("Illegal flags for regular expression: "+n,"FORX0001");var o=_.prepareRegex(t[1].next().toString(),n+"g");if(o.test(""))throw new r("Regular expression matches zero-length string","FORX0003");var i=_.convertReplacement(t[2].next().toString(),n);return A.oneString(e.replace(o,i))},"resolve-QName":function(t){var e=t[1].next();return t[0].mapOneToOne(function(t){try{return I.resolveLexicalQName(e,t.toString(),!0)}catch(n){throw n instanceof r&&"FORG0001"==n.code&&(n.code=_.isQName(t)?"FONS0004":"FOCA0002"),n}})},"resolve-uri":function(t,e,n){var o=t[1]?t[1].next().toString():F.staticBaseUri(n,e),i=t[0].next();if(null===i)return A.Empty;o=o.replace(/^file:\/(?!\/)/,"file:///"),i=i.toString();var a=T.isAbsoluteURI(i);if(!a&&!T.isAbsoluteURI(o))throw new r("resolve-uri: invalid URI (base="+o+", relative="+i+")","FORG0002");if(!SaxonJS.getPlatform().inBrowser&&/#/.test(o))throw new r("Base URI "+o+" contains a fragment identifier","FORG0002");var u;try{u=a?i:SaxonJS.getPlatform().resolveUri(i,o).toString()}catch(s){throw s}return A.Singleton(S.anyURI.fromString(u))},reverse:function(t){return A.ForArray(t[0].expand().slice().reverse())},root:function(t){return t[0].mapOneToMany(function(t){return E.ancestorOrSelf(t)}).filter(function(t){return null===I.xdmParentNode(t)})},round:function(t){return t[0].mapOneToOne(function(e){return e.round(t[1]?t[1].next().value:0)})},"round-half-to-even":function(t){return t[0].mapOneToOne(function(e){return e.roundHalfToEven(t[1]?t[1].next().value:0)})},"seconds-from-dateTime":function(t){return x(t,"seconds")},"seconds-from-duration":function(t){return b(t,5)},"seconds-from-time":function(t){return x(t,"seconds")},serialize:function(t){return A.oneString(F.serialize(t[0],t[1]?t[1]:void 0))},snapshot:function(t,e,n){return t[0].mapOneToOne(function(t){var n=I.copyItem(t,e,"cm"),r=n;return E.ancestor(t).forEachItem(function(t){var n=I.shallowCopy(t,e,"c",function(){return A.Empty}).next();E.attribute(t).forEachItem(function(t){var e=""===t.namespaceURI?null:t.namespaceURI;n.setAttributeNS(e,t.name,t.value)}),n._saxonOriginal=t,n.appendChild(r),r=n}),n})},"starts-with":function(t,e,n){var r=h(t[0]),o=h(t[1]),i=N.getCollatingFn(n,t[2],"startsWith",e);return A.oneBoolean(i(r,o))},"static-base-uri":function(t,e,n){return A.oneString(F.staticBaseUri(n,e))},"stream-available":function(){return A.oneBoolean(!1)},string:function(t){var e=t[0].next();if(!e)return A.oneString("");if(F.isArray(e)||F.isMap(e))throw new r("Input to string() is a function item ","FOTY0014");return F.atomize(e).mapOneToOne(function(t){return S.string.cast(t)})},"string-join":function(t){for(var e,n="",r=t[1]?t[1].next().value:"",o=!0;null!==(e=t[0].next());)o||(n+=r),n+=e.toString(),o=!1;return A.oneString(n)},"string-length":function(t){return A.oneInteger(g(t[0]).length)},"string-to-codepoints":function(t){return A.ForArray(g(t[0]).map(S.integer.fromNumber))},subsequence:function(t){return A.ForArray(d(t[0].expand(),t[1],t[2]))},substring:function(t){var e=g(t[0]);return A.oneString(F.codepointsToString(d(e,t[1],t[2])))},"substring-after":function(t,e,n){var r,o="",i=h(t[0]),a=h(t[1]),u=N.getCollatingFn(n,t[2],"indexOf",e);return-1!=(r=u(i,a))&&(o=i.substring(r+a.length)),A.oneString(o)},"substring-before":function(t,e,n){var r,o="",i=h(t[0]),a=h(t[1]),u=N.getCollatingFn(n,t[2],"indexOf",e);return-1!=(r=u(i,a))&&(o=i.substring(0,r)),A.oneString(o)},sum:function(t){var e=t[0].mapOneToOne(F.untypedToDouble),n=e.next();return null===n?1==t.length?A.oneInteger(0):t[1]:(M["a+a"](n,n),A.Singleton(v(e,n,M["a+a"])))},"system-property":function(t,e,n){var r,o=S.QName.fromEQName(l(t[0],n,"XTDE1390"));return o.uri==C.KNOWN_URI.xsl&&(r=P[o.local]),A.oneString(r||"")},tail:function(t){var e=A.Tracker(t[0]);return e.filter(function(){return 1!=e.position})},"timezone-from-date":function(t){return x(t,"timezone")},"timezone-from-dateTime":function(t){return x(t,"timezone")},"timezone-from-time":function(t){return x(t,"timezone")},tokenize:function(t){var e=h(t[0]);if(t[1]||(e=C.wsCollapse(e)),""===e)return A.Empty;var n=t[1]?t[1].next().toString():"[ \\n\\r\\t]+",r=C.analyze(e,n,t[2]?t[2].next().toString():"",!1,!0),o=t[1]&&r[0].matching,i=r[r.length-1],a=t[1]&&i.matching,u=r.filter(function(t){return!t.matching}),s=u.map(function(t){return t.string});return o&&s.unshift(S.string.fromString("")),a&&s.push(S.string.fromString("")),A.ForArray(s)},trace:function(e){var n=e[0].expand();return a((e[1]?e[1].next().toString()+": ":"")+t(n)),A.ForArray(n)},transform:function(t,e,n){var r,o=t[0].next(),i=A.oneString("stylesheet-node"),a=A.oneString("source-node"),u=A.oneString("initial-template"),s=A.oneString("initial-mode"),c=A.oneString("stylesheet-parameters"),l=document.implementation.createDocument(null,null,null);r=A.ForArray(o.get(i.next())).peek().cloneNode(!0),r instanceof XMLDocument&&(r=r.documentElement),l.appendChild(r);var f=null,m=A.ForArray(o.get(a.next())).peek();if(null!=m)if(f=document.implementation.createDocument(null,null,null),f._saxonBaseUri=m._saxonBaseUri,m instanceof XMLDocument)for(var p=m.childNodes,h=0;h<p.length;h++)f.appendChild(p[h].cloneNode(!0));else r=m.cloneNode(!0),f.appendChild(r);var g=A.ForArray(o.get(u.next())).peek();null!=g&&(o.initialTemplate=g.toString());var d=A.ForArray(o.get(s.next())).peek();null!=d&&(o.initialMode=d.toString()),o.stylesheetParams={};var v=A.ForArray(o.get(c.next())).peek();null!=v&&(o.stylesheetParams=C.convertToJS(v)),o.isDynamicStylesheet=!0;SaxonJS.internalTransform(l,f,o);return SaxonJS.U.Iter.Singleton(o.principalResult)},translate:function(t){var e=g(t[0]),n=g(t[1]),r=g(t[2]),o=[];return e.forEach(function(t){var e;-1!=(e=n.indexOf(t))?e<r.length&&o.push(r[e]):o.push(t)}),A.oneString(F.codepointsToString(o))},"true":function(){return A.oneBoolean(!0)},"type-available":function(t,e,n){var r=l(t[0],n,"XTDE1428").split("}");return A.oneBoolean("Q{http://www.w3.org/2001/XMLSchema"==r[0]&&r[1]in S)},unordered:function(t){return t[0]},"unparsed-entity-public-id":function(){return A.Empty},"unparsed-entity-uri":function(){return A.Empty},"unparsed-text":function(t,e,n){return A.oneString(s(t,e,n))},"unparsed-text-available":function(t,e,n){return c(function(){s(t,e,n)})},"unparsed-text-lines":function(t,e,n){var r=s(t,e,n),o=r.split(/\r?\n|\r/);return o.length>0&&""==o[o.length-1]&&(o.length-=1),A.ForArray(o).mapOneToOne(function(t){return S.string.fromString(t)})},"upper-case":function(t){return A.oneString(h(t[0]).toUpperCase())},"uri-collection":function(){return A.Empty},"xml-to-json":function(t){var e=t[1]?t[1].next():new w;return t[0].mapOneToOne(function(t){return S.string.fromString(U.xmlToJson(t,e))})},"year-from-date":function(t){return x(t,"getUTCFullYear")},"year-from-dateTime":function(t){return x(t,"getUTCFullYear")},"years-from-duration":function(t){return b(t,0)},"zero-or-one":function(t){var e=t[0].expand();if(e.length>1)throw new r("Required length 0-1, actual length "+e.length,"FORG0003");return A.Singleton(e[0]?e[0]:null)}}}(),I=function(){"use strict";var t=function(t,e,n,o){function i(t){return null===t?(c=!0,Number.NaN):t.toNumber()}function a(){return i(C.evalChild1(o,n).next())}function u(){return i(C.evalChild2(o,n).next())}function s(){switch(t){case"pi":return Math.PI;case"exp":return Math.exp(a());case"exp10":return Math.pow(10,a());case"log":return Math.log(a());case"log10":return Math.log(a())/Math.LN10;case"pow":var e=a(),n=u();return-1==e&&(n==1/0||n==-(1/0))||1==e?1:Math.pow(e,n);case"sqrt":return Math.sqrt(a());case"sin":return Math.sin(a());case"cos":return Math.cos(a());case"tan":return Math.tan(a());case"asin":return Math.asin(a());case"acos":return Math.acos(a());case"atan":return Math.atan(a());case"atan2":return Math.atan2(a(),u());default:throw r("Unknown math function "+o.getAttribute("name"),"XPST0017",o)}}var c=!1,l=s();return c?A.Empty:A.oneDouble(l)},e=function(t,e,n,o){var i={contains:function(t){var e=t[0].next(),n=t[1].next();return A.oneBoolean(e.containsKey(n))},create:function(t){var e=new w;return t[0].forEachItem(function(t){t.forAllPairs(function(t){e.inSituPut(t.k,t.v)})}),A.Singleton(e)},entry:function(t){var e=new w;return e.inSituPut(t[0].next(),t[1].expand()),A.Singleton(e)},find:function(t){function e(t){C.isArray(t)?t.value.forEach(n):C.isMap(t)&&(t.containsKey(o)&&r.push(t.get(o)),t.keys().forEach(function(e){n(t.get(e))}))}function n(t){t.forEach(e)}var r=[],o=t[1].next();return n(t[0].expand()),A.Singleton(new C.XdmArray(r))},get:function(t){var e=t[0].next(),n=t[1].next();return A.ForArray(e.get(n))},keys:function(t){var e=t[0].next();return A.ForArray(e.keys())},merge:function(t){var e=new w,n=t[1]?t[1].next():null;return t[0].forEachItem(function(t){t.forAllPairs(function(t){var i=S.string.fromString("duplicates"),a=n&&n.containsKey(i)?n.get(i).toString():"use-first";if(e.containsKey(t.k)&&"use-last"!=a&&"unspecified"!=a&&"use-any"!=a){if("reject"==a){var u=S.string.fromString("duplicates-error-code"),s=n.containsKey(u)?n.get(u).toString():"FOJS0003";throw r("Duplicate key value '"+t.k.toString()+"'",s,o)}if("combine"==a){var c=e.get(t.k);t.v.forEach(function(t){c.push(t)}),e.inSituPut(t.k,c)}}else e.inSituPut(t.k,t.v)})}),A.Singleton(e)},_new:function(t){var e=new w;return t[0]&&t[0].forEachItem(function(t){t.forAllPairs(function(t){if(e.containsKey(t.k))throw r("Duplicate key value '"+t.k.toString()+"'","XQDY0137",o);e.inSituPut(t.k,t.v)})}),A.Singleton(e)},put:function(t){var e=t[0].next(),n=t[1].next(),r=t[2].expand();return A.Singleton(e.put(n,r))},remove:function(t){var e=t[0].next();return t[1].forEachItem(function(t){e=e.remove(t)}),A.Singleton(e)},size:function(t){var e=t[0].next(),n=0;return e.forAllPairs(function(){n++}),A.oneInteger(n)},"untyped-contains":function(t){var e=t[0].next(),n=t[1].next();return A.oneBoolean(e.containsKey(n))}};if(!i[t])throw r("Unknown map function: "+t,"SXJS0003",o);return i[t](e,n,o)},n=function(t,e,n,o){function i(t,e){if(1>t||t>e)throw r("Array index ("+t+") out of bounds (1 to "+e+")","FOAY0001",o)}function a(t){return t[0].next().value}function u(t){return t[1].next().toNumber()}function s(t){return A.Singleton(new C.XdmArray(t))}var c={append:function(t){return s(a(t).concat([t[1].expand()]))},flatten:function(t){return C.flatten(t[0])},"_from-sequence":function(t){var e=[];return t[0].forEachItem(function(t){e.push([t])}),s(e)},get:function(t){var e=a(t),n=u(t);return i(n,e.length),A.ForArray(e[n-1])},head:function(t){var e=a(t);return i(1,e.length),A.ForArray(e[0])},"insert-before":function(t){var e=a(t),n=u(t);i(n,e.length+1);var r=t[2].expand();return s(e.slice(0,n-1).concat([r]).concat(e.slice(n-1)))},join:function(t){var e=[];return t[0].forEachItem(function(t){t.value.forEach(function(t){e.push(t)})}),s(e)},put:function(t){var e=a(t),n=u(t);i(n,e.length);var r=t[2].expand();return s(e.slice(0,n-1).concat([r]).concat(e.slice(n)))},remove:function(t){var e=a(t),n=[];return t[1].forEachItem(function(t){var r=t.toNumber();i(r,e.length),n.push(r-1)}),s(e.filter(function(t,e){return n.indexOf(e)<0}))},reverse:function(t){return s(a(t).slice().reverse())},size:function(t){return A.oneInteger(a(t).length)},sort:function(t){function e(e,n){var o=function(t){return A.ForArray(t).mapOneToMany(C.atomize)};return t[1]?N.lexicographicCompare(o(e),o(n),r):N.lexicographicCompare(o(e),o(n))}var r=N.getCollation(o,t[1],n);return s(a(t).slice().sort(e))},subarray:function(t){var e=a(t),n=u(t);i(n,e.length+1);var o=t[2]?t[2].next().toNumber():e.length-n+1;return r.test(0>o,"Length is negative","FOAY0002"),i(n+o,e.length+1),s(e.slice(n-1,n+o-1))},tail:function(t){var e=a(t);return i(1,e.length),s(e.slice(1))},"_to-sequence":function(t){var e=[];return a(t).forEach(function(t){t.forEach(function(t){e.push(t)})}),A.ForArray(e)}};if(!c[t])throw r("Unknown array function: "+t,"SXJS0003",o);return c[t](e,n,o)},o=function(t,e,n,o){function i(t,e){for(var n=t,i=0;i<e.length;i++){try{n=n[e[i]]}catch(a){if(null!==a.code)throw a;throw r("Failed to get property "+e[i],"SXJS0007",o)}if("undefined"==typeof n)return void 0}return n}function u(t,e,n){var i;try{i=t.apply(n,e)}catch(a){if(null!==a.code)throw a;throw r("Failed to call method "+t,"SXJS0007",o)}if(null===i||"undefined"==typeof i)return A.Empty;var u=C.convertFromJS(i);return Array.isArray(u)?A.ForArray(u):A.Singleton(u)}function s(t){return t instanceof C.JSValue?t.value:t}var c={apply:function(t){var e=s(t[0].next());if("function"!=typeof e)throw r("ixsl:apply: first argument is not a function","SXJS0007",o);var n=C.convertToJS(t[1].next());return u(e,n,null)},call:function(t){var e=s(t[0].next()),n=t[1].next().toString(),a=n.split("."),c=i(e,a);if("undefined"==typeof c)throw r("ixsl:call: object method '"+n+"' not found","SXJS0007",o);if("function"!=typeof c)throw r("ixsl:call: property '"+n+"' is not a function","SXJS0007",o);var l=C.convertToJS(t[2].next());return u(c,l,e)},eval:function(t){var e=t[0].next().toString(),n=new Function("return "+e);return A.Singleton(C.convertFromJS(n()))},event:function(t,e){return A.Singleton(C.convertFromJS(e.currentEvent))},get:function(t){var e=s(t[0].next()),n=t[1].next().toString(),r=n.split("."),o=i(e,r);return"undefined"==typeof o?(a("Warning ixsl:get: object property '"+n+"' not found"),A.Empty):A.Singleton(C.convertFromJS(o))},location:function(){return A.Singleton(C.convertFromJS(window.location.toString()))},page:function(){return A.Singleton(C.convertFromJS(window.document))},"query-params":function(){for(var t,e=/\+/g,n=/([^&=]+)=?([^&]*)/g,r=function(t){return S.string.fromString(decodeURIComponent(t.replace(e," ")))},o=window.location.search.substring(1),i=new w;null!==(t=n.exec(o));){var a=i.get(r(t[1]));a.push(r(t[2])),i.inSituPut(r(t[1]),a)}return A.Singleton(i)},source:function(t,e){return A.Singleton(C.convertFromJS(e.fixed.globalContextItem))},style:function(t){var e=t[0].next(),n=window.getComputedStyle(e);return A.Singleton(C.convertFromJS(n))},window:function(){return A.Singleton(C.convertFromJS(window))},"remove-attribute":function(t,e,n){var o=t[0].next().toString(),i=S.QName.fromString(o,C.stylesheetResolver(n,!1));if(e.noCurrentFocus())throw r("No context item for ixsl:remove-attribute","SXJS0007",n);var a=e.getCurrentFocus();if(a.ownerDocument!=window.document)throw r("Context item for ixsl:remove-attribute must be an element in the HTML page","SXJS0007",n);return a.removeAttribute(i.local),A.Empty},"schedule-action":function(){throw r("ixsl:schedule-action - shouldn't be here","SXJS0007",o)},"set-attribute":function(t,e,n){var o=t[0].next().toString(),i=t[1].next().toString(),a=S.QName.fromString(o,C.stylesheetResolver(n,!1));if(null===a)throw r("Invalid attribute name "+o,"XTDE1260");if(e.noCurrentFocus())throw r("No context item for ixsl:set-attribute","SXJS0007",n);var u=e.getCurrentFocus();if(u.ownerDocument!=window.document)throw r("Context item for ixsl:set-attribute must be an element in the HTML page","SXJS0007",n);return u.setAttribute(a.local,i),A.Empty},"set-property":function(t,e,n){var r=t[0].next().toString(),o=C.convertToJS(t[1].next()),u=s(t[2].next()),c=r.split("."),l=c.pop(),f=i(u,c);return"undefined"==typeof f||""===f?(a("Warning ixsl:set-property: '"+r+"' not found for supplied object"),A.Empty):(f[l]=o,A.Empty)},"set-style":function(t,e,n){var o=t[0].next().toString(),i=C.convertToJS(t[1].next()),a=t[2]?t[2].next():e.getCurrentFocus();if(!a)throw r("No context item for ixsl:set-style","SXJS0007",n);return a.style[o]=i,A.Empty}};if(!c[t])throw r("Unknown ixsl function: "+t,"SXJS0003",o);return c[t](e,n,o)},i=function(t,e,n,o){var i={apply:F.apply,"compile-XPath":function(t){var e,r,i=t[0].next().toString();t.length>1&&(e=t[1].next(),e=null!=e?C.convertToJS(e):{}),t.length>2&&(r=t[2]);var a=SaxonJS.XPath.compile(i,e,r,o,n);return a},doc:F.doc,"dynamic-error-info":function(t){var e=n.currentError;if(null===e)return A.Empty;var o=t[0].next().toString();switch(o){case"description":return A.oneString(e.message);case"code":return A.Singleton(S.QName.fromParts("err","http://www.w3.org/2005/xqt-errors",e.code));case"value":return A.Empty;case"module":return A.oneString(e.xsltModule);case"line-number":return A.oneInteger(e.xsltLineNr);case"column-number":return A.oneInteger(-1);default:throw r("unknown error info field "+o,"SXJS0003")}},"parse-XPath":function(t){var e,n=t[0].next().toString(),r="parse";t.length>1&&(r=t[1].next().toString()),t.length>2&&(e=t[2]);var o=SaxonJS.XPath.parse(n,r,e);return o}};if(!i[t])throw r("Unknown saxon function: "+t,"SXJS0003",o);return i[t](e,n,o)};return function(a,u,s,c,l){switch(a){case C.KNOWN_URI.fn+"/math":return t(u,s,c,l);case C.KNOWN_URI.fn+"/map":return e(u,s,c,l);case C.KNOWN_URI.fn+"/array":return n(u,s,c,l);case C.KNOWN_URI.ixsl:return o(u,s,c,l);case C.KNOWN_URI.saxon:return i(u,s,c,l);default:throw r("Unknown namespace "+a,"SXJS0003",l)}}}(),M=function(){"use strict";function t(t){return Math.abs(t)<Math.pow(2,52)}function e(t,e){return s.matches(t)&&s.matches(e)?s:u}function n(t){throw new r("Division by zero",t?t:"FOAR0001")}function o(t,e,n){throw new r("Arithmetic operation '"+n+"' not available for operands "+t.type+" and "+e.type,"XPTY0004")}function i(t,e,n){function r(t){return S.dateTime.matches(t)||S.date.matches(t)||S.time.matches(t)}var i,f,m,p=S.dayTimeDuration,h=S.yearMonthDuration;return(p.matches(t)||h.matches(t))&&S.numeric.matches(e)?(m="u"+n+"n",i=t.type,f=e.type):(p.matches(e)||h.matches(e))&&S.numeric.matches(t)?(m="n"+n+"u",i=t.type,f=e.type):s.matches(t)&&s.matches(e)?(m="i"+n+"i",i=f="integer"):a.matches(t)||a.matches(e)?(m="d"+n+"d",i=f="double"):c.matches(t)||c.matches(e)?(m="f"+n+"f",i=f="float"):u.matches(t)||u.matches(e)?(m="c"+n+"c",i=f="decimal"):r(t)&&r(e)?(m="t"+n+"t",i=t.type,f=e.type):r(t)&&(p.matches(e)||h.matches(e))?(m="t"+n+"u",i=t.type,f=e.type):(p.matches(t)||h.matches(t))&&r(e)?(m="u"+n+"t",i=t.type,f=e.type):p.matches(t)&&p.matches(e)||h.matches(t)&&h.matches(e)?(m="u"+n+"u",i=f=t.type):o(n,t,e),l[m]||o(n,t,e),l[m](C.promote(t,i),C.promote(e,f))}var a=S["double"],u=S.decimal,s=S.integer,c=S["float"],l={"d+d":function(t,e){var n=t.toNumber(),r=e.toNumber();return a.fromNumber(n+r)},"d-d":function(t,e){var n=t.toNumber(),r=e.toNumber();return a.fromNumber(n-r)},"d*d":function(t,e){var n=t.toNumber(),r=e.toNumber();return a.fromNumber(n*r)},"d/d":function(t,e){var n=t.toNumber(),r=e.toNumber();return a.fromNumber(n/r)},"d%d":function(t,e){var n=t.toNumber(),r=e.toNumber();return isNaN(n)||isNaN(r)||n==1/0||n==-(1/0)||0===r?a.fromNumber(NaN):r==1/0||r==-(1/0)||0===n?t:a.fromNumber(n%r)},"d~d":function(e,r){try{var o=e.toNumber(),i=r.toNumber(),u=a.fromNumber(Math.trunc(o/i));return(u==1/0||u==-(1/0)||isNaN(u))&&n(),t(u)?s.fromNumber(u):u}catch(c){n()}},"f+f":function(t,e){var n=t.toNumber(),r=e.toNumber();return c.fromNumber(n+r)},"f-f":function(t,e){var n=t.toNumber(),r=e.toNumber();return c.fromNumber(n-r)},"f*f":function(t,e){var n=t.toNumber(),r=e.toNumber();return c.fromNumber(n*r)},"f/f":function(t,e){var n=t.toNumber(),r=e.toNumber();return c.fromNumber(n/r)},"f%f":function(t,e){var r=t.toNumber(),o=e.toNumber();if(isNaN(r)||isNaN(o)||r==1/0||r==-(1/0)||0===o)return c.fromNumber(NaN);if(o==1/0||o==-(1/0)||0===r)return t;var i=c.fromNumber(r%o);return(i==1/0||i==-(1/0)||isNaN(i))&&n(),i},"f~f":function(e,r){try{var o=e.toNumber(),i=r.toNumber(),a=c.fromNumber(Math.trunc(o/i));return(a==1/0||a==-(1/0)||isNaN(a))&&n(),t(a)?s.fromNumber(a):a}catch(u){n()}},"i+i":function(e,n){var r=e.toNumber()+n.toNumber();return t(r)?s.fromNumber(r):s.fromBig(Big(e.toBig().plus(n.toBig())))},"i-i":function(e,n){var r=e.toNumber()-n.toNumber();return t(r)?s.fromNumber(r):s.fromBig(Big(e.toBig().minus(n.toBig())))},"i*i":function(e,n){var r=e.toNumber()*n.toNumber();return t(r)?s.fromNumber(r):s.fromBig(Big(e.toBig().times(n.toBig())))},"i/i":function(t,e){try{var r=t.toBig(),o=e.toBig();return u.fromBig(r.div(o))}catch(i){n()}},"i%i":function(e,r){var o=e.toNumber(),i=r.toNumber();if(isNaN(o)||isNaN(i)||o==1/0||o==-(1/0)||0===i)return s.fromNumber(NaN);if(i==1/0||i==-(1/0)||0===o)return e;var a=e.toNumber()%r.toNumber();return(a==1/0||a==-(1/0)||isNaN(a))&&n(),t(a)?s.fromNumber(a):s.fromBig(Big(e.toBig().mod(r.toBig())))},"i~i":function(e,r){var o=e.toNumber()/r.toNumber();return(o==1/0||o==-(1/0)||isNaN(o))&&n(),t(o)?s.fromNumber(Math.trunc(o)):s.fromBig(Big(e.toBig().div(r.toBig())).round(0,0))},"c+c":function(t,n){var r=t.toBig(),o=n.toBig();return e(t,n).fromBig(r.plus(o))},"c-c":function(t,n){var r=t.toBig(),o=n.toBig();return e(t,n).fromBig(r.minus(o))},"c*c":function(t,n){var r=t.toBig(),o=n.toBig();return e(t,n).fromBig(r.times(o))},"c/c":function(t,e){try{var r=t.toBig(),o=e.toBig();return u.fromBig(r.div(o))}catch(i){n()}},"c%c":function(t,e){try{var r=t.toBig(),o=e.toBig();return u.fromBig(r.mod(o))}catch(i){n()}},"c~c":function(e,r){try{var o=e.toBig(),i=r.toBig(),a=o.div(i).round(0,0);return t(a)?s.fromNumber(a):u.fromBig(a)}catch(c){n()}},"a+a":function(t,e){return i(t,e,"+")},"a-a":function(t,e){return i(t,e,"-")},"a*a":function(t,e){return i(t,e,"*")},"a/a":function(t,e){return i(t,e,"/")},"a%a":function(t,e){return i(t,e,"%")},"a~a":function(t,e){return i(t,e,"~")},"u+u":function(t,e){var n=S.dayTimeDuration,r=S.yearMonthDuration;return n.matches(t)&&n.matches(e)||r.matches(t)&&r.matches(e)||o(t,e,"+"),r.matches(t)?r.fromMonthsMilliseconds(t.months+e.months,0):n.fromMonthsMilliseconds(0,t.milliseconds+e.milliseconds)},"u-u":function(t,e){var n=S.dayTimeDuration,r=S.yearMonthDuration;return n.matches(t)&&n.matches(e)||r.matches(t)&&r.matches(e)||o(t,e,"-"),r.matches(t)?r.fromMonthsMilliseconds(t.months-e.months,0):n.fromMonthsMilliseconds(0,t.milliseconds-e.milliseconds)},"u*n":function(t,e){var n=S.dayTimeDuration,i=S.yearMonthDuration;n.matches(t)||i.matches(t)||o(t,e,"*");var a=e.toNumber();if(a==1/0||a==-(1/0))throw new r("Cannot multiply duration by +/-INF","FODT0002");if(isNaN(a))throw new r("Cannot multiply duration by NaN","FOCA0005");return i.matches(t)?i.fromMonthsMilliseconds(Math.round(t.months*a),0):n.fromMonthsMilliseconds(0,Math.round(t.milliseconds*a))},"n*u":function(t,e){return M["u*n"](e,t)},"u/n":function(t,e){var r=S.dayTimeDuration,i=S.yearMonthDuration;r.matches(t)||i.matches(t)||o(t,e,"/");var a=i.matches(t)?t.months/e.toNumber():t.milliseconds/e.toNumber();return(a==1/0||a==-(1/0)||isNaN(a))&&n("FODT0002"),i.matches(t)?i.fromMonthsMilliseconds(Math.round(a),0):r.fromMonthsMilliseconds(0,Math.round(a))},"u/u":function(t,e){var r=S.dayTimeDuration,i=S.yearMonthDuration;r.matches(t)&&r.matches(e)||i.matches(t)&&i.matches(e)||o(t,e,"/");var a=new Big(i.matches(t)?t.months:t.milliseconds),s=new Big(i.matches(e)?e.months:e.milliseconds);try{return u.fromBig(a.div(s))}catch(c){n()}},"t+u":function(t,e){var n=S.dayTimeDuration,r=S.yearMonthDuration;return n.matches(e)||r.matches(e)||o(t,e,"+"),n.matches(e)?S[t.type].fromDate(new Date(t.UTCdate.getTime()+e.milliseconds),t.timezoneOffset):t.addMonths(e.months)},"u+t":function(t,e){return M["t+u"](e,t)},"t-u":function(t,e){var n=S.dayTimeDuration,r=S.yearMonthDuration;return n.matches(e)||r.matches(e)||o(t,e,"-"),n.matches(e)?S[t.type].fromDate(new Date(t.UTCdate.getTime()-e.milliseconds),t.timezoneOffset):t.addMonths(-e.months)},"t-t":function(t,e){return S.dayTimeDuration.fromMonthsMilliseconds(0,t.UTCdate.getTime()-e.UTCdate.getTime())}};return l}(),k=function(){"use strict";function t(t,n){var r=t.getAttribute("level"),o=L.argRole(t,"select"),i=L.argRole(t,"count"),a=L.argRole(t,"from");return e(r,o,i,a,n)}function e(t,e,n,o,i){var a;if(e)a=L.evaluate(e,i).next();else{if(i.noCurrentFocus())throw r("No context item in Numberer","SXJS0004",e);a=i.getCurrentFocus()}var u=$.nameOfNode(a),s=function(t){return null===$.xdmParentNode(t)},c=function(t){return t.nodeType==a.nodeType&&(null===u?!0:$.nameOfNode(t).equals(u))},l=c;if(null!==n){var f=D(n);l=function(t){return f(t,i)}}var m;if(null===o)m=s;else{var p=D(o);m=function(t){return s(t)||p(t,i)}}var h,g,d,v;switch(t){case"simple":return h=E.precedingSibling(a).filter(c),A.oneInteger(h.count()+1);case"single":return g=E.ancestorOrSelf(a).filter(l).next(),v=E.ancestorOrSelf(a).filter(m).next(),d=null===g?null:null!==E.ancestorOrSelf(g).filter(function(t){return $.isSameNode(t,v)}).next()?g:null,null===d?A.Empty:(h=E.precedingSibling(d).filter(l),A.oneInteger(h.count()+1));case"multi":g=A.ForArray(E.ancestorOrSelf(a).filter(l).expand().reverse()),v=E.ancestorOrSelf(a).filter(m).next(),d=g.filter(function(t){var e=E.ancestorOrSelf(t).filter(function(t){return $.isSameNode(t,v)});return null!==e.next()});var y=S.integer.fromNumber;return d.mapOneToOne(function(t,e){return y(E.precedingSibling(t).filter(l).count()+1)});case"any":var N=function(t,e){return $.compareDocumentOrder(e,t)};g=A.Union(E.preceding(a).filter(l),E.ancestorOrSelf(a).filter(l),N),v=A.Union(E.preceding(a).filter(m),E.ancestorOrSelf(a).filter(m),N).next(),null===v&&C.internalError("from pattern selected empty"),d=g.filter(function(t){return $.compareDocumentOrder(t,v)>=0});var x=d.count();return 0===x?A.Empty:A.oneInteger(x);default:C.internalError("unknown xsl:number/@level "+t)}}function n(t,e){var n=L.argRole(t,"value"),r=L.argRole(t,"format"),a=L.evaluateIfPresent(L.argRole(t,"gpSep"),e).next(),u=L.evaluateIfPresent(L.argRole(t,"gpSize"),e).next(),s=L.evaluateIfPresent(L.argRole(t,"ordinal"),e).next(),c=L.evaluateIfPresent(L.argRole(t,"lang"),e).next(),l=t.getAttribute("flags")||"",f=L.argRole(t,"startAt"),m=/1/.test(l),p=L.evaluate(n,e),h=i(p,m,f,!0,e);return null===h?A.oneString("NaN"):o(h,r,a,u,s,c,e)}function o(t,e,n,o,i,a,u){function s(t){var e,n;if(""===t&&(t="1"),
/^[\x01-\x7f]*$/.test(t))e=t.split(/\b/),n=function(t,e){return/\w+/.test(t)};else{if(t.length!=L.stringToCodepoints(t).length)throw r("Cannot handle non-BMP characters in format-number picture","SXJS0002");var o=L.analyze(t,"[\\p{Nd}\\p{Nl}\\p{No}\\p{Lu}\\p{Ll}\\p{Lt}\\p{Lm}\\p{Lo}]+","",!0,!1);n=function(t,e){return o[e].matching},e=o.map(function(t){return t.string.toString()})}var i,a={prefix:"",fTokens:[],suffix:""},u=".";for(i=0;i<e.length;i++){var s=e[i];n(s,i)?(a.fTokens.push({chars:s,sep:u}),u="."):(0===i&&(a.prefix=s),i==e.length-1?a.suffix=s:0!==i&&(u=s))}return 0===a.fTokens.length&&(a.fTokens.push({chars:"1",sep:"."}),a.suffix=a.prefix),a}function c(t){var r=null===e?"1":L.evaluate(e,u).next().toString(),a=s(r),c=a.prefix;return t.forEach(function(t,e){var r=e>=a.fTokens.length?a.fTokens[a.fTokens.length-1]:a.fTokens[e];0!==e&&(c+=r.sep);var u=r.chars;"yes"==i&&(u+=";o");var s=k.formatInteger(t,u);null!==n&&null!==o&&(s=k.addGroupingSeparators(s,n,o)),c+=s}),c+=a.suffix,A.oneString(c)}if(null!==a)try{S.language.cast(a)}catch(l){throw r("@lang="+a+": invalid language code","XTDE0030")}return c(t.expand())}function i(t,e,n,o,i){var a=[1];if(null!==n&&(a=L.evaluate(n,i).next().toString().split(/\s+/).map(function(t){if(!/^-?[0-9]+$/.test(t))throw r("xsl:number/@start-at must be a sequence of integers.Offending value: "+t,"XTSE0020");return parseInt(t,10)})),e&&o){var u=t.next();if(null===u)return null;try{u=S.integer.cast(u.round(0))}catch(s){return null}t=A.ForArray([u])}var c=function(t,e){if(t=S.numeric.matches(t)?t.toDouble():S["double"].fromStringUnfailing(t.toString()),t.toNumber()<0)throw r("xsl:number/@value is less than zero","XTDE0980");try{t=S.integer.cast(t.round(0))}catch(n){throw n.code="XTDE0980",n}var o=e>=a.length?a[a.length-1]:a[e];return 1!=o&&(t=S.integer.fromNumber(t.toNumber()+(o-1))),t};return t.mapOneToOne(c)}function a(t,n){var r,a,u=L.argRole(t,"value"),s=L.argRole(t,"format"),c=L.evaluateIfPresent(L.argRole(t,"gpSep"),n).next(),l=L.evaluateIfPresent(L.argRole(t,"gpSize"),n).next(),f=L.evaluateIfPresent(L.argRole(t,"ordinal"),n).next(),m=L.evaluateIfPresent(L.argRole(t,"lang"),n).next(),p=t.getAttribute("flags")||"",h=/1/.test(p),g=L.argRole(t,"startAt");if(u)r=L.evaluate(u,n),a=i(r,h,g,!0,n);else{var d=t.getAttribute("level"),v=L.argRole(t,"select"),y=L.argRole(t,"count"),S=L.argRole(t,"from");r=e(d,v,y,S,n),a=i(r,h,g,!1,n)}return null===a?A.oneString("NaN"):o(a,s,c,l,f,m,n)}function u(t){if(1>t||t>4999)return t.toString();var e,n="",r=["m","cm","d","cd","c","xc","l","xl","x","ix","v","iv","i"],o=[1e3,900,500,400,100,90,50,40,10,9,5,4,1];for(e=0;e<r.length;e++)for(;t>=o[e];)n+=r[e],t-=o[e];return n}function s(t,e){function n(t){return(t>r?n(Math.floor((t-1)/r)):"")+e.charAt((t-1)%r)}if(1>t)return t.toString();var r=e.length;return n(t)}function c(t,e){return t<e.length?e[t]:t.toString()}function l(t,e){for(var n=Math.abs(t),r=999999>n?n.toString():Big(n).toFixed();r.length<e;)r="0"+r;return 0>t&&(r="-"+r),r}function f(t){var e,n,o=C,i=o.stringToCodepoints(t),a={},u=!0,s=0,c=_.prepareRegex("\\p{Nd}",null),l=t.search(c);if(0>l)u=!1;else{var f=_.obtainCategoryEscapes().Nd;for(n=0;n<f.length;n++){var m=f[n];if(e=parseInt(m[0],16),e<=i[l]&&i[l]<=e+10)break}for(n=0;n<i.length;n++)if(i[n]>=128){var p=String.fromCharCode(i[n]);if(c.test(p)){if(e>i[n]||i[n]>e+10)throw r("Picture string mixes digits from different digit families: "+t,"FODF1310")}else{var h=_.prepareRegex("\\p{N}\\p{L}",null);if(h.test(p))throw r("Picture string is invalid: "+t,"FODF1310")}}var g=[];s=e-48,i.forEach(function(t){t>=e&&e+10>=t?g.push(48):g.push(t)}),t=o.codepointsToString(g)}return a.isDecimalDigitPattern=u,a.format=t,a.diff=s,a.zeroDigit=e,a}function m(t,e){var n=[];return C.stringToCodepoints(t).forEach(function(t){t>=48&&57>=t?n.push(t+e):n.push(t)}),C.codepointsToString(n)}function p(t,e,n,r,o){var i,a=0,u=t;for(i=0;i<u.length;i++)if(i==e[a]){var s=o?i+1:u.length-i;s>0&&(u=u.substring(0,s)+(n?n[o?a:n.length-a-1]:r)+u.substring(s)),a++}return u}function h(t,e){function n(t,e){if(!/^(([0-9]|#|[^A-Za-z0-9])+?)$/.test(e))throw r("The decimal digit pattern in the picture string is invalid: "+e,"FODF1310");var n,o,i=e,a=!0;if(/[^0-9A-Za-z#]/.test(i)){if(n=i.match(/[^0-9A-Za-z#]/g),n.length>1)for(o=1;o<n.length;o++)if(n[0]!=n[o]){a=!1;break}i=i.replace(/[^0-9A-Za-z#]/g,",")}if(/^,|,,|,$/.test(i))throw r("Grouping in picture string is invalid: "+e,"FODF1310");if(/[0-9].*#/.test(i))throw r("Picture string is invalid: "+e,"FODF1310");var u=i.replace(/[#,]/g,"").length,s=l(t,u);if(n){var c=C.stringToCodepoints(i).reverse(),f=[];for(o=0;o<c.length;o++)44==c[o]&&f.push(o);var m=!0;if(c.length-f[f.length-1]-1>f[0]&&(m=!1),m)for(o=1;o<f.length;o++)if((f[o]+1)%(f[0]+1)!==0){m=!1;break}s=m&&a?k.addGroupingSeparators(s,n[0],f[0]):p(s,f,n)}return s}var o=C.stringToCodepoints(e),i=!0,a=!0,u=0;if(o.length!=e.length)throw r("Cannot handle non-BMP characters in format-integer picture","SXJS0002");if(/^[\x01-\x7f]*$/.test(e)||(i=!1),i)a=/[0-9]/.test(e);else{var s=f(e);e=s.format,a=s.isDecimalDigitPattern,u=s.diff}a||(e="1");var c=n(t,e);return i||(c=m(c,u)),c}function g(t){var e=["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],n=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];return 20>t?e[t]:100>t?n[Math.floor(t/10)]+(t%10===0?"":" "+e[t%10]):1e3>t?g(Math.floor(t/100))+" Hundred"+(t%100===0?"":" and "+g(t%100)):1e6>t?g(Math.floor(t/1e3))+" Thousand"+(t%1e3===0?"":(100>t%1e3?" and ":" ")+g(t%1e3)):1e9>t?g(Math.floor(t/1e6))+" Million"+(t%1e3===0?"":(100>t%1e3?" and ":" ")+g(t%1e6)):t.toString()}function d(t){var e=["Zeroth","First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth","Eleventh","Twelfth","Thirteenth","Fourteenth","Fifteenth","Sixteenth","Seventeenth","Eighteenth","Nineteenth"],n=["","","Twent","Thirt","Fort","Fift","Sixt","Sevent","Eight","Ninet"];return 20>t?e[t]:100>t?n[Math.floor(t/10)]+(t%10===0?"ieth":"y "+e[t%10]):1e3>t?g(Math.floor(t/100))+" Hundred"+(t%100===0?"th":" and "+d(t%100)):1e6>t?g(Math.floor(t/1e3))+" Thousand"+(t%1e3===0?"th":(100>t%1e3?" and ":" ")+d(t%1e3)):1e9>t?g(Math.floor(t/1e6))+" Million"+(t%1e3===0?"th":(100>t%1e3?" and ":" ")+d(t%1e6)):t.toString()}function v(t){return t%10==1&&t%100!=11?"st":t%10==2&&t%100!=12?"nd":t%10==3&&t%100!=13?"rd":"th"}function y(t,e){function n(t,e){for(var n="",r=t.charCodeAt(0),o=0;e>o;r++,o++)n+=String.fromCharCode(r);return n}var o,i=null;if(-1!=(o=e.lastIndexOf(";"))){if(i=e.substring(o+1),!/^([co](\(.+\))?)?[at]?$/.test(i))throw r("Invalid format modifier in picture string: "+i,"FODF1310");i=i.charAt(0),e=e.substring(0,o)}if(""===e)throw r("In the picture string, the picture cannot be empty","FODF1310");var a=0>t?"-":"";if("o"==i)switch(e.toString()){case"a":case"A":case"i":case"I":break;case"Ww":return a+d(Math.abs(t));case"W":return a+d(Math.abs(t)).toUpperCase();case"w":return a+d(Math.abs(t)).toLowerCase();default:return h(t,e)+v(Math.abs(t))}switch(e.toString()){case"a":return s(t,n("a",26));case"A":return s(t,n("A",26));case"":return s(t,n("",25));case"":return s(t,n("",25));case"i":return u(t);case"I":return u(t).toUpperCase();case"Ww":return a+g(Math.abs(t));case"W":return a+g(Math.abs(t)).toUpperCase();case"w":return a+g(Math.abs(t)).toLowerCase();case"":return c(t,""+n("",20)+n("",15)+n("",15));case"":return c(t,"0"+n("",20));case"":return 0==t?"":c(t,"0"+n("",20));case"":return c(t,""+n("",10)+n("",10));case"":return 0==t?"":c(t,"0"+n("",10));case"":return 0==t?"":c(t,"0"+n("",10));case"":return c(t,"0"+n("",10));case"":return c(t,"0"+n("",10));case"":return c(t,"0"+n("",10));default:return h(t,e)}}function N(t,e,n){var r,o="";for(r=0;r<t.length;r++){var i=t.charAt(r),a=e.indexOf(i);0>a?o+=i:a<n.length&&(o+=n.charAt(a))}return o}function x(t,e){var n=$.getAttribute(t,e,z[e]);return String.fromCharCode(parseInt(n,10))}function b(t,e){function n(t){var e=[["$gs","grouping separator"],["$es","exponent separator"],["$ds","decimal separator"],["$pc","non-prefix passive character"],["$pp","percent|permille"],["$od","optional digit"],["$md","mandatory digit"],["$ip","integer part"],["$fp","fractional part"]];throw e.forEach(function(e){t=t.replace(e[0],e[1])}),r("Invalid picture: "+t,"FODF1310")}var o,i,a,u={},s=t.indexOf(e.decimalSeparator),c=s>=0,l=e.zeroDigit.charCodeAt(0),f=0,m=0,p=[],h=[],g=[],d=-1,v=-1,y=!1,S=!1,N=-1,x=0,b=c?s:t.length;for(o=0;b>o;o++)a=t.charCodeAt(o),a>=l&&l+10>a?(v>0&&n("digit follows $pc"),y?x++:(1>f&&0>d&&(d=o),f++,m++)):a==e.digit.charCodeAt(0)?(v>0&&n("digit follows $pc"),y&&n("$od follows $es"),f>0&&n("$od follows $md in $ip"),0>d&&(d=o,S=!0),m++):a==e.groupingSeparator.charCodeAt(0)?(0>d&&n("$gs before any digit"),g.length>0&&n("$gs follows $pc"),y&&n("$gs follows $es"),p.push(o)):a==e.percent.charCodeAt(0)||a==e.permille.charCodeAt(0)?c?n("$pp before $ds"):(0>d&&n("$pp before any digit"),v>0&&n("$pp follows $pc"),y&&n("$pp follows $es"),g.push(a),0>v&&(v=o),a==e.percent.charCodeAt(0)?u.percent=!0:u.permille=!0):!c&&d>=0&&a==e.exponentSeparator.charCodeAt(0)&&0>v?y?(g.push(a),x>0?0>v&&(v=o):(g.push(a),y=!1,N=-1,0>v&&(v=o-1))):(y=!0,N=o):d>=0&&c?n("$pc before $ds"):y&&0===x?(y=!1,N=-1,g.push(e.exponentSeparator.charCodeAt(0)),g.push(a),0>v&&(v=o-1)):d>=0?(g.push(a),0>v&&(v=o)):h.push(a);if(p.length>0){var T=c?s:y?N:v>0?v:t.length,w=p.map(function(t){return T-t-1});p=w.reverse()}if(0!==p.length)for(0===p[0]&&n("$gs at end of $ip"),i=0;i<p.length-1;i++)p[i]+1==p[i+1]&&n("consecutive $gs in $ip");var E=0,C=0,O=[];if(c){var A=-1,D=t.substring(s+1);for(o=0;o<D.length;o++)a=D.charCodeAt(o),a>=l&&l+10>a?y&&0>v?x++:A>=0||v>=0?n("$md follows $od or $pc in $fp"):(E++,C++):a==e.digit.charCodeAt(0)?((v>=0||y)&&n("$od follows $pc or $es"),0>A&&(A=o),C++):a==e.groupingSeparator.charCodeAt(0)?((v>=0||y)&&n("$gs follows $pc or $es"),O.push(o-s+1)):a==e.decimalSeparator.charCodeAt(0)?n("more than one $ds"):a==e.percent.charCodeAt(0)||a==e.permille.charCodeAt(0)?((v>=0||y)&&n("$pp follows $pc or $es"),g.push(a),v=o,a==e.percent.charCodeAt(0)?u.percent=!0:u.permille=!0):a==e.exponentSeparator.charCodeAt(0)&&0>v?y?(g.push(a),x>0?0>v&&(v=o):(g.push(a),y=!1,N=-1,0>v&&(v=o-1))):(y=!0,N=o):y&&0===x?(y=!1,N=-1,g.push(e.exponentSeparator.charCodeAt(0)),g.push(a),0>v&&(v=o-1)):(g.push(a),0>v&&(v=o))}if(0>d&&0===C&&n("mantissa contains no digits"),0!==O.length)for(0===O[0]&&n("$gs at beginning of $fp"),i=0;i<O.length-1;i++)O[i]+1==O[i+1]&&n("consecutive $gs in $fp");return 0===f&&0===C&&(y?(E=1,C=1):f=1),y&&0===f&&S&&(f=1),0===f&&0===E&&(E=1),u.minimumIntegerPartSize=f,u.prefix=h,u.intGpPos=p,u.picIntPartContainsOptDigit=S,u.picIntPartSize=m,u.minimumFractionalPartSize=E,u.maximumFractionalPartSize=C,u.fracGpPos=O,u.expPartSize=x,u.exponentSeparator=e.exponentSeparator?e.exponentSeparator:"e",u.suffix=g,u}function w(t,e){var n=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return"M"==e?n[t-1]:"F"==e?r[t-1]:t}function O(t){var e=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.floor((t.getTime()-e.getTime())/864e5)+1}function F(t,e){var n=e?O(t):t.getUTCDate(),r=new Date(Date.UTC(t.getUTCFullYear(),e?0:t.getUTCMonth(),1)),o=r.getUTCDay();if(0===o&&(o=7),o>4&&8>=o+n)return F(new Date(r.getTime()-864e5),e);var i=5>o?1:0;return Math.floor((n+o-2)/7)+i}function I(t){return F(t,!0)}function M(t){return F(t,!1)}function P(t){return t.getUTCHours()<13?0===t.getUTCHours()?12:t.getUTCHours():t.getUTCHours()-12}function U(t){return t.getUTCHours()<12?"Am":"Pm"}function R(t,e,n,o,i,a,u){if(""===t)return"Z"==n?"J":"";var s="z"==e?"GMT":"";if("t"==o&&"+00:00"==t&&"Z"!=n&&"N"!=n)return"Z";if(""===n)return s+t;var c,l=t.match(/^([+\-])([0-9])([0-9]):([0-9]{2})$/);if("Z"==n||"N"==n){if("Z"==n){var p=parseInt(l[1]+l[2]+l[3],10);c=-12>p||p>12||"00"!=l[4]?t:"YXWVUTSRQPONZABCDEFGHIKLM".charAt(p+12)}else if("N"==n)throw r("Timezone names not implemented","SXJS0002")}else{u&&!/[0-9]+/.test(n)&&(n="00:00");var h=function(t,e){return"0"==e[2]&&1==t.length?e[3]:e[2]+e[3]},g=function(t,e){var n="0"!=e[2]||1!=t.length&&3!=t.length?e[2]+e[3]:e[3],r=t.length>2?e[4]:"00"!=e[4]?":"+e[4]:"";return n+r},d=0;if(!u){var v=f(n);n=v.format,d=v.diff}var y;/[^0-9A-Za-z]/.test(n)?(y=n.match(/^([0-9]+)([^0-9A-Za-z])([0-9]+)$/),c=l[1]+h(y[1],l)+y[2]+l[4]):(y=n.match(/^[0-9]+$/),c=l[1]+g(y[0],l)),u||(c=m(c,d))}return s+c}function B(t,e,n,o,i,a){function u(t,e,n,r,o){var i,a=0;if(!o){var u=f(e);e=u.format,a=u.diff}for(var s=t.toString();s.length<3;)s="0"+s;var c=C.stringToCodepoints(s),l=parseInt(C.codepointsToString(c.reverse()),10);if(!n&&!r&&/^[0-9]$/.test(e))for(;c.length>e.length;)e+="#";if(n&&"*"!=n){for(var p=/^([0-9]*)(#*)$/.exec(e),h=p[1]?p[1]:"",g=p[2]?p[2]:"";n>h.length;)h+="0",g=g.slice(0,-1);e=h+g}if(r)for("*"==r&&(r=c.length);e.length<r;)e+="#";var d=C.codepointsToString(C.stringToCodepoints(e).reverse()),v=y(l,d);for(i=C.codepointsToString(C.stringToCodepoints(v).reverse());i.length>e.length;)i=i.slice(0,-1);return n&&"*"!=n||0!==parseInt(i,10)||(i="0"),o||(i=m(i,a)),i}var s,c=n.match(/^([YMDdWwFHhmsfZzPCE])(.*)$/);if(null===c)throw r("Date/time component ["+n+"] not recognised","FOFD1340");var l=c[1],p=c[2]||"";if("date"==t&&/[HhPmsf]/.test(l)||"time"==t&&/[YMDdFWwCE]/.test(l))throw r("Date/time component ["+n+"] not available in "+t,"FOFD1350");var h,g,d;if(-1!=(h=p.lastIndexOf(","))){var v=p.substring(h+1).split("-");if(p=p.substring(0,h),g=v[0],d=v[1]||"*","*"!=g&&1>g||"*"!=d&&1>d||"*"!=g&&"*"!=d&&g>d)throw r("Invalid width modifier in date/time formatting picture","FOFD1340")}var S,N=null;p.length>1&&/[atco]/.test(p.charAt(p.length-1))?(S=p.substring(0,p.length-1),N=p.charAt(p.length-1)):S=p;var x=!0;if(/^[\x01-\x7f]*$/.test(S));else{if(S.length!=C.stringToCodepoints(S).length)throw r("Cannot handle non-BMP characters in date/time formatting picture","SXJS0002");x=!1}if(/[Zz]/.test(l)){var b="Z"==e.tzOffsetToString()?"+00:00":e.tzOffsetToString();return R(b,l,S,N,g,d,x)}var T=e.proxy(),E=G[l]?T[G[l]]():q[l]?q[l](T):null;if(null===E)throw r("Component specifier not implemented: ["+l+"]","SXJS0002");if("M"==l?E++:"F"==l&&0===E&&(E=7),""===S&&(S=/[FPCE]/.test(l)?"n":/[ms]/.test(l)?"01":"1"),"f"==l)return u(E,S,g,d,x);if(/[nN]/.test(S))s=w(E,l),"n"==S?s=s.toLowerCase():"N"==S&&(s=s.toUpperCase()),d&&"*"!=d&&s.length>d&&(s=s.substring(0,d));else{var O=/;/.test(S)?S+";":S;if(N&&(O+=(";"==O.charAt(O.length-1)?"":";")+N),s=y(E,O),"Y"==l&&/[^iIwWnN]/.test(S.charAt(S.length-1))&&(!g&&2==S.length||2==d))for(;s.length>2;)s=s.substring(1);if(g){var A="*"==g?0:parseInt(g,10);if(A>0&&s.length<A)if(/[YMDdWwHhms]/.test(l)&&/[^iIwWnN]/.test(S.charAt(S.length-1))){var D="0";for(x||(D=String.fromCharCode(f(O).zeroDigit));s.length<A;)s=D+s}else{if("Y"!=l||!/[iIwWnN]/.test(S.charAt(S.length-1)))throw r("Not implemented min width modification with specifier "+l+" and format "+S,"SXJS0002");for(;s.length<A;)s+=" "}}}return s}function X(t,e,n,o){var i=0>t?!0:0===t?0>1/t:!1,a={decimalSeparator:x(n,"decimal-separator"),groupingSeparator:x(n,"grouping-separator"),digit:x(n,"digit"),minusSign:x(n,"minus-sign"),percent:x(n,"percent"),permille:x(n,"per-mille"),zeroDigit:x(n,"zero-digit"),exponentSeparator:x(n,"exponent-separator"),patternSeparator:x(n,"pattern-separator"),infinity:$.getAttribute(n,"infinity",z.infinity),nan:$.getAttribute(n,"NaN",z.NaN)};if(isNaN(t))return a.nan;var u=e.includes(a.patternSeparator)?e.split(a.patternSeparator):[e];if(u.length>2)throw r("Invalid picture: multiple pattern separators","FODF1310");var s,c,l=u.length>1&&0>t?u[1]:u[0],f=b(l,a);if(isFinite(t)){var m;if(f.expPartSize>0)m=J(t,f);else{var h=Math.abs(t);f.percent&&(h=Math.abs(100*t)),f.permille&&(h=Math.abs(1e3*t)),m=h+""=="Infinity"?h+"":999999>h?h.toString():Big(h).toFixed();var g=m.indexOf(".");0>g&&(g=m.length,f.minimumFractionalPartSize>0&&(m+=".")),f.maximumFractionalPartSize>=0&&"."!=m.substring(g)&&g!=m.length&&(f.maximumFractionalPartSize>0?(m=Big(m).round(f.maximumFractionalPartSize,1).toString(),m.indexOf(".")<0&&(m+=".0")):m=Big(m).round(0,1).toString());var d=m.length-1-g;if(f.minimumFractionalPartSize>0)for(;d<f.minimumFractionalPartSize;)m+="0",d++;for(;g<f.minimumIntegerPartSize;)m="0"+m,g++;d>0&&0===f.minimumIntegerPartSize&&"0"==m.substring(0,g)&&(m=m.substring(g)),"0"==m&&0===f.minimumIntegerPartSize&&0===f.minimumFractionalPartSize&&f.maximumFractionalPartSize>0&&(m=".0")}var v,y="";for(v=0;10>v;v++)y+=String.fromCharCode(a.zeroDigit.charCodeAt(0)+v);if(y+=a.decimalSeparator,s=N(m,"0123456789.",y),f.intGpPos.length>0||f.fracGpPos.length>0){var S=s.indexOf(a.decimalSeparator);0>S&&(S=s.length);var T=s.substring(0,S);if(c=s.substring(S),f.intGpPos.length>0){for(var w=!0,E=1;E<f.intGpPos.length;E++)if((f.intGpPos[E]+1)%(f.intGpPos[0]+1)!==0){w=!1;break}w&&f.picIntPartSize+f.intGpPos.length-f.intGpPos[f.intGpPos.length-1]-1>f.intGpPos[0]&&(w=!1),T=w?k.addGroupingSeparators(T,a.groupingSeparator,f.intGpPos[0]):p(T,f.intGpPos,null,a.groupingSeparator)}f.fracGpPos.length>0&&(c=p(c,f.fracGpPos,null,a.groupingSeparator,!0)),s=T+c}}else s=a.infinity;return f.prefix.length>0&&(s=C.codepointsToString(f.prefix)+s),f.suffix.length>0&&(s+=C.codepointsToString(f.suffix)),i&&1==u.length&&(s=a.minusSign+s),s}function J(t,e){var n=e.minimumIntegerPartSize,o=e.minimumFractionalPartSize,i=e.maximumFractionalPartSize,a=e.exponentSeparator,u=1==n&&e.picIntPartContainsOptDigit;u&&(n=0,0===o&&(o=1,0===i&&(i=1)));var s=e.expPartSize,c=Big(t),f=c.c,m=0!==n?n+i:i,p=c.e;f.length>m&&(c=Big(c.toPrecision(m)));var h=p!=c.e;h&&(n+=1),n>1?c=c.div(Big(10).pow(n-1)):0===n&&(c=c.times(Big(10)));var g=0!==n?n+o:o;for(f=c.c;f.length<g;)f.push(0);var d="";if(!(f.length>0))throw r("Empty mantissa","SXJS0004");if(0===n&&e.picIntPartContainsOptDigit)d+="0";else for(var v=0;n>v;v++)d+=f[v];if(i>0&&f.length>n&&(!u||!h)){var y=f.join("").slice(n);d+="."+y}return d+a+l(c.e,s)}var L=C,$=T,z={"decimal-separator":"46","grouping-separator":"44",digit:"35","minus-sign":"45",percent:"37","per-mille":"8240","zero-digit":"48","exponent-separator":"101","pattern-separator":"59",infinity:"Infinity",NaN:"NaN"},G={Y:"getUTCFullYear",M:"getUTCMonth",D:"getUTCDate",F:"getUTCDay",H:"getUTCHours",m:"getUTCMinutes",s:"getUTCSeconds",f:"getUTCMilliseconds"},q={d:O,W:I,w:M,h:P,P:U,E:function(){return"AD"}};return{xslNumber:a,nodeNum:t,numSeqFmt:n,formatInteger:y,addGroupingSeparators:function(t,e,n){var r,o="";for(r=0;r<t.length;r++)o+=t.charAt(r),(1==n||(t.length-r)%n==1)&&r<t.length-1&&(o+=e);return o},formatNumber:X,formatDateTime:function(t,e,n,o,i,a){function u(n){return"[["==n?"[":"]]"==n?"]":B(t,e,n.substring(1,n.length-1).replace(/\s+/g,""),o,i,a)}if(!/\[(\[|[^\]]*\])|\]\]/g.test(n))throw r("Date format picture doesn't match required syntax","FOFD1340");return n.replace(/\[(\[|[^\]]*\])|\]\]/g,u)}}}();!function(t){"use strict";function e(){function t(n){var o=this;return o instanceof t?(n instanceof t?(o.s=n.s,o.e=n.e,o.c=n.c.slice()):r(o,n),void(o.constructor=t)):void 0===n?e():new t(n)}return t.prototype=p,t.DP=u,t.RM=s,t.E_NEG=f,t.E_POS=m,t}function n(t,e,n){var r=t.constructor,i=e-(t=new r(t)).e,a=t.c;for(a.length>++e&&o(t,i,r.RM),a[0]?n?i=e:(a=t.c,i=t.e+i+1):++i;a.length<i;a.push(0));return i=t.e,1===n||n&&(i>=e||i<=r.E_NEG)?(t.s<0&&a[0]?"-":"")+(a.length>1?a[0]+"."+a.join("").slice(1):a[0])+(0>i?"e":"e+")+i:t.toString()}function r(t,e){var n,r,o;for(0===e&&0>1/e?e="-0":h.test(e+="")||i(NaN),t.s="-"==e.charAt(0)?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(0>n&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):0>n&&(n=e.length),r=0;"0"==e.charAt(r);r++);if(r==(o=e.length))t.c=[t.e=0];else{for(;"0"==e.charAt(--o););for(t.e=n-r-1,t.c=[],n=0;o>=r;t.c[n++]=+e.charAt(r++));}return t}function o(t,e,n,r){var o,a=t.c,u=t.e+e+1;if(1===n?r=a[u]>=5:2===n?r=a[u]>5||5==a[u]&&(r||0>u||a[u+1]!==o||1&a[u-1]):3===n?r=r||a[u]!==o||0>u:(r=!1,0!==n&&i("!Big.RM!")),1>u||!a[0])r?(t.e=-e,t.c=[1]):t.c=[t.e=0];else{if(a.length=u--,r)for(;++a[u]>9;)a[u]=0,u--||(++t.e,a.unshift(1));for(u=a.length;!a[--u];a.pop());}return t}function i(t){var e=new Error(t);throw e.name="BigError",e}var a,u=20,s=1,c=1e6,l=1e6,f=-7,m=21,p={},h=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;p.abs=function(){var t=new this.constructor(this);return t.s=1,t},p.cmp=function(t){var e,n=this,r=n.c,o=(t=new n.constructor(t)).c,i=n.s,a=t.s,u=n.e,s=t.e;if(!r[0]||!o[0])return r[0]?i:o[0]?-a:0;if(i!=a)return i;if(e=0>i,u!=s)return u>s^e?1:-1;for(i=-1,a=(u=r.length)<(s=o.length)?u:s;++i<a;)if(r[i]!=o[i])return r[i]>o[i]^e?1:-1;return u==s?0:u>s^e?1:-1},p.div=function(t){var e=this,n=e.constructor,r=e.c,a=(t=new n(t)).c,u=e.s==t.s?1:-1,s=n.DP;if((s!==~~s||0>s||s>c)&&i("!Big.DP!"),!r[0]||!a[0])return r[0]==a[0]&&i(NaN),a[0]||i(u/0),new n(0*u);var l,f,m,p,h,g,d=a.slice(),v=l=a.length,y=r.length,S=r.slice(0,l),N=S.length,x=t,b=x.c=[],T=0,w=s+(x.e=e.e-t.e)+1;for(x.s=u,u=0>w?0:w,d.unshift(0);N++<l;S.push(0));do{for(m=0;10>m;m++){if(l!=(N=S.length))p=l>N?1:-1;else for(h=-1,p=0;++h<l;)if(a[h]!=S[h]){p=a[h]>S[h]?1:-1;break}if(!(0>p))break;for(f=N==l?a:d;N;){if(S[--N]<f[N]){for(h=N;h&&!S[--h];S[h]=9);--S[h],S[N]+=10}S[N]-=f[N]}for(;!S[0];S.shift());}b[T++]=p?m:++m,S[0]&&p?S[N]=r[v]||0:S=[r[v]]}while((v++<y||S[0]!==g)&&u--);return b[0]||1==T||(b.shift(),x.e--),T>w&&o(x,s,n.RM,S[0]!==g),x},p.eq=function(t){return!this.cmp(t)},p.gt=function(t){return this.cmp(t)>0},p.gte=function(t){return this.cmp(t)>-1},p.lt=function(t){return this.cmp(t)<0},p.lte=function(t){return this.cmp(t)<1},p.sub=p.minus=function(t){var e,n,r,o,i=this,a=i.constructor,u=i.s,s=(t=new a(t)).s;if(u!=s)return t.s=-s,i.plus(t);var c=i.c.slice(),l=i.e,f=t.c,m=t.e;if(!c[0]||!f[0])return f[0]?(t.s=-s,t):new a(c[0]?i:0);if(u=l-m){for((o=0>u)?(u=-u,r=c):(m=l,r=f),r.reverse(),s=u;s--;r.push(0));r.reverse()}else for(n=((o=c.length<f.length)?c:f).length,u=s=0;n>s;s++)if(c[s]!=f[s]){o=c[s]<f[s];break}if(o&&(r=c,c=f,f=r,t.s=-t.s),(s=(n=f.length)-(e=c.length))>0)for(;s--;c[e++]=0);for(s=e;n>u;){if(c[--n]<f[n]){for(e=n;e&&!c[--e];c[e]=9);--c[e],c[n]+=10}c[n]-=f[n]}for(;0===c[--s];c.pop());for(;0===c[0];)c.shift(),--m;return c[0]||(t.s=1,c=[m=0]),t.c=c,t.e=m,t},p.mod=function(t){var e,n=this,r=n.constructor,o=n.s,a=(t=new r(t)).s;return t.c[0]||i(NaN),n.s=t.s=1,e=1==t.cmp(n),n.s=o,t.s=a,e?new r(n):(o=r.DP,a=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=o,r.RM=a,this.minus(n.times(t)))},p.add=p.plus=function(t){var e,n=this,r=n.constructor,o=n.s,i=(t=new r(t)).s;if(o!=i)return t.s=-i,n.minus(t);var a=n.e,u=n.c,s=t.e,c=t.c;if(!u[0]||!c[0])return c[0]?t:new r(u[0]?n:0*o);if(u=u.slice(),o=a-s){for(o>0?(s=a,e=c):(o=-o,e=u),e.reverse();o--;e.push(0));e.reverse()}for(u.length-c.length<0&&(e=c,c=u,u=e),o=c.length,i=0;o;)i=(u[--o]=u[o]+c[o]+i)/10|0,u[o]%=10;for(i&&(u.unshift(i),++s),o=u.length;0===u[--o];u.pop());return t.c=u,t.e=s,t},p.pow=function(t){var e=this,n=new e.constructor(1),r=n,o=0>t;for((t!==~~t||-l>t||t>l)&&i("!pow!"),t=o?-t:t;1&t&&(r=r.times(e)),t>>=1,t;)e=e.times(e);return o?n.div(r):r},p.round=function(t,e){var n=this,r=n.constructor;return null==t?t=0:(t!==~~t||0>t||t>c)&&i("!round!"),o(n=new r(n),t,null==e?r.RM:e),n},p.sqrt=function(){var t,e,n,r=this,a=r.constructor,u=r.c,s=r.s,c=r.e,l=new a("0.5");if(!u[0])return new a(r);0>s&&i(NaN),s=Math.sqrt(r.toString()),0===s||s===1/0?(t=u.join(""),t.length+c&1||(t+="0"),e=new a(Math.sqrt(t).toString()),e.e=((c+1)/2|0)-(0>c||1&c)):e=new a(s.toString()),s=e.e+(a.DP+=4);do n=e,e=l.times(n.plus(r.div(n)));while(n.c.slice(0,s).join("")!==e.c.slice(0,s).join(""));return o(e,a.DP-=4,a.RM),e},p.mul=p.times=function(t){var e,n=this,r=n.constructor,o=n.c,i=(t=new r(t)).c,a=o.length,u=i.length,s=n.e,c=t.e;if(t.s=n.s==t.s?1:-1,!o[0]||!i[0])return new r(0*t.s);for(t.e=s+c,u>a&&(e=o,o=i,i=e,c=a,a=u,u=c),e=new Array(c=a+u);c--;e[c]=0);for(s=u;s--;){for(u=0,c=a+s;c>s;)u=e[c]+i[s]*o[c-s-1]+u,e[c--]=u%10,u=u/10|0;e[c]=(e[c]+u)%10}for(u&&++t.e,e[0]||e.shift(),s=e.length;!e[--s];e.pop());return t.c=e,t},p.toString=p.valueOf=p.toJSON=function(){var t=this,e=t.constructor,n=t.e,r=t.c.join(""),o=r.length;if(n<=e.E_NEG||n>=e.E_POS)r=r.charAt(0)+(o>1?"."+r.slice(1):"")+(0>n?"e":"e+")+n;else if(0>n){for(;++n;r="0"+r);r="0."+r}else if(n>0)if(++n>o)for(n-=o;n--;r+="0");else o>n&&(r=r.slice(0,n)+"."+r.slice(n));else o>1&&(r=r.charAt(0)+"."+r.slice(1));return t.s<0&&t.c[0]?"-"+r:r},p.toExponential=function(t){return null==t?t=this.c.length-1:(t!==~~t||0>t||t>c)&&i("!toExp!"),n(this,t,1)},p.toFixed=function(t){var e,r=this,o=r.constructor,a=o.E_NEG,u=o.E_POS;return o.E_NEG=-(o.E_POS=1/0),null==t?e=r.toString():t===~~t&&t>=0&&c>=t&&(e=n(r,r.e+t),r.s<0&&r.c[0]&&e.indexOf("-")<0&&(e="-"+e)),o.E_NEG=a,o.E_POS=u,e||i("!toFix!"),e},p.toPrecision=function(t){return null==t?this.toString():((t!==~~t||1>t||t>c)&&i("!toPre!"),n(this,t-1,2))},a=e(),"function"==typeof define&&define.amd?define(function(){return a}):"undefined"!=typeof module&&module.exports?module.exports=a:t.Big=a}(this);var P,U=function(){"use strict";function t(t,e,n,o,i){var a=S.string.fromString(e);if(t&&t.containsKey(a)){var u=t.get(a);if("function"==n)throw r("Option "+a+" must be a function","XPTY0004");if(1==u.length&&S[n].matches(u[0])){if(i&&i.indexOf(u[0].value)<0)throw r("Invalid value "+a+"="+u[0],"FOJS0005");return u[0].value}throw r("Invalid option: "+e+": must be "+n,"XPTY0004")}return o}function e(t,e,n){function o(t){throw r(t,"FOJS0001")}function i(){return g=a()}function a(){var e,n;for(g="";;){if(h>=t.length)return["eof"];if(n=t.charAt(h++),!/[ \n\r\t]/.test(n))break}switch(n){case"[":case"{":case"]":case"}":case":":case",":return[n];case'"':for(var r=!1;;){if(e=t.charAt(h++),'"'==e&&!r)return["string",g];g+=e,r="\\"==e&&!r,h>=t.length&&o("Unclosed quotes in string literal")}return["string",g];case"-":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(g+=n;h<t.length;){if(e=t.charAt(h++),!/[0-9\-+\.eE]/.test(e)){h--;break}g+=e}return["number",u(g)];case"t":case"f":case"n":for(g+=n;;){if(e=t.charAt(h),!(e>="a"&&"z">=e))break;if(g+=e,++h>=t.length)break}if(/^(true|false|null)$/.test(g))return[g];o("Unknown constant "+g);break;default:return o("Unexpected character '"+n+"' ("+C.stringToCodepoints(n)+") at position "+h),-1}}function u(t){return/^-?(0|[1-9][0-9]*)(\.[0-9]+)?([eE][+-]?[0-9]+)?$/.test(t)?t:o("Invalid JSON number "+t)}function s(t){g[0]!==t&&o("Expected "+t+", found "+g[0])}function c(t){return g[0]===t?(i(),!0):!1}function l(t){return g[0]===t?(i(),!0):","===g[0]?(i(),!1):void o("Expected ',' or '"+t+"', found '"+g[0]+"'")}function f(){switch(g[0]){case"[":i(),m();break;case"{":i(),p();break;case"string":n.emitString(g[1]),i();break;case"number":n.emitNumber(g[1]),i();break;case"true":case"false":n.emitBoolean(g[0]),i();break;case"null":n.emitNull(),i();break;default:o("Unexpected token "+g[0])}}function m(){if(n.startArray(),!c("]"))do f();while(!l("]"));n.endArray()}function p(){if(n.startMap(),!c("}"))do s("string"),n.emitKey(g[1]),i(),s(":"),i(),f();while(!l("}"));n.endMap()}var h=0,g=i();return f(),s("eof"),n.result()}function n(t){try{return JSON.parse('"'+t+'"')}catch(e){throw r(e.toString(),"FOJS0001")}}function o(t){return t.replace(l,"").replace(/[\uD800-\uDFFF]+/g,function(t){for(var e="",n=0;n<t.length;n++){var r=t.charAt(n);e+=n%2=="">r||n==t.length-1&&"">r?"":r}return e})}function i(t){for(var e=t.charCodeAt(0).toString(16);e.length<4;)e="0"+e;return"\\u"+e.toUpperCase()}function a(e){this._valStack=[],this._keyStack=[],t(e,"liberal","boolean",!1),this._escape=t(e,"escape","boolean",!1),this._duplicates=t(e,"duplicates","string","use-first",["reject","use-first","use-last"])}function u(e,n){this._valStack=[],this._keyStack=[],this._mapStack=[],this._context=n,t(e,"liberal","boolean",!1),t(e,"validate","boolean",!1),t(e,"fallback","function"),this._escape=t(e,"escape","boolean",!1),this._duplicates=t(e,"duplicates","string","use-first",["reject","use-first","retain"])}function s(e,o){function a(t){throw new r("Invalid input to xml-to-json(): "+t,"FOJS0006")}function u(t){0!==p.getChildElements(t).length&&a("node "+t.tagName+" must have no element children")}function s(t){E.child(t).filter(function(t){return t.nodeType==p.TEXT_NODE&&t.nodeValue&&""!==_.trim(t.nodeValue)}).next()&&a("node "+t.tagName+" must have no text content")}function l(t){try{return S["boolean"].fromString(t).toBoolean()}catch(e){a("invalid boolean: '"+t+"'")}}function f(t){try{JSON.parse('"'+t+'"')}catch(e){throw r("invalid escape sequence: "+e.toString(),"FOJS0007")}}function m(t){if(t.nodeType==p.DOCUMENT_NODE||t.nodeType==p.DOCUMENT_FRAGMENT_NODE){var e=p.getChildElements(t);return 1!=e.length&&a("document node has "+e.length+" element children"),m(e[0])}if(t.nodeType==p.ELEMENT_NODE){var r=!1;if(t.namespaceURI==c)switch(E.attribute(t).forEachItem(function(e){if(e.name.indexOf(":")<0||e.namespaceURI==c)if("key"==e.name||"escaped-key"==e.name)if("escaped-key"==e.name){p.xdmParentNode(t)&&"map"==p.xdmParentNode(t).localName||a("@escaped-key is allowed only on children of map");var n=l(e.value);n&&f(t.getAttribute("key"))}else p.xdmParentNode(t)&&"map"===p.xdmParentNode(t).localName||a("@key is allowed only on children of map");else"escaped"==e.name?("string"!=t.localName&&a("@escaped is allowed only on string"),r=l(e.value)):a("invalid attribute "+e.name)}),!t.hasAttribute("escaped-key")||p.xdmParentNode&&"map"!=p.xdmParentNode.localName||a("escaped-key is allowed only on children of map"),t.localName){case"null":return E.child(t).filter(function(t){return t.nodeType!=p.COMMENT_NODE&&t.nodeType!=p.PROCESSING_INSTRUCTION_NODE}).next()&&a("null element must have no content"),"null";case"string":u(t);var o=t.textContent;return r?(o=o.replace(/^"/g,'\\"').replace(/^[\b]/g,"\\b").replace(/^\f/g,"\\f").replace(/^\n/g,"\\n").replace(/^\r/g,"\\r").replace(/^\t/g,"\\t").replace(/^\//g,"\\/").replace(/([^\\])"/g,'$1\\"').replace(/([^\\])[\b]/g,"$1\\b").replace(/([^\\])\f/g,"$1\\f").replace(/([^\\])\n/g,"$1\\n").replace(/([^\\])\r/g,"$1\\r").replace(/([^\\])\t/g,"$1\\t").replace(/([^\\])\//g,"$1\\/").replace(/[\u0001-\u001F\u007F-\u009F]/g,i),f(o),'"'+o+'"'):JSON.stringify(o).replace(/\//g,"\\/");case"number":u(t);var h;try{h=S["double"].fromString(t.textContent)}catch(g){a("invalid number")}return isFinite(h.toNumber())||a("NaN and INF not allowed"),h.toString();case"boolean":return u(t),l(t.textContent),S["boolean"].fromString(t.textContent).toString();case"array":s(t);var d="[",v="";return p.getChildElements(t).forEach(function(t){d+=v+m(t),v=","}),d+"]";case"map":s(t);var y="{",N="",x={};return p.getChildElements(t).forEach(function(t){t.hasAttribute("key")||a("child element of map must have a key");var e=p.getAttribute(t,"key"),r=e,o=p.getAttribute(t,"escaped-key"),i=!1;o&&l(o)&&(i=!0,r=n(e)),x[r]&&a("duplicate key '"+e+"'"),x[r]=!0,y+=N+(i?'"'+e+'"':JSON.stringify(e).replace(/\//g,"\\/"))+":"+m(t),N=","}),y+"}";default:a("unknown local name "+t.localName)}else a("wrong namespace "+t.namespaceURI)}else p.isNode(t)||a("not a node"),Error.dumpStack&&Error.dumpStack(),a("wrong node kind "+t.nodeType)}var p=T;return t(o,"indent","boolean",!1),m(e)}var c=C.KNOWN_URI.fn,l=/[\x00-\x08\x0B\x0C\x0E-\x0F\x80-\x9F]/;return a.prototype={_valStack:[],_keyStack:[],_optionsMap:{},_escape:!1,_duplicates:"use-first",reEscape:function(t){return this._escape?JSON.stringify(t).replace(/^"|"$/g,"").replace(/\\"/g,'"').replace(/[\uD800-\uDFFF]/g,i):o(t)},peek:function(){return this._valStack[this._valStack.length-1]},writeItem:function(t){if(0===this._valStack.length)this._valStack.push(t);else if(this.peek()instanceof C.XdmArray)this.peek().value.push(t);else{var e=this.peek(),n=S.string.fromString(this._keyStack.pop());if(e.containsKey(n))switch(this._duplicates){
case"reject":throw r("json-to-xml: duplicate key '"+n.toString()+"'","FOJS0003");case"use-first":return}e.inSituPut(n,t)}},emitNull:function(){this.writeItem([])},emitBoolean:function(t){this.writeItem([S["boolean"].fromString(t)])},emitNumber:function(t){this.writeItem([S["double"].fromNumber(parseFloat(t))])},emitString:function(t){this.writeItem([S.string.fromString(this.reEscape(n(t)))])},emitKey:function(t){this._keyStack.push(this.reEscape(n(t)))},startArray:function(){this._valStack.push(new C.XdmArray([]))},endArray:function(){this.writeItem([this._valStack.pop()])},startMap:function(){this._valStack.push(new w)},endMap:function(){this.writeItem([this._valStack.pop()])},result:function(){return void 0!==this.peek()[0]?this.peek()[0]:null}},u.prototype={_valStack:[],_keyStack:[{}],_mapStack:[],_context:null,_optionsMap:{},_escape:!1,_duplicates:"use-first",reEscape:function(t){return this._escape?JSON.stringify(t).replace(/^"|"$/g,"").replace(/\\"/g,'"').replace(/[\uD800-\uDFFF]/g,i):o(t)},peek:function(){return this._valStack[this._valStack.length-1]},writeItem:function(t){if(0===this._valStack.length)t.setAttribute("xmlns",c),this._valStack.push(t);else{var e=this.peek();if("map"==e.tagName){var n=this._keyStack.pop(),o=this._mapStack[this._mapStack.length-1];if(n in o)switch(this._duplicates){case"reject":throw r("parse-json: duplicate key '"+n.toString()+"'","FOJS0003");case"use-first":return}o[n]=t,t.setAttribute("key",n),this._escape&&/\\/.test(n.toString())&&t.setAttribute("escaped-key","true")}e.appendChild(t)}},emitNull:function(){var t=this._context.resultDocument.createElementNS(c,"null");this.writeItem(t)},emitBoolean:function(t){var e=this._context.resultDocument.createElementNS(c,"boolean"),n=this._context.resultDocument.createTextNode(t.toString());e.appendChild(n),this.writeItem(e)},emitNumber:function(t){var e=this._context.resultDocument.createElementNS(c,"number"),n=this._context.resultDocument.createTextNode(t.toString());e.appendChild(n),this.writeItem(e)},emitString:function(t){var e=this._context.resultDocument.createElementNS(c,"string");if(""!==t){var r=this.reEscape(n(t)),o=this._context.resultDocument.createTextNode(r);this._escape&&/\\/.test(r)&&e.setAttribute("escaped","true"),e.appendChild(o)}this.writeItem(e)},emitKey:function(t){this._keyStack.push(this.reEscape(n(t)))},startArray:function(){var t=this._context.resultDocument.createElementNS(c,"array");this._valStack.push(t)},endArray:function(){this.writeItem(this._valStack.pop())},startMap:function(){var t=this._context.resultDocument.createElementNS(c,"map");this._valStack.push(t),this._mapStack.push({})},endMap:function(){this._mapStack.pop(),this.writeItem(this._valStack.pop())},result:function(){return this.peek()}},{parseToMap:function(t,n){return e(t,n,new a(n))},parseToXml:function(t,n,r){return e(t,n,new u(n,r))},xmlToJson:s}}(),R=function(){"use strict";function t(t,e,n){function o(t){for(var e=[],n=t.length-1;n>=0;n--)e.push({rule:t[n],action:T.getChildElements(t[n])[1],pattern:D(T.getChildElements(t[n])[0])});return e}function i(t){t._saxonAccumulators||(t._saxonAccumulators={}),t._saxonAccumulators[e]={};var n=a(f,t);n&&(p=u(n,t)),t._saxonAccumulators[e].pre=p,E.child(t).forEachItem(i),n=a(m,t),n&&(p=u(n,t)),t._saxonAccumulators[e].post=p}function a(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n].pattern(e))return t[n];return null}function u(t,e){var r=n.newContext(!0);return r.focus=A.Solo(e),r.localVars=[p],C.evaluate(t.action,r).expand()}var s=n.fixed.accumulators[e];if(!s)throw r("Unknown accumulator "+e,"XTDE3340");var c=T.getChildElements(s,"pre")[0],l=T.getChildElements(s,"post")[0],f=o(T.getChildElements(c,"accRule")),m=o(T.getChildElements(l,"accRule")),p=C.evaluate(C.argRole(s,"init"),n).expand();i(t)}function e(n,o,i,a){if(o.nodeType==T.ATTRIBUTE_NODE||o.nodeType==T.NAMESPACE_NODE)throw r("Accumulators are not available on attribute or namespace nodes","XTTE3360");return o._saxonOriginal?e(n,o._saxonOriginal,i,a):(o._saxonAccumulators&&o._saxonAccumulators.hasOwnProperty(n)||t(T.ownerDocument(o),n,i),o._saxonAccumulators[n][a])}return{accumBefore:function(t,n,r){return e(t,n,r,"pre")},accumAfter:function(t,n,r){return e(t,n,r,"post")}}}(),B=function(){"use strict";function t(t,n,o){var i=e(n),a=T.getChildElements(n,"sortKey"),u=N.getConverters(a,o),s=[],c=o.newContext(!1);c.focus=A.Tracker(t);for(var l;null!=(l=c.focus.next());){var f=a.map(function(t,e){var n=C.evalChild1(t,c),o=n.next();if(o&&n.next())throw r("Multiple values in merge key","XTTE1020");return u[e](o)});s.push({item:l,keys:f,ms:i})}return s}function e(t){return t.hasAttribute("name")?t.getAttribute("name"):"#unnamed"}function n(t,e,n){for(var r=[],o=0,i=0;;){if(o>=t.length){for(;i<e.length;)r.push(e[i++]);break}if(i>=e.length){for(;o<t.length;)r.push(t[o++]);break}var a=n(t[o],e[i]);0>=a&&r.push(t[o++]),a>=0&&r.push(e[i++])}return r}function o(t,e){var n=T.getChildElements(t,"sortKey");return n.map(function(t){return N.sortKeyProps(t,e)})}function i(t){return function(e,n){for(var r=0;r<t.length;r++){var o=t[r](e.keys[r],n.keys[r]);if(0!=o)return o}return 0}}function a(t,n,r){for(var o=null,i=[],a={},u=0;u<n.length;u++){var s=n[u];if(null==o||0!=r(o,s)){a={items:[s.item],keys:s.keys,groups:{}};for(var c=0;c<t.length;c++)a.groups[e(t[c])]=[];a.groups[s.ms]=[s.item],i.push(a)}else a.items.push(s.item),a.groups[s.ms].push(s.item);o=s}return i}function u(e,u){for(var s=T.getChildElements(e,"mergeSrc"),c=s.map(function(t){return o(t,u)}),l=c[0],f=1;f<c.length;f++)for(var m=0;m<l.length;m++){var p=l[m],h=c[f][m];if(p.order!==h.order||p.lang!==h.lang||p.caseOrder!==h.caseOrder||p.dataType!==h.dataType)throw r("All merge sources must have compatible merge keys","XTDE2210")}for(var g=l.map(function(t){return N.compareFnWithProps(t,u)}),d=i(g),v=null,y=0;y<s.length;y++){var S=s[y],x=u.newContext(!1),b=C.argRole(S,"forEachItem");b?x.focus=A.Tracker(C.evaluate(b,u)):x.focus=A.Tracker(A.Singleton(u.getCurrentFocus()));for(var w,E=C.argRole(S,"selectRows");null!=(w=x.focus.next());){var O=C.evaluate(E,x),D=t(O,S,x);v=null==v?D:n(v,D,d)}}if(null===v)return A.Empty;for(var _=a(s,v,d),F=C.argRole(e,"action"),I=[],M=0;M<_.length;M++){var k=u.newContext(!1);k.focus=A.Tracker(A.Singleton(_[M].items[0])),k.currentMergeGroup=_[M];for(var P,U=C.evaluate(F,k);null!=(P=U.next());)I.push(P)}return A.ForArray(I)}return{merge:u}}(),X=function(){function t(){var t=SaxonJS.getPlatform().readResource("lib/xpath/XPathJS.min.js");t+="return XPath;";var e=new Function(t);SaxonJS.XPath=e()}return{parse:function(){return t(),SaxonJS.XPath.parse.apply(null,arguments)},compile:function(){return t(),SaxonJS.XPath.compile.apply(null,arguments)},evaluate:function(){return t(),SaxonJS.XPath.evaluate.apply(null,arguments)},evaluateXDM:function(){return t(),SaxonJS.XPath.evaluateXDM.apply(null,arguments)},setStaticContext:function(){return t(),SaxonJS.XPath.setStaticContext.apply(null,arguments)}}}(),J={},L="undefined"!=typeof window,$=null,z=null,G=L&&window.performance&&window.performance.now?window.performance.now:function(){return Date.now().valueOf()};return d.prototype={depth:0,focus:null,currentComponent:null,resultDocument:null,tempOutputState:!1,fixed:{},localParams:{},tunnelParams:{},currentTemplate:null,currentMode:{},currentError:null,currentEvent:null,currentGroup:null,currentGroupingKey:null,currentMergeGroup:null,localVars:[],toString:function(){var t="{";for(var e in this.localParams)this.localParams.hasOwnProperty(e)&&(t+=e+":("+this.localParams[e]+"),");return t+="}","context: "+this.getCurrentFocus()+" localParams: "+t},newContext:function(t){var e=this,n=new d;return n.depth=e.depth+1,n.focus=e.focus,n.currentComponent=e.currentComponent,n.resultDocument=e.resultDocument,n.currentMode=e.currentMode,n.currentTemplate=e.currentTemplate,n.currentError=e.currentError,n.currentGroup=e.currentGroup,n.currentGroupingKey=e.currentGroupingKey,n.currentMergeGroup=e.currentMergeGroup,n.fixed=e.fixed,n.tempOutputState=e.tempOutputState,n.currentEvent=e.currentEvent,t?(n.localParams={},n.tunnelParams={},n.localVars=[]):(n.localParams=e.localParams,n.tunnelParams=e.tunnelParams,n.localVars=e.localVars),n},clearGrouping:function(){this.currentGroup=null,this.currentGroupingKey=null,this.currentMergeGroup=null},createElement:function(t,e){var n;return n=""!==t&&"http://www.w3.org/1999/xhtml"!=t||!L||this.resultDocument!=window.document?this.resultDocument.createElementNS(t,e):this.resultDocument.createElement(e)},createAttribute:function(t,e){return new n(new S.QName.fromEQName("Q{"+t+"}"+e),null,null)},createAttributeFromQName:function(t){return new n(t,null,null)},noCurrentFocus:function(){return!this.focus||!this.focus.current},getCurrentFocus:function(){return this.noCurrentFocus()?null:this.focus.current}},o(),{transform:l,getProcessorInfo:v,setPlatform:i,getPlatform:function(){return J},getNavigator:function(){return window.navigator.userAgent},timeStamp:G,internalTransform:c,U:{Atomic:S,Axis:E,Context:d,Compare:N,calculator:M,nameOfNode:T.nameOfNode,isNode:T.isNode,isAttr:T.isAttr,isNamespaceNode:T.isNSNode,declareNS:T.declareNS,getInheritedAttribute:T.getInheritedAttribute,getChildElements:T.getChildElements,isMap:C.isMap,isArray:C.isArray,roleDiagnostic:C.roleDiagnostic,wsCollapse:C.wsCollapse,ForArray:A.ForArray,AnyIterator:A.AnyIterator,obtainDocumentNumber:T.obtainDocumentNumber,evaluate:C.evaluate,declaringPackage:C.declaringPackage,Iter:A,convertFromJS:C.convertFromJS,convertToJS:C.convertToJS,stringToCodepoints:C.stringToCodepoints},XError:r,XPath:X}}();